
var activity=0;var TRefreshID="";var TSessionID="";var mycKeepAliveCnt=0;var submitcount=0;var newwindow;var isTabAllowed=true;var ALPHANUMERIC="1";var EQUAL_TO_CODE="2";var GREATER_THAN_CODE="3";var LESS_THAN_CODE="4";var REMOVE_IF_EQUAL_TO_REMOVE_CHAR="1";var REMOVE_NONNUMERIC="2";function padNumber(num,length){if(num>0){num=num.toString().replace(/\./,".");return Array(length-num.length+1).join("0")+num}else{num=(-num).toString().replace(/\./,".");return"-"+Array(length-num.length).join("0")+num}}function padNumber2(num,length){if(num==0){return Array(length+1).join("0")}else{return padNumber(num,length)}}function IsNumericMinMax(objName,minvalue,maxvalue,decimalAllowed){if(objName==null){return false}var number;var objValue=objName.value;if(objValue==""){return true}if(objValue.indexOf(",")!=-1&&objValue.indexOf(".")){alert("Please enter a numeric value.");objName.select();objName.focus();return false}objValue=objValue.replace(/[\,\s]/g,"");number=objValue.replace(/\./g,".");number=Number(number);if(number==NaN){alert("Please enter a numeric value.");objName.select();objName.focus();return false}else{if(!decimalAllowed&&number!=Math.round(number)){alert("Please enter a numeric value.");objName.select();objName.focus();return false}else{if((minvalue!="")&&(number<Number(minvalue))){alert("Please enter a value no less than @MYCHART@MINVALUE@.".replace("@MYCHART@MINVALUE@",minvalue));objName.select();objName.focus();return false}else{if((maxvalue!="")&&(number>Number(maxvalue))){alert("Please enter a value no more than @MYCHART@MAXVALUE@.".replace("@MYCHART@MAXVALUE@",maxvalue));objName.select();objName.focus();return false}}}}objName.value=objValue;return true}function findFrame(what){for(var i=0;i<parent.frames.length;i++){if(parent.frames[i].name==what){return true}}return false}function checkActivity(RefreshTimeOut,SessionTimeOut,WarningPopup,sLogoutPage){var img;if(activity==1){mycKeepAliveCnt++;if(document.images){img=new Image();img.src="./keepalive.asp?cnt="+mycKeepAliveCnt;window.clearTimeout(TSessionID)}else{if(document.getElementById("mycKeepAliveFrameIE")){document.getElementById("mycKeepAliveFrameIE").data="./keepalive.asp"}}intKeepalive();activity=0;TRefreshID=window.setTimeout("checkActivity("+RefreshTimeOut+","+SessionTimeOut+',"'+WarningPopup+'","'+sLogoutPage+'");',RefreshTimeOut);TSessionID=window.setTimeout('logOut("'+sLogoutPage+'");',SessionTimeOut)}else{if(WarningPopup.length>0){newwindow=window.open("","_blank","'toolbar=no,location=no,screenX=350,screenY=300,left=350,top=300,directories=no,status=no,menubar=no,resizable=no,width=370,height=110");if(!newwindow.opener){newwindow.opener=window}var threshold=SessionTimeOut-RefreshTimeOut;newwindow.document.write("<html><head>");newwindow.document.write('<script language="javascript">');newwindow.document.write('setTimeout("self.close();",'+threshold+")");newwindow.document.write("<\/script>");newwindow.document.write("</head><title>Warning</title>");newwindow.document.write('<body onload="window.focus();" bgcolor="#ECE9D8" leftmargin="0" rightmargin="0" topmargin="0" bottommargin="0">');newwindow.document.write("<center>");newwindow.document.write('<font face="arial" font size="2">'+WarningPopup+"</font>");newwindow.document.write('<p><font face="arial" font size="2">Do you want to remain logged in?</font>');newwindow.document.write("<form><table><tr>");newwindow.document.write('<td><input type="button" style="width:65" value="Yes" onClick="if(!opener.closed) {opener.activity=1; opener.checkActivity('+RefreshTimeOut+","+SessionTimeOut+",'"+WarningPopup+"','"+sLogoutPage+"');} self.close()\"></td>");newwindow.document.write('<td><input type="button" style="width:65" value="No" onClick="if(!opener.closed) opener.logOut(\''+sLogoutPage+"'); self.close()\"></td>");newwindow.document.write("</tr></table></form>");newwindow.document.write("</center></body></html>")}}}function logOut(sLogoutPage){if(newwindow){if(!newwindow.closed){newwindow.close()}}if((sLogoutPage!="")&&(sLogoutPage!=null)&&(sLogoutPage!="undefined")){self.location.href=sLogoutPage}else{self.location.href="./bye.asp"}}function SetActivity(){activity=1}function SetBlurActivity(){SetActivity()}function HandleKeyPress(evt,o){var lKeyCode;if(navigator.appName!="Netscape"){lKeyCode=window.event.keyCode}else{lKeyCode=evt.which}SetActivity();return true}function CheckLength(sElement,lMaxLength,sErrorMsg,IsKeyPress){var origLen;var sMessage;origLen=lMaxLength;if((IsKeyPress!="")&&(IsKeyPress!=null)&&(IsKeyPress=="1")){lMaxLength=lMaxLength-1}sMessage=sElement.value.replace(/\r\n/g,"");if(sMessage.length>lMaxLength){if(sErrorMsg==""){sErrorMsg="Text may not exceed @MYCHART@MAXMIMUMLENGTH@ characters. \n".replace("@MYCHART@MAXMIMUMLENGTH@",origLen)}alert(sErrorMsg);sElement.focus();return false}return true}function HandleKeyPressAndMaxLen(evt,sElement,lMaxLength,sErrorMsg){var lKeyCode;if(navigator.appName!="Netscape"){lKeyCode=window.event.keyCode}else{lKeyCode=evt.which}SetActivity();if((lKeyCode==8)||(lKeyCode==0)){return true}else{return CheckLength(sElement,lMaxLength,sErrorMsg,1)}}function HandleBlurAndMaxLen(evt,sElement,lMaxLength,sErrorMsg){return HandleKeyPressAndMaxLen(evt,sElement,lMaxLength,sErrorMsg)}function HandleOnChangeAndMaxLen(sElement,lMaxLength,sErrorMsg){SetActivity();return CheckLength(sElement,lMaxLength,sErrorMsg)}function insideBodyLoad(sRefreshTimeout,sSessionTimeout,sWarningPopup,sTitle,sLogoutPage){var sTimeoutParams;sTimeoutParams="checkActivity("+sRefreshTimeout+", "+sSessionTimeout+',"'+sWarningPopup+'","'+sLogoutPage+'");';TRefreshID=window.setTimeout(sTimeoutParams,sRefreshTimeout);TSessionID=window.setTimeout('logOut("'+sLogoutPage+'");',sSessionTimeout);try{top.document.title=sTitle}catch(e){}window.focus();return true}function breakOut(){if(self!=top){top.location.replace(self.location.href)}}function getObjectValue(obj){var objLen,i,objValue;if(obj){objLen=0;objLen=obj.length;objValue="";if(objLen>0){for(i=0;i<objLen;i++){objValue=objValue+obj[i].value}}else{objValue=obj.value}return objValue}}function doMainKeyPress(e){return routeEvent(e)}if(navigator.appName=="Netscape"){window.captureEvents(Event.KEYPRESS);window.onkeypress=doMainKeyPress}function submitForm(element){if(element.form.submitcontrol.value=="submit form"){element.form.submitform.click();return false}}function addFocus(element){element.form.submitcontrol.value="nosubmit";return true}function taKeyDown(element){element.form.submitcontrol.value="nosubmit"}function recordKey(element){if((window.event.keyCode==13)&&(element.submitcontrol.value!="nosubmit")){element.submitcontrol.value="submit form"}else{element.submitcontrol.value=""}}function containsSpace(text){for(var i=0;i<text.length;++i){if(text.charAt(i)==" "){return true}}return false}function containsPunctuation(text){var validChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@._-";var utext=text.toUpperCase();for(var i=0;i<utext.length;++i){var ch=utext.charAt(i);if(validChars.indexOf(ch)<0){return true}}return false}function selectCheckBox(chkBoxGrp){if((chkBoxGrp!=null)&&(document.all||document.getElementById)){for(var i=0;i<chkBoxGrp.length;i++){if(chkBoxGrp[i].checked==true){return true}}if(chkBoxGrp.checked==true){return true}alert("At least one checkbox must be checked");return false}return true}function disableButton(formObj){if(submitcount==0){submitcount++;return true}else{formObj.disabled=true;return false}}function enableIfReqFilled(frmID,btns){if(!document.getElementById){return}var frm,i,arr,errs,verify,name,disp,key,errCnt,input,list;frm=document.getElementById(frmID);if(!frm){return}list=btns.split("^");if(!list||list.length==0){return}var args=enableIfReqFilled.arguments;verify=new Array();errs=new Array();errCnt=0;for(i=2;i<args.length;i++){arr=args[i].split("^");name=arr[0];disp=arr[1]||name;key=arr[2]||name;input=frm[name];if(input&&!(verify[key])){if(removeWhiteSpace(input.value).length==0){if(!errs[key]){errs[key]=true;errCnt++}}else{verify[key]=true;if(errs[key]){errs[key]=false;errCnt--}}}}if(IsFormValid(frmID)===false){errCnt++}if(errCnt>0){for(i=0;i<list.length;i++){disableBtn(frm[list[i]])}}else{for(i=0;i<list.length;i++){enableBtn(frm[list[i]])}}}function IsFormValid(formID,showAlerts){var i;try{if(WP&&WP.Validators&&WP.Validators.Forms){var validationForm=WP.Validators.Forms[formID];if(validationForm){for(i=0;i<validationForm.length;i++){if(removeWhiteSpace(validationForm[i]).length>0){if(showAlerts===true){alert(validationForm[i])}return false}}}}}catch(ex){}return true}function removeWhiteSpace(txt){var str=""+txt;str=str.replace(/\W/g,"");return str}function confirmDelete(sMessage){if(confirm(sMessage)==true){return true}return false}function confirmEmbedDelete(sMessage){var confSection,subInput,result=confirm(sMessage);if(result===true){confSection=document.getElementById("confirmStep");if(confSection){confSection=confSection.parentNode;if(confSection){subInput=document.createElement("input");subInput.type="hidden";subInput.className="hidden";subInput.name="clickSub";subInput.value="1";confSection.appendChild(subInput)}}return true}return false}function setCheckboxesByPrefix(prefix){var indx,chkBx;indx=1;chkBx=document.getElementById(prefix+indx);while(chkBx!==null){chkBx.setAttribute("checked","true");chkBx.checked=true;indx=indx+1;chkBx=document.getElementById(prefix+indx)}}function unsetCheckboxesByPrefix(prefix){var indx,chkBx;indx=1;chkBx=document.getElementById(prefix+indx);while(chkBx!==null){chkBx.removeAttribute("checked");chkBx.checked=false;indx=indx+1;chkBx=document.getElementById(prefix+indx)}}function statusOfCheckboxesByPrefix(prefix){var indx,chkBx,AllSelected,SomeSelected;AllSelected=true;SomeSelected=false;indx=1;chkBx=document.getElementById(prefix+indx);while(chkBx!==null){if(!chkBx.checked){AllSelected=false}else{SomeSelected=true}indx=indx+1;chkBx=document.getElementById(prefix+indx)}if(AllSelected){return 3}if(SomeSelected){return 2}return 1}function checkAll(formname,groupname){if(typeof(document)=="object"&&formname!=null&&groupname!=null&&document.getElementById&&typeof(document.getElementById(formname))=="object"){var form=document.getElementById(formname);var element,index=0;while(element=form[index++]){if(element.type=="checkbox"){element.checked=true}}}}function selectRadioButton(radButGrp){if(document.all||document.getElementById){for(var i=0;i<radButGrp.length;i++){if(radButGrp[i].checked==true){return true}}if(radButGrp.checked==true){return true}alert("Please make a selection before submitting.");return false}return true}function disableButton1(oButton){if(typeof(oButton)=="object"){oButton.disabled=true}return true}var browser,version,total,thestring,place;function checkIt(agent,string){place=agent.indexOf(string)+1;thestring=string;return place}function dataTileLoad(){var modesToResize;var forInterval;var mode;modesToResize={};modesToResize.histques=true;modesToResize.downloadsummary=true;modesToResize.snapshot=true;modesToResize.hlthissues=true;modesToResize.medslist=true;modesToResize.allergies=true;modesToResize.healthmaint=true;modesToResize.histories=true;modesToResize.immunizations=true;if(WP.DOM.Browser.isIE){forInterval=getIEHeight}else{if(WP.DOM.Browser.isSafari||WP.DOM.Browser.isOmniweb){forInterval=getWebkitHeight}else{if(WP.DOM.Browser.isOpera){forInterval=getOperaHeight}else{forInterval=getGenericHeight}}}try{setAppropriateHeight.getAppropriateHeight=forInterval;mode=getQueryString("mode");if(modesToResize[mode]){WP.Events.addListener(document.body,"click",setAppropriateHeight)}setAppropriateHeight()}catch(err){return}}function getIEHeight(){return document.body.scrollHeight+16+"px"}function getWebkitHeight(container){container.style.height="100px";return Math.max(document.body.scrollHeight,container.scrollHeight,container.contentWindow.document.documentElement.scrollHeight)+25+"px"}function getOperaHeight(){return Math.max(document.body.scrollHeight||200,document.body.offsetHeight||200)+16+"px"}function getGenericHeight(container){container.style.height=150+"px";return Math.max(document.body.scrollHeight||200,document.body.offsetHeight||200,document.documentElement.scrollHeight||0)+16+"px"}function setAppropriateHeight(){if(setAppropriateHeight.getAppropriateHeight==null){return}var scrollTop=parent.document.body.scrollTop;window.setTimeout(function(){var container,newHeight;if(parent.document.getElementById){container=parent.document.getElementById(window.name)}else{if(parent.document.all){container=parent.document.all[window.name]}else{return}}if(!container||!document||!document.body||!container.style||(typeof("container.style.height")=="undefined")){return}newHeight=setAppropriateHeight.getAppropriateHeight(container);if(container.style.height!=newHeight){container.style.height=newHeight;parent.document.body.scrollTop=scrollTop}},20)}function getQueryString(key){if(!getQueryString.parsed){var arr=window.location.search.substr(1).split("&"),obj={},index,prevKey,k;for(k=0;k<arr.length;k++){index=arr[k].indexOf("=");if(index===-1&&k>0){obj[prevKey]+="&"+arr[k]}else{prevKey=arr[k].substr(0,index).toLowerCase();obj[prevKey]=arr[k].substr(index+1)}}getQueryString.parsed=obj}return getQueryString.parsed[key]||""}function vdtAdmissionLoad(){var container;var newHeight;container=document.getElementById("vdtFrame");if(container.contentWindow.document.documentElement.scrollHeight){newHeight=container.contentWindow.document.documentElement.scrollHeight+25+"px";container.style.height=newHeight}else{resizeWebKit("vdtFrame")}}function resizeWebKit(sName){if(document.getElementById){var container,iHeight;container=parent.document.getElementById(sName);container.style.height="100px";iHeight=Math.max(document.body.scrollHeight,container.scrollHeight,container.contentWindow.document.documentElement.scrollHeight)+25;container.style.height=iHeight+"px"}}function DoRedirect(){if(typeof(WP.Events.beforeUnload.message)==="string"){var x=confirm("You have unsaved changes on your form.  Click OK to continue and lose your changes.  Click Cancel to remain on page.");if(!x){return}WP.Events.removeListener(window,"beforeunload",WP.Events.beforeUnload.fun)}window.location="./bye.asp";if(window.location.href.indexOf("bye.asp")>-1){this.document.write("<br /><br /><br /><br /><center>You are being logged out</center>")}return false}function DoRedirectOE(){this.document.write("<br /><br /><br /><br /><center>You are being logged out</center>");window.location="./oebye.asp";return false}function captureBackEnterKey(){SetActivity();if(window.event&&((window.event.keyCode==8)||(window.event.keyCode==13))){var Elem=window.event.srcElement;var ElemFiringBS=Elem.type;if(!Elem.readOnly){if((ElemFiringBS=="text"||ElemFiringBS=="textarea"||ElemFiringBS=="password")&&(window.event.keyCode==8)){return}if((ElemFiringBS=="textarea"||ElemFiringBS=="submit")&&(window.event.keyCode==13)){return}}window.event.cancelBubble=true;window.event.returnValue=false;return false}}function showItem(objID){var tblObj;if(document.getElementById){tblObj=document.getElementById(objID)}else{if(document.all){tblObj=document.all.item(objID)}}if(tblObj!=null){tblObj.style.display="block";return true}return false}function hideItem(objID){var tblObj;if(document.getElementById){tblObj=document.getElementById(objID)}else{if(document.all){tblObj=document.all.item(objID)}}if(tblObj!=null){tblObj.style.display="none";return true}return false}function showElement(element,elmntId){if(element===null){if(elmntId!==null&&elmntId.length>0){element=document.getElementById(elmntId)}if(element===null){return}}removeClassNames(element,"hidden");return}function hideElement(element,elmntId){if(element===null){if(elmntId!==null&&elmntId.length>0){element=document.getElementById(elmntId)}if(element===null){return}}removeClassNames(element,"hidden");element.className=element.className+" hidden";return}function activateField(field,fieldId){if(field===null){if(typeof fieldId==="string"&&fieldId.length>0){field=document.getElementById(fieldId)}if(field===null){return}}removeClassNames(field,"inactivefield,activefield");field.className=field.className+" activefield";return}function activateFieldsByIds(activateIds){var indx,activateArr;if(activateIds!==null){activateArr=activateIds.split(",")}if(activateArr!==null){for(indx=0;indx<activateArr.length;indx=indx+1){activateField(document.getElementById(activateArr[indx]))}}}function deactivateField(field,fieldId){if(field===null){if(typeof fieldId==="string"&&fieldId.length>0){field=document.getElementById(fieldId)}if(field===null){return}}removeClassNames(field,"inactivefield,activefield");field.className=field.className+" inactivefield";return}function deactivateFieldsByIds(deactivateIds){var indx,deactivateArr;if(deactivateIds!==null){deactivateArr=deactivateIds.split(",")}if(deactivateArr!==null){for(indx=0;indx<deactivateArr.length;indx=indx+1){deactivateField(document.getElementById(deactivateArr[indx]))}}}function applyClass(tag,className){var classes,i;if(!tag){return}classes=className.split(",");for(i=0;i<classes.length;i++){if(!containsClassName(tag,classes[i])){tag.className+=(tag.className.length>0?" ":"")+classes[i]}}return tag}function removeClassNames(element,classNms){var classNmArray,indx,expr,newClassName;if(element===null||classNms===null||element.className.length<1||classNms===null||classNms.length<1){return}classNmArray=classNms.split(",");newClassName=element.className;for(indx=0;indx<classNmArray.length;indx=indx+1){expr=new RegExp("(^|\\s+)"+classNmArray[indx]+"(\\s+|$)","g");newClassName=newClassName.replace(expr," ")}element.className=newClassName}function replaceClassNames(element,oldClassNames,newClassNames){removeClassNames(element,oldClassNames);applyClass(element,newClassNames)}function containsClassName(element,classNm){var expr;if(element===null||typeof classNm!=="string"||classNm.length<1){return false}if(typeof element.className!=="string"||element.className.length<1){return false}expr=new RegExp("(^|\\s+)"+classNm+"(\\s+|$)","g");if(expr===null){return false}return element.className.match(expr)!=null}function applyUniqueClassNameAmongSiblings(element,classNm){var parentNode=element.parentNode,i;for(i=0;i<parentNode.children.length;i++){removeClassNames(parentNode.children[i],classNm)}applyClass(element,classNm)}function selectAllFirstTime(elmnt){if(elmnt===null){return false}if(!containsClassName(elmnt,"clckd")){elmnt.select();elmnt.className=elmnt.className+" clckd";elmnt.onblur=function(){removeClassNames(this,"clckd");return false}}return false}function enableIfChecked(formID){if(!document.getElementById){return}var cb,btn,frm,i;var btns=new Array();frm=document.getElementById(formID);if(!frm){return}var args=enableIfChecked.arguments;for(i=1;i<args.length;i++){btn=frm[args[i]];if(btn&&typeof(btn)==="object"){btns.push(btn)}}var inp=frm.getElementsByTagName("input");var checked=false;for(var x=0;x<inp.length;x++){cb=inp[x];if(cb.type!="checkbox"&&cb.type!="radio"){continue}if(cb.className.toLowerCase().indexOf("hidden")!=-1){continue}if(cb.checked){checked=true;break}}for(i=0;i<btns.length;i++){btn=btns[i];if(checked){enableBtn(btn)}else{disableBtn(btn)}}}function enableBtn(btn){if(btn&&btn.removeAttribute){btn.removeAttribute("disabled");btn.className=btn.className.replace(/\ ?disabled/,"")}}function disableBtn(btn){var ds="disabled";if(btn){btn.disabled=ds;if(btn.className.indexOf(ds)==-1){btn.className=btn.className.replace(/\ *$/,"");if(btn.className.length>0){ds=" "+ds}btn.className=btn.className+ds}}}function getElementPosition(elem,container){if(!elem.offsetParent){return}var currentElement=elem;var left=0;var top=0;var chain="";var topElement;while(currentElement){topElement=currentElement;if(currentElement.tagName=="HTML"){break}if(container&&currentElement==container){break}left+=currentElement.offsetLeft;top+=currentElement.offsetTop;if(currentElement.scrollLeft){left-=currentElement.scrollLeft}if(currentElement.id.toLowerCase()=="wrap"){left-=currentElement.offsetLeft;top-=currentElement.offsetTop;break}currentElement=currentElement.offsetParent}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof document.body.leftMargin!="undefined"){left+=document.body.leftMargin;top+=document.body.topMargin}left+="px";top+="px";if(topElement.tagName=="HTML"){topElement=topElement.getElementsByTagName("body")[0];if(topElement.offsetLeft){left-=topElement.offsetLeft}if(topElement.offsetTop){top-=topElement.offsetTop}}return{x:left,y:top,topElement:topElement}}function changePasswdCheck(formObj){if(formObj==null){return false}var sOldPasswd,sNewPasswd,sVerPasswd;sOldPasswd=formObj.oldpasswd.value;if(sOldPasswd==""){alert("Please enter your current password.");formObj.oldpasswd.focus();return false}sNewPasswd=formObj.newpasswd.value;if(containsSpace(sNewPasswd)){alert("Your new password cannot contain any spaces.");formObj.newpasswd.focus();return false}sVerPasswd=formObj.verifypasswd.value;if(sNewPasswd!=sVerPasswd){alert("Your new password and the retyped new password are not the same.");formObj.verifypasswd.focus();return false}return true}function changeQuesAnsCheck(formObj){if(formObj==null){return false}var sPasswd,sNewAns;sPasswd=formObj.oldpasswd.value;if(sPasswd==""){alert("Please enter your current password.");formObj.oldpasswd.focus();return false}sNewAns=formObj.pwdans.value;if(sNewAns==""){alert("Please enter your new answer.");formObj.pwdans.focus();return false}return true}function CheckFilenameExtensions(){var extField=document.getElementById("ALLOWED_EXTENSIONS");if(!extField){return true}var extList=extField.value;var field,fname,arr,ext,ndx=0,done=false,ok=true;var fileTest=new RegExp("^([a-zA-Z]:(\\\\|/)|file://|/|\\\\\\\\)[^\\\\/:].*\\..+");while(!done){field=document.getElementById("upload"+(++ndx));if(!field){done=true;break}fname=field.value;if(fname.length==0){continue}if(navigator.userAgent.indexOf("MSIE")!=-1){if(!fileTest.test(fname)){ok=false;done=true;break}}arr=fname.split(".");if(arr.length<2){ok=false;done=true;break}ext=arr[arr.length-1].toUpperCase();if(extList.indexOf("^"+ext+"^")==-1){ok=false;done=true;break}}if(!ok){var progBar=document.getElementById("progbar");if(progBar){progBar.className+=" hidden"}var extDisplay=extList.substr(1,extList.length-2).replace(/\^/g,", ");var msg="@MYCHART@FILENAME@ is invalid or does not have an allowed extension. The allowed extensions are @MYCHART@ALLOWEDEXTENSIONS@.".replace("@MYCHART@FILENAME@",fname).replace("@MYCHART@ALLOWEDEXTENSIONS@",extDisplay);alert(msg)}return ok}function checkEnter(event,button){if(event!=null){var ekeyCode=event.keyCode;if(ekeyCode=="13"){if(button!=null){button.click()}return false}}return true}function isBasicInlineValidationError(field,errorDivTagID,sErrorText,isCheckMaxLength,isTurnOnErrorNotAllowed,isNoDeleteError,isNoDeleteHighlight,sInvalidError,isNotCheckEmptyField,isNonNumericCharsNotAllowed,numMinRequiredChars){var isError=false;var isEmptyFieldError=false;var isMaxLengthError=false;var isNonNumericError=false;var isInvalidFormat=false;if(sErrorText==""||sErrorText==null){sErrorText="<span class=\"clearlabel\">Error: </span>This field is required."}if(sInvalidError==""||sInvalidError==null){sInvalidError=sErrorText}if(field==null){return false}if(numMinRequiredChars==""||numMinRequiredChars==null){numMinRequiredChars=-1}if(field.maxLength>10000){isCheckMaxLength=false}if(isCheckMaxLength&&numMinRequiredChars<0){if(field.id=="dob"){numMinRequiredChars=field.maxLength-2}else{numMinRequiredChars=field.maxLength}}if(field.value==""||field.value==null){isError=true;isEmptyFieldError=true}else{if(isCheckMaxLength&&(field.value.length<numMinRequiredChars)&&(field.value.length>0)){isError=true;isMaxLengthError=true}else{if(isNonNumericCharsNotAllowed&&isNaN(field.value)){isError=true;isNonNumericError=true}}}if(isError){if(!(isTurnOnErrorNotAllowed)){if(isEmptyFieldError){if(!(isNotCheckEmptyField)){turnOnHighlight(field);changeErrorField(errorDivTagID,sErrorText)}else{if(isHighlighted(field)){changeErrorField(errorDivTagID,sErrorText)}}}else{if(isMaxLengthError||isNonNumericError||isInvalidFormat){turnOnHighlight(field);changeErrorField(errorDivTagID,sInvalidError)}}}}else{if(!(isNoDeleteHighlight)){turnOffHighlight(field)}if(!(isNoDeleteError)){changeErrorField(errorDivTagID,"")}}return isError}function changeErrorField(inputName,errorText,isCheckIfErrorMsgEmpty,isNoStarInBeginning){var field;var setErrorField=true;if(inputName.length>0){if(field=document.getElementById(inputName)){if(isCheckIfErrorMsgEmpty){if(field.innerHTML=="&nbsp;"){setErrorField=false}}if(setErrorField){if(errorText!=""){if(isNoStarInBeginning){field.innerHTML=errorText}else{field.innerHTML="* "+errorText}}else{field.innerHTML="&nbsp;"}}}}}function turnOnHighlight(field){if(field.className.search("inputHighlighted")<0){field.className=field.className+" inputHighlighted"}}function turnOffHighlight(field){if(isHighlighted(field)){field.className=field.className.replace(" inputHighlighted","")}}function highlightIfEmpty(object,isNoTurnOnHighlight){var sValue;if(object!=null){sValue=object.value;if(sValue==""){if(!(isNoTurnOnHighlight)){turnOnHighlight(object)}}else{turnOffHighlight(object)}}}function isHighlighted(obj){if(obj==null){return false}else{return((obj.className.search("inputHighlighted"))>-1)}}function validateEmptinessOfTwoRelatedFields(fieldLostFocus,field2){if(fieldLostFocus.value.length<1){if((field2.value.length<1)){if(isHighlighted(field2)){turnOnHighlight(fieldLostFocus)}}else{turnOnHighlight(fieldLostFocus)}}else{turnOffHighlight(fieldLostFocus)}}function checkIfFocusOnPrevField(event,original,fieldPreName,fieldNum){var tmpField;var prevID;prevID=fieldNum-1;if(prevID>0){if(checkKeyPress(event,EQUAL_TO_CODE,"8")){if(original.value==""){tmpField=document.getElementById(fieldPreName+prevID);if(tmpField!=null){tmpField.focus();isTabAllowed=true;tmpField.value=tmpField.value}}}}}function autotab(event,original,destination){if(checkKeyPress(event,ALPHANUMERIC)){if(original.getAttribute&&original.value.length==original.getAttribute("maxlength")){destination.focus();destination.select();isTabAllowed=false}}else{if(checkKeyPress(event,EQUAL_TO_CODE,"16")){isTabAllowed=true}}}function isDiscreteFieldsError(preNameOfFields,numOfFields,isCheckMaxLength,errorDivTagID,sEmptyError,sInvalidError,isNoTurnOnError,fieldPiece,isNotCheckEmptyField,isNonNumericCharsNotAllowed){var ndx,tmpField;var isError=false;var isMaxLengthError=false;var isFieldPieceEmpty=false;var isAnyFieldHighlighted=false;var isFieldPieceWasHighlighted=false;var sErrorMessageToShow;var numMinRequiredChars=0;var isInvalidFormat=false;sErrorMessageToShow=sEmptyError;isFieldPieceEmpty=(fieldPiece==null);if(sEmptyError==""||sEmptyError==null){sEmptyError="<span class=\"clearlabel\">Error: </span>This field is required."}if(sInvalidError==""){sInvalidError=sEmptyError}if(isNotCheckEmptyField){for(ndx=1;ndx<=numOfFields;ndx++){tmpField=document.getElementById(preNameOfFields+ndx);if(tmpField!=null){if(tmpField.value!=""){isNotCheckEmptyField="";sErrorMessageToShow=sInvalidError;ndx=numOfFields}else{if(isHighlighted(tmpField)){isNotCheckEmptyField=""}}}}}if(!(isFieldPieceEmpty)){if(isHighlighted(fieldPiece)){isFieldPieceWasHighlighted=true}isError=isBasicInlineValidationError(fieldPiece,errorDivTagID,sErrorMessageToShow,isCheckMaxLength,isNoTurnOnError,1,"",sErrorMessageToShow,isNotCheckEmptyField,isNonNumericCharsNotAllowed)}if(!(isError)){if(numOfFields==null){numOfFields=1}for(ndx=1;ndx<=numOfFields;ndx++){if(numOfFields==1){tmpField=document.getElementById(preNameOfFields)}else{tmpField=document.getElementById(preNameOfFields+ndx)}if(tmpField.maxLength>10000){isCheckMaxLength=false}if(isCheckMaxLength){if((tmpField.id=="dob")||(tmpField.id=="ssn")){numMinRequiredChars=tmpField.maxLength-2}else{numMinRequiredChars=tmpField.maxLength}}if(tmpField!=null){if(tmpField.value==""){isError=true;if((!(isNoTurnOnError))&&(!(isMaxLengthError))&&(!(isInvalidFormat))&&(isFieldPieceEmpty)){turnOnHighlight(tmpField);changeErrorField(errorDivTagID,sErrorMessageToShow)}}else{if(isCheckMaxLength&&(tmpField.value.length<numMinRequiredChars)&&(tmpField.value.length>0)){isError=true;isMaxLengthError=true;if((!(isNoTurnOnError))&&(isFieldPieceEmpty)){turnOnHighlight(tmpField);changeErrorField(errorDivTagID,sErrorMessageToShow)}}else{if(isFieldPieceEmpty){turnOffHighlight(tmpField)}}}if(isHighlighted(tmpField)){isAnyFieldHighlighted=true}}}}else{isAnyFieldHighlighted=true}if(isError){if(!(isAnyFieldHighlighted)){changeErrorField(errorDivTagID,"")}return true}else{changeErrorField(errorDivTagID,"");return false}}function checkIfTabAllowed(event,original){if(checkKeyPress(event,EQUAL_TO_CODE,"16")){isTabAllowed=true}else{if(checkKeyPress(event,EQUAL_TO_CODE,"9")){if((original.value.length<1)&&(!(isTabAllowed))){cancelEvent(event);isTabAllowed=true}}}}function cancelEvent(event){event.cancelBubble=true;event.returnValue=false;if(event.stopPropagation){event.stopPropagation();event.preventDefault()}}function easyDOBEntry(objDOB,isInlineEntry,isYearField,isSetTabAllowed){var objLength;if(objDOB!=null){if(isInlineEntry){if(isYearField){if(objDOB.value.length==2&&objDOB.value>0){if(isSetTabAllowed){isTabAllowed=true}else{objDOB.value="19"+objDOB.value}}}else{if(objDOB.value.length==1&&objDOB.value>0){if(isSetTabAllowed){isTabAllowed=true}else{objDOB.value="0"+objDOB.value}}}}else{objLength=objDOB.length;if(objLength){if(objDOB[0].value<10&&objDOB[0].value>0&&objDOB[0].value.length<2){objDOB[0].value="0"+objDOB[0].value}if(objDOB[1].value<10&&objDOB[1].value>0&&objDOB[1].value.length<2){objDOB[1].value="0"+objDOB[1].value}if(objDOB[2].value<100&&objDOB[2].value.length==2){objDOB[2].value="19"+objDOB[2].value}}else{if(objDOB.value<100&&objDOB.value>0){objDOB.value="19"+objDOB.value}}}}}function removeCharFromField(event,field,unAllowedChar,removeType){var charInput;if(removeType==null||removeType==""){removeType=REMOVE_IF_EQUAL_TO_REMOVE_CHAR}charInput=charKeyPressed(event);if(removeType==REMOVE_IF_EQUAL_TO_REMOVE_CHAR){if((checkKeyPress(event,GREATER_THAN_CODE,"0"))&&(!(checkKeyPress(event,EQUAL_TO_CODE,"9")))&&(!(checkKeyPress(event,EQUAL_TO_CODE,"16")))){if(charInput==unAllowedChar){cancelEvent(event)}}}else{if(removeType==REMOVE_NONNUMERIC){if(!(checkKeyPress(event,EQUAL_TO_CODE,"8")||checkKeyPress(event,EQUAL_TO_CODE,"9")||checkKeyPress(event,EQUAL_TO_CODE,"27")||checkKeyPress(event,EQUAL_TO_CODE,"46")||checkKeyPress(event,EQUAL_TO_CODE,"37")||checkKeyPress(event,EQUAL_TO_CODE,"39"))&&isNaN(charInput)){cancelEvent(event)}}}}function charKeyPressed(event){var code;if(!event){event=window.event}if(event.keyCode){code=event.keyCode}else{if(event.which){code=event.which}}if(code>0){return String.fromCharCode(code)}return""}function checkKeyPress(event,typeOfCheck,codeToCheck){var ret=false;switch(typeOfCheck){case ALPHANUMERIC:if(((event.keyCode>=48&&event.keyCode<=57)||(event.keyCode>=65&&event.keyCode<=90)||(event.keyCode>=96&&event.keyCode<=105))||((event.which>=48&&event.which<=57)||(event.which>=65&&event.which<=90)||(event.which>=96&&event.which<=105))){ret=true}break;case EQUAL_TO_CODE:if((event.keyCode==codeToCheck)||(event.which==codeToCheck)){ret=true}break;case GREATER_THAN_CODE:if((event.keyCode>codeToCheck)||(event.which>codeToCheck)){ret=true}break;case LESS_THAN_CODE:if((event.keyCode<codeToCheck)||(event.which<codeToCheck)){ret=true}break;default:return ret}return ret}function ShowPharmacyHours(name,pharmacynode,labelName){var pharmacyID=document.getElementById(pharmacynode).selectedIndex;if(pharmacyID!=null){var id=name+pharmacyID;if(pharmacyID==0){document.getElementById(labelName).innerHTML="&nbsp;"}else{document.getElementById(labelName).innerHTML=document.getElementById(id).value}}}function clearRadioSelection(radioName){var radioElement,i;radioElement=document.getElementsByName(radioName);for(i=0;i<radioElement.length;i++){if(radioElement[i].type=="radio"){radioElement[i].checked=false}}}function UpdateDeliveryMethods(name,pharmacynode,methodsInputName,methodsLabelName,isInitialLoad){var pharmacyID,id,methods,list,i,radioID,radioLabelID,catVal,paymentlist,radioElement,radioLabel,deliverySection,paymentSection,AlreadyChecked,defaultOption;pharmacyID=document.getElementById(pharmacynode).selectedIndex;if(pharmacyID!=null){id=name+pharmacyID;if(document.getElementById(id)==null){deliverySection=document.getElementById("deliveryoptions");if(deliverySection){applyClass(deliverySection,"hidden");deliverySection.disabled=true}showAndHideButtons("send","paynext");paymentSection=document.getElementById("paymentoptions");if(paymentSection){applyClass(paymentSection,"hidden");paymentSection.disabled=true}hidePickupFields("pickupoptions");return}methods=document.getElementById(id).value;list=methods.split("^");hidePickupFields("pickupoptions");if(methods.length==0){deliverySection=document.getElementById("deliveryoptions");if(deliverySection){applyClass(deliverySection,"hidden");deliverySection.disabled=true}}else{AlreadyChecked=false;deliverySection=document.getElementById("deliveryoptions");if(deliverySection){removeClassNames(deliverySection,"hidden");deliverySection.disabled=false}for(catVal=1;catVal<4;catVal++){radioID=methodsInputName+catVal;radioLabelID=methodsLabelName+catVal;radioElement=document.getElementById(radioID);if(radioElement){if(radioElement.checked&&(isInitialLoad==1)){AlreadyChecked=true;if(radioElement.value==1){showPickupFields("pickupoptions")}}else{radioElement.checked=false}radioElement.disabled=true;applyClass(radioElement,"hidden");radioLabel=document.getElementById(radioLabelID);applyClass(radioLabel,"hidden");radioLabel.disabled=true}else{continue}for(i=0;i<list.length;i++){paymentlist=list[i].split("|");if(paymentlist[0]==catVal){radioElement.disabled=false;removeClassNames(radioElement,"hidden");removeClassNames(radioLabel,"hidden");radioLabel.disabled=false;if(!defaultOption){defaultOption=radioElement}}}}if((list.length>0)&&(!AlreadyChecked)&&defaultOption){defaultOption.checked=true;if(defaultOption.value==1){showPickupFields("pickupoptions")}}}UpdatePaymentMethods("pharmacymethods","pharmacy","deliverymethod","paymentmethod","paymentmethodlabel",isInitialLoad)}}function UpdatePaymentMethods(prefix,pharmacynode,deliveryNode,paymentInput,paymentLabel,isInitialLoad){var pharmacyID,id,methods,list,i,radioElement,radioLabelID,catVal,paymentlist,deliveryID,pos,paymentMethods,j,paymentInfo,paymentSection,AlreadyChecked,defaultOption;showAndHideButtons("send","paynext");paymentSection=document.getElementById("paymentoptions");if(paymentSection){applyClass(paymentSection,"hidden");paymentSection.disabled=true}pharmacyID=document.getElementById(pharmacynode).selectedIndex;deliveryID=getRadioValue(deliveryNode);if((pharmacyID!=null)&&(deliveryID.length!=0)){id=prefix+pharmacyID;methods=document.getElementById(id).value;list=methods.split("^");paymentInfo="";for(i=0;i<list.length;i++){pos=list[i].indexOf("|");if(pos<0){catVal=list[i]}else{catVal=list[i].substring(0,pos)}if(deliveryID==catVal){if(pos>=0){paymentInfo=list[i].substring(pos+1)}break}}if(paymentInfo.length>0){AlreadyChecked=false;paymentlist=paymentInfo.split("|");paymentSection=document.getElementById("paymentoptions");if(paymentSection){removeClassNames(paymentSection,"hidden");paymentSection.disabled=false}paymentMethods=document.getElementsByName(paymentInput);for(i=0;i<paymentMethods.length;i++){pos=paymentMethods[i].id.indexOf("_");if(pos<0){continue}catVal=paymentMethods[i].id.substring(pos+1);if(catVal.length==0){continue}radioLabelID=paymentLabel+"_"+catVal;radioElement=document.getElementById(radioLabelID);if(isInitialLoad&&paymentMethods[i].checked){AlreadyChecked=true;if(paymentMethods[i].value==2){showAndHideButtons("paynext","send")}}else{paymentMethods[i].checked=false}if(!defaultOption){defaultOption=paymentMethods[i]}paymentMethods[i].disabled=true;applyClass(paymentMethods[i],"hidden");applyClass(radioElement,"hidden");radioElement.disabled=true;for(j=0;j<paymentlist.length;j++){if(paymentlist[j]==catVal){paymentMethods[i].disabled=false;removeClassNames(paymentMethods[i],"hidden");removeClassNames(radioElement,"hidden");radioElement.disabled=false}}}if((paymentlist.length>0)&&(!AlreadyChecked)&&defaultOption){defaultOption.checked=true;if(defaultOption.value==2){showAndHideButtons("paynext","send")}}}}}function HidePharmacyText(pharmDropdown,pharmDropdownId,otherPharmIndex,pharmacyTextId){var otherIndex,pharmacyText;if(!pharmDropdown){pharmDropdown=document.getElementById(pharmDropdownId)}if(pharmDropdown){otherIndex=document.getElementById(otherPharmIndex);pharmacyText=document.getElementById(pharmacyTextId);if((otherIndex)&&(pharmacyText)){if(pharmDropdown.options[pharmDropdown.selectedIndex].value==otherIndex.value){pharmacyText.disabled=false;removeClassNames(pharmacyText,"hidden")}else{pharmacyText.disabled=true;applyClass(pharmacyText,"hidden")}}}}function getRadioValue(radioName){var radioList,i;radioList=document.getElementsByName(radioName);if(radioList.length==0){return""}for(i=0;i<radioList.length;i++){if(radioList[i].checked==true){return radioList[i].value}}return""}function showAndHideButtons(showButton,hideButton){var showBtn,hideBtn;showBtn=document.getElementById(showButton);if(showBtn){showBtn.disabled=false;removeClassNames(showBtn,"hidden")}hideBtn=document.getElementById(hideButton);if(hideBtn){hideBtn.disabled=true;applyClass(hideBtn,"hidden")}}function showPickupFields(divName){if(document.getElementById(divName)){document.getElementById(divName).className=""}}function hidePickupFields(divName){if(document.getElementById(divName)){document.getElementById(divName).className="hidden"}}function isValidEmail(sEmail){var myRegExp=new RegExp(/^\s*[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}\s*$/);return myRegExp.test(sEmail)}function $T(tag,text){if(tag){if(typeof tag.innerText!=="undefined"){tag.innerText=text}if(typeof tag.textContent!=="undefined"){tag.textContent=text}}return tag}function $(id){if(!id){return null}var ret=document.getElementById(id);if(ret){ret.$T=function(newTextValue){$T(ret,newTextValue)}}return ret}function clearElement(element){if(!element){return}element.innerHTML="";element.value="";element.innerText="";while(element.hasChildNodes()){element.removeChild(element.lastChild)}}var MyChartLocale="en-US";function decodeMnemonics(text,Mnemonics){var mnenonic,re;Mnemonics=Mnemonics||{};for(mnenonic in Mnemonics){if(typeof mnenonic==="string"){re=new RegExp(mnenonic,"g");text=text.replace(re,Mnemonics[mnenonic])}}return text}var HTMLEncodeDecodeDiv=document.createElement("div");function HTMLUnencode(val){HTMLEncodeDecodeDiv.innerHTML=val||"";return HTMLEncodeDecodeDiv.innerText||HTMLEncodeDecodeDiv.textContent}function HTMLEncode(val){HTMLEncodeDecodeDiv.appendChild(document.createTextNode(val||""));return HTMLEncodeDecodeDiv.innerHTML}function createElement(tagtype,className,ID){var tag=document.createElement(tagtype||"div");if(className){tag.className=className}if(ID){tag.id=ID}return tag}function createImage(className,ID,src,alt){var img=createElement("img",className,ID);img.src=MyChartLocale+"/Images/"+(src||"");img.alt=alt||"";img.title=alt||"";return img}function getOffset(tag,property){var ret=tag[property];while(tag=tag.offsetParent){ret+=tag[property]}return ret}function createAlert(alertHTML,hasYield,errContainer){if(alertHTML.length===0){clearElement(errContainer);return}var errH3,errImg,errTxt,errSpan;errH3=createElement("h3","alert");if(hasYield===true){errImg=createImage("","","yield.png","yield");errH3.appendChild(errImg)}errTxt=createElement("div","errHolder");errTxt.innerHTML=alertHTML;errH3.appendChild(errTxt);if(errContainer){errContainer.appendChild(errH3);errContainer.className=""}return errH3}function getChild(node,childNum){var ret=node.firstChild;while(childNum>0){childNum--;while(ret.nodeName==="#comment"||ret.nodeName==="#text"){ret=ret.nextSibling}ret=ret.nextSibling}while(ret.nodeName==="#comment"||ret.nodeName==="#text"){ret=ret.nextSibling}return ret}function openWindow(sUrl,sName,sFeatures){var newWindow,windowList,numWindows;if(typeof sFeatures==="undefined"||sFeatures===""){sFeatures="status=0,menubar=0,scrollbars=1,resizable=1,toolbar=0"}windowList=getCookie("openWindows");if(windowList===""){numWindows=0}else{numWindows=windowList.split("^").length}if(typeof sName==="undefined"||sName===""){sName="mycWin"+numWindows}newWindow=window.open(sUrl,sName,sFeatures);windowList=windowList+(windowList.length>0?"^":"")+sName;setCookie("openWindows",windowList)}function closeAllWindows(){var windowsStr,windowsArr,theWindow,index,tempWindow;windowsStr=getCookie("openWindows");if(windowsStr){windowsArr=windowsStr.split("^");for(index in windowsArr){theWindow=windowsArr[index];if(theWindow){tempWindow=window.open("",theWindow,"");if(tempWindow&&tempWindow.close){tempWindow.close()}}}deleteCookie("openWindows")}}function setCookie(name,value,expires){var cookieString;if(name){cookieString=name+"="+escape(value);cookieString+=(expires?"; expires="+expires.toGMTString():"");document.cookie=cookieString}}function getCookie(name){var cookieString,cookieArray,done,index,regExKey,regExTrim,keyValue,value;value="";cookieString=document.cookie;if(!cookieString||cookieString.length===0){return value}cookieArray=cookieString.split(";");if(cookieArray){regExKey=new RegExp(name+"s?=");regExTrim=/^\s+|\s+$/g;for(index=0;index<cookieArray.length&&!done;index=index+1){keyValue=cookieArray[index].replace(regExTrim,"");if(keyValue.search(regExKey)>-1){value=unescape(keyValue.substr(keyValue.indexOf("=")+1)).replace(regExTrim,"");done=true}}}return value}function deleteCookie(name){if(name){setCookie(name,getCookie(name),(new Date(1)))}}function makeLink(relativeUrl){var prefix;prefix=getPrefix(false);return applyPrefix(prefix,relativeUrl)}function makeStaticLink(relativeUrl){var prefix,retVal;relativeUrl=relativeUrl.replace(/\\/g,"/");if(relativeUrl.indexOf(".")===0){relativeUrl=relativeUrl.substring(1)}if(relativeUrl.indexOf(".")===0){relativeUrl=relativeUrl.substring(1)}if(relativeUrl.indexOf("/")===0){relativeUrl=relativeUrl.substring(1)}prefix=getPrefix(true);retVal=applyPrefix(prefix,"en-US/"+relativeUrl);return retVal}function getPrefix(isStatic){var retVal;if(isStatic){retVal=""}else{retVal=""}if(retVal.length===0){retVal="@mychart@url@"}return retVal}function applyPrefix(prefix,relativeUrl){var anchor,anchorStart,retVal;if(!prefix||!relativeUrl){return relativeUrl}anchorStart=relativeUrl.indexOf("#");if(anchorStart>0){anchor=relativeUrl.substring(anchorStart+1);relativeUrl=relativeUrl.substring(0,anchorStart)}retVal=prefix.replace(/@mychart@url@/gi,relativeUrl);retVal=retVal.replace(/@mychart@wrappedurl@/gi,encodeURIComponent(relativeUrl));if(anchorStart>0){retVal=retVal+"#"+anchor}return retVal};var intKeepAliveCnt=0;function intKeepalive(){};function setOther(ctrlname){var ctrlother=document.getElementById(ctrlname+"other"),textVal,ctrl;if(ctrlother!==null){textVal=ctrlother.value;if(textVal===""){return true}if(IsNumericMinMax(ctrlother,"0")===false){return false}}ctrl=document.getElementById(ctrlname+"id");if(ctrl!==null){ctrl.checked=true}}function nextRowSameProblem(ctrlname){var index,compname,dropdown,cellobj,rowobj,nextrow,nextrowname,issame;index=ctrlname.indexOf("rel");compname=ctrlname.slice(0,index);dropdown=document.getElementById(ctrlname);cellobj=dropdown.parentNode;rowobj=cellobj.parentNode;nextrow=rowobj.nextSibling;if(nextrow===null){return false}if(nextrow.nodeType!==1){nextrow=nextrow.nextSibling;if(nextrow===null){return false}}nextrowname=nextrow.lastChild.lastChild.name;index=(nextrowname.indexOf("delrel"));nextrowname=nextrowname.slice(0,index);if(compname===nextrowname){issame=true}else{issame=false}return issame}function addRow(oldname,oldrow,olddropdownhtml,stepnum){var newrow,num,newctrlname,newname,cellProb,newHTML,cellName,cellComments,cellButton,index,link,cellDropdown,nextrow,tableobj,ajaxh,dropdown;index=oldname.indexOf("rel");newname=oldname.slice(0,index+3);num=oldname.slice(index+3);num=parseInt(num,10)+1;newname=newname+num;newctrlname=newname;cellProb=WP.DOM.Create.tag("td");cellProb.className="prob";cellProb.innerHTML="&nbsp;";cellDropdown=WP.DOM.Create.tag("td");cellDropdown.className="famrel";newHTML=olddropdownhtml;newHTML=newHTML.replace(new RegExp(oldname,"gi"),newname);cellDropdown.innerHTML=newHTML;cellName=WP.DOM.Create.tag("td");cellName.className="famrel";oldname=oldname.replace("rel","name");newname=newname.replace("rel","name");newHTML=oldrow.childNodes[2].innerHTML;newHTML=newHTML.replace(new RegExp(oldname,"gi"),newname);cellName.innerHTML=newHTML;cellName.childNodes[0].childNodes[1].value="";cellComments=WP.DOM.Create.tag("td");cellComments.className="famrel";oldname=oldname.replace("name","comments");newname=newname.replace("name","comments");newHTML=oldrow.childNodes[3].innerHTML;newHTML=newHTML.replace(new RegExp(oldname,"gi"),newname);cellComments.innerHTML=newHTML;cellComments.childNodes[0].childNodes[1].value="";cellButton=WP.DOM.Create.tag("td");cellButton.className="famrel";oldname=oldname.replace("comments","delrel");newname=newname.replace("comments","delrel");newHTML=oldrow.childNodes[4].innerHTML;newHTML=newHTML.replace(new RegExp(oldname,"gi"),newname);cellButton.innerHTML=newHTML;cellButton.childNodes[0].className="hidden";newrow=WP.DOM.Create.tag("tr");newrow.appendChild(cellProb);newrow.appendChild(cellDropdown);newrow.appendChild(cellName);newrow.appendChild(cellComments);newrow.appendChild(cellButton);nextrow=oldrow.nextSibling;tableobj=oldrow.parentNode;tableobj.insertBefore(newrow,nextrow);dropdown=document.getElementById(newctrlname);dropdown.value="";ajaxh=new AJAXHandler();link=window.location.href;index=link.indexOf("inside.asp");link=link.slice(index);link=link+"&addrow=true&ctrlname="+newctrlname+"&stepnum="+stepnum+"&amp;co=true";link=makeLink(link);ajaxh.init(link,function(response){},"GET",1)}function removeRow(ctrlname){var rowobj,tableobj,buttonobj,nextbuttonobj,txtbox,nexttxtbox,commentsbox,nextcommentsbox,dropdown,index,rownum,cellobj,nextrowobj,nextrowctrlname,nextdropdown,newHTML,dropdowncell;index=ctrlname.indexOf("rel");index=index+3;rownum=ctrlname.slice(index);if((rownum.length)>1){rownum=rownum.slice(3)}dropdown=document.getElementById(ctrlname);cellobj=dropdown.parentNode;rowobj=cellobj.parentNode;if(rowobj.childNodes[0].innerHTML!=="&nbsp;"){nextrowobj=rowobj.nextSibling;if(nextrowobj.nodeType!==1){nextrowobj=nextrowobj.nextSibling}buttonobj=rowobj.childNodes[4];nextbuttonobj=nextrowobj.childNodes[4];nextrowctrlname=nextbuttonobj.childNodes[0].id;newHTML=nextbuttonobj.innerHTML;newHTML=newHTML.replace(new RegExp(nextrowctrlname,"gi"),ctrlname);buttonobj.innerHTML=newHTML;nextdropdown=nextrowobj.childNodes[1].childNodes[0];dropdowncell=rowobj.childNodes[1];nextrowctrlname=nextrowctrlname.replace("delrel","rel");ctrlname=ctrlname.replace("delrel","rel");newHTML=nextrowobj.childNodes[1].innerHTML;newHTML=newHTML.replace(new RegExp(nextrowctrlname,"gi"),ctrlname);dropdowncell.innerHTML=newHTML;dropdown=dropdowncell.childNodes[0];dropdown.value=nextdropdown.value;txtbox=rowobj.childNodes[2].childNodes[0].childNodes[1];nexttxtbox=nextrowobj.childNodes[2].childNodes[0].childNodes[1];txtbox.value=nexttxtbox.value;commentsbox=rowobj.childNodes[3].childNodes[0].childNodes[1];nextcommentsbox=nextrowobj.childNodes[3].childNodes[0].childNodes[1];commentsbox.value=nextcommentsbox.value;tableobj=nextrowobj.parentNode;tableobj.removeChild(nextrowobj);rowobj.childNodes[1].firstChild.focus()}else{tableobj=rowobj.parentNode;nextrowobj=rowobj.nextSibling;nextrowobj.childNodes[1].firstChild.focus();tableobj.removeChild(rowobj)}}function removeRowKeyPress(ctrlname,e){if(window.event){if(event.keyCode===32){removeRow(ctrlname);e.returnValue=false}}else{if(e.which){if(e.which===32){removeRow(ctrlname);e.preventDefault()}}}}function showbutton(element){removeClassNames(element,"hidden");element.className=element.className+" button"}function hidebutton(element){removeClassNames(element,"button");removeClassNames(element,"hidden");element.className=element.ClassName+" hidden"}function setFamName(ctrlname,stepnum){var relval,txtName,dropdown,txtBox,pieces,famname,cmntsName,cmntsBox,cellobj,compname,index,nextrow,nextrowname,rowobj,olddropdownhtml;dropdown=document.getElementById(ctrlname);olddropdownhtml=dropdown.parentNode.innerHTML;relval=dropdown.value;if(relval.length!==0){pieces=relval.split("^");famname=pieces[1];if(dropdown[0].value.length===0){dropdown.remove(0)}}txtName=ctrlname.replace("rel","name");txtBox=document.getElementById(txtName);cmntsName=ctrlname.replace("rel","comments");cmntsBox=document.getElementById(cmntsName);if(relval.length!==0){index=ctrlname.indexOf("rel");compname=ctrlname.slice(0,index);cellobj=dropdown.parentNode;rowobj=cellobj.parentNode;nextrow=rowobj.nextSibling;if(nextrow!==null){if(nextrow.nodeType!==1){nextrow=nextrow.nextSibling}}if(nextrow===null){showbutton(rowobj.childNodes[4].lastChild);addRow(ctrlname,rowobj,olddropdownhtml,stepnum)}else{nextrowname=nextrow.lastChild.lastChild.name;index=(nextrowname.indexOf("delrel"));nextrowname=nextrowname.slice(0,index);if(nextRowSameProblem(ctrlname)===false){showbutton(rowobj.childNodes[4].lastChild);addRow(ctrlname,rowobj,olddropdownhtml,stepnum)}}}if((famname!=="#single#")&&(famname!=="#other#")&&(famname.length!==0)){txtBox.value=famname;if(famname.length>0){if(txtBox.value.length>0){removeClassNames(txtBox,"non-empty");txtBox.className=txtBox.className+" non-empty"}}}else{txtBox.value=""}cmntsBox.value=""}function buttonclick(labelID,e,disableDeselect){var lblCtl,lblCtlName,inpCtl,inpCtlName,inpCtlVal,inputCtlArr,i;inpCtl=document.getElementById("INP_"+labelID);if(!disableDeselect){disableDeselect=0}if(disableDeselect===1){if(!inpCtl.checked){inpCtl.checked=true}}else{if(e){if(e.target){if(e.target.nodeName.toUpperCase()!=="INPUT"){inpCtl.checked=!inpCtl.checked}}else{if(e.srcElement){if(e.srcElement.nodeName.toUpperCase()!=="INPUT"){inpCtl.checked=!inpCtl.checked}}}}}inpCtlName=inpCtl.getAttribute("name");inputCtlArr=document.getElementsByName(inpCtlName);for(i=0;i<inputCtlArr.length;i++){inpCtl=inputCtlArr[i];inpCtlVal=inpCtl.value;if(inpCtl.getAttribute("type")==="text"){continue}inpCtlName=inpCtl.getAttribute("name");lblCtlName=inpCtlName+"_"+inpCtlVal;lblCtl=document.getElementById(lblCtlName);if(inpCtl.checked){lblCtl.setAttribute("class","radio selected");lblCtl.setAttribute("className","radio selected")}else{lblCtl.setAttribute("class","radio unselected");lblCtl.setAttribute("className","radio unselected")}}inpCtl=document.getElementById("TXT_"+labelID);if(inpCtl!==null){if(document.getElementById("INP_"+labelID).checked){inpCtl.focus()}else{document.getElementById("ANC_"+labelID).focus()}}}function hxbuttonclick(labelID,e,disableDeselect,showsub){var element,inpCtl;buttonclick(labelID,e,disableDeselect);element=document.getElementById("DIV_"+labelID.slice(0,labelID.lastIndexOf("_")));inpCtl=document.getElementById("INP_"+labelID);if(showsub===1){if(inpCtl.checked){showElement(element)}else{hideElement(element)}}if(showsub===0){hideElement(element)}}function buttonclickfam(labelID,e,problem){var inpCtl,cnt,morerows,dropdowncell,nextrow,row,cell,ctrlname,dropdown,txtName,txtBox,txtBoxCell,cmntsBox,cmntsName,cmntsBoxCell,buttonName,button,buttonCell;buttonclick(labelID,e);inpCtl=document.getElementById("INP_"+labelID);cnt=1;morerows=true;do{if(inpCtl.checked){if(cnt>1){row=dropdowncell.parentNode;nextrow=row.nextSibling;cell=nextrow.childNodes[1];cell=cell.firstChild;ctrlname=cell.name}else{ctrlname=labelID+"rel"+cnt;ctrlname=ctrlname.replace("_","fam")}dropdown=document.getElementById(ctrlname);dropdown.disabled=false;dropdowncell=dropdown.parentNode;removeClassNames(dropdowncell,"unselfamrel");dropdowncell.className="famrel";txtName=ctrlname.replace("rel","name");txtBox=document.getElementById(txtName);txtBoxCell=txtBox.parentNode.parentNode;removeClassNames(txtBoxCell,"unselfamrel");txtBoxCell.className="famrel";txtBox.disabled=false;cmntsName=ctrlname.replace("rel","comments");cmntsBox=document.getElementById(cmntsName);cmntsBox.disabled=false;cmntsBoxCell=cmntsBox.parentNode.parentNode;removeClassNames(cmntsBoxCell,"unselfamrel");cmntsBoxCell.className="famrel";buttonName=ctrlname.replace("rel","delrel");button=document.getElementById(buttonName);buttonCell=button.parentNode;buttonCell.className="famrel"}else{if(cnt>1){row=dropdowncell.parentNode;nextrow=row.nextSibling;cell=nextrow.childNodes[1];cell=cell.firstChild;ctrlname=cell.name}else{ctrlname=labelID+"rel"+cnt;ctrlname=ctrlname.replace("_","fam")}dropdown=document.getElementById(ctrlname);dropdown.disabled=true;dropdowncell=dropdown.parentNode;removeClassNames(dropdowncell,"famrel");dropdowncell.className="unselfamrel";txtName=ctrlname.replace("rel","name");txtBox=document.getElementById(txtName);txtBoxCell=txtBox.parentNode.parentNode;removeClassNames(txtBoxCell,"famrel");txtBoxCell.className="unselfamrel";txtBox.disabled=true;cmntsName=ctrlname.replace("rel","comments");cmntsBox=document.getElementById(cmntsName);cmntsBox.disabled=true;cmntsBoxCell=cmntsBox.parentNode.parentNode;removeClassNames(cmntsBoxCell,"famrel");cmntsBoxCell.className="unselfamrel";buttonName=ctrlname.replace("rel","delrel");button=document.getElementById(buttonName);buttonCell=button.parentNode;buttonCell.className="unselfamrel"}cnt=cnt+1}while(nextRowSameProblem(ctrlname))}function buttonKeyPress(labelID,e,disableDeselect){if(checkKeyPress(e,EQUAL_TO_CODE,"32")){buttonclick(labelID,e,disableDeselect);cancelEvent(e)}}function buttonKeyPressFam(labelID,e,problem){if(window.event){if(event.keyCode===32){buttonclickfam(labelID,e,problem);e.returnValue=false}}else{if(e.which){if(e.which===32){buttonclickfam(labelID,e,problem);e.preventDefault()}}}}function hxButtonKeyPress(labelID,e,disableDeselect,showsub){if(checkKeyPress(e,EQUAL_TO_CODE,"32")){hxbuttonclick(labelID,e,disableDeselect,showsub);cancelEvent(e)}}function previewRowClick(rowNum){var ButtonElt;if(rowNum.length===0){return}ButtonElt=document.getElementById("buttonedit_"+rowNum);ButtonElt.click()}function setPlaceholderStyle(labelID){var element;element=document.getElementById(labelID);if(element.value.length>0){removeClassNames(element,"non-empty");element.className=element.className+" non-empty"}else{removeClassNames(element,"non-empty")}}function clearPlaceholderStyle(labelID){var element;element=document.getElementById(labelID);removeClassNames(element,"non-empty");element.className=element.className+" non-empty"}function setOpacity(imgEltId,opacityClass){var imgElt;imgElt=document.getElementById(imgEltId);imgElt.setAttribute("class","button "+opacityClass)}function previewRowOver(rowNum){var rowElt;rowElt=document.getElementById("rowedit_"+rowNum);rowElt.className+=" hover";setOpacity("buttonedit_"+rowNum,"opaque")}function previewRowOut(rowNum){var rowElt,rowClass;rowElt=document.getElementById("rowedit_"+rowNum);rowClass=rowElt.className;rowClass=rowClass.replace(new RegExp("hover\\b"),"");rowElt.className=rowClass;setOpacity("buttonedit_"+rowNum,"transparent")}function previewButtonClick(button,lqlID){var url,hash;if(button===null){return true}url=button.form.action;hash=url.indexOf("#");if(hash>-1){url=url.substr(0,hash)}button.form.action=url+"#"+lqlID;return true}function IE8ButtonBlur(ev){removeClassNames(ev.srcElement.parentNode,"focus")}function IE8ButtonFocus(ev){applyClass(ev.srcElement.parentNode,"focus")}function setupButtonsIE8(){var btns=document.getElementsByTagName("input"),i,el;for(i=0;i<btns.length;i++){el=btns[i];if(!/clearradio/.test(el.className)){continue}WP.Events.addListener(el,"blur",IE8ButtonBlur);WP.Events.addListener(el,"focus",IE8ButtonFocus)}};if(typeof(WP)==="undefined"){var WP={}}if(typeof(WP.Events)==="undefined"){WP.Events={};WP.Events.addListener=function(element,event,fun,runOnce){var addEvent,regEvent,runOnceFun;if(!element){return false}runOnceFun=function(element,event,fun){return function(){fun();WP.Events.removeListener(element,event,regEvent)}};regEvent=(runOnce===true)?runOnceFun(element,event,fun):fun;WP.Events.getAttacher(false,element,event)(regEvent)};WP.Events.removeListener=function(element,event,fun){var eventList,i,removeEvent;if(!element){return false}WP.Events.getAttacher(true,element,event)(fun)};WP.Events.fireEvent=function(element,eventName,eventObject){if(!element){return false}if(element.fireEvent){element.fireEvent("on"+eventName)}else{eventObject=eventObject||document.createEvent("Event");if(eventObject){eventObject.initEvent(eventName,true,true,window);element.dispatchEvent(eventObject)}}};WP.Events.getAttacher=function(forRemoval,element,event){var isIframe=(element.tagName==="IFRAME"),oldRemove,oldAdd,old,nodeName;nodeName=(element.nodeName||element.tagName||"").toLowerCase();oldRemove=function(fun){var eventList,i;eventList=element.WPEvents["on"+event];if(!eventList){return}for(i=0;i<eventList.length;i+=1){if(eventList[i]===fun){eventList.splice(i,1);return}}};oldAdd=function(fun){var onEvent="on"+event,eventList;if(!element.WPEvents){element.WPEvents={}}eventList=element.WPEvents[onEvent];if(!eventList){element.WPEvents[onEvent]=[];eventList=element.WPEvents[onEvent];if(typeof element[onEvent]==="function"){eventList[0]=element[onEvent]}element[onEvent]=WP.Events.handle(element,onEvent)}eventList[eventList.length]=fun};old=function(){return(forRemoval===true?oldRemove:oldAdd)};if(event.indexOf("load")>-1){if(isIframe){element=window[element.name]}else{if(element===document.body){element=window}}}if(element.attachEvent){if(event==="click"&&typeof element.onclick!=="function"&&nodeName==="a"){element.onclick=function(){return false}}if(forRemoval===true){return function(fun){element.detachEvent("on"+event,fun)}}return function(fun){element.attachEvent("on"+event,fun)}}else{if(element.addEventListener){if(isIframe){element=window[element.name]}if(event==="click"&&typeof element.onclick!=="function"&&nodeName==="a"){element.onclick=function(){return false}}if(isIframe&&event.indexOf("load")>-1){return old()}if(forRemoval===true){return function(fun){element.removeEventListener(event,fun,true)}}return function(fun){element.addEventListener(event,fun,true)}}}return old()};WP.Events.getThis=function(e){var evt=e||window.event;if(!evt){return null}return evt.target||evt.srcElement};WP.Events.handle=function(element,onevent){return function(evt){var i,ret=true,eventList=element[onevent];evt=evt||window.event;for(i=0;i<eventList.length;i+=1){try{ret=eventList[i](evt);if(ret==="false"){return false}if(typeof ret==="string"&&ret.length>0){return ret}}catch(ex){}}return ret}};WP.Events.cancelEvent=function(e){e=(e||window.event);if(!e){return false}e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation()}return false};WP.Events.preventDefault=function(e){e=(e||window.event);if(!e){return false}e.returnValue=false;if(e.preventDefault){e.preventDefault()}return false};WP.Events.beforeUnload=function(message,testFunction){var f=function(evt){if(WP.Events.beforeUnload.alreadyRan===true){return}if(typeof(testFunction)==="function"&&testFunction()===false){return}evt=evt||window.event;evt.returnValue=message;WP.Events.beforeUnload.alreadyRan=true;window.setTimeout(WP.Events.beforeUnload.trigger,5000);return message};WP.Events.addListener(window,"beforeunload",f);WP.Events.beforeUnload.message=message;WP.Events.beforeUnload.fun=f;return function(){WP.Events.removeListener(window,"beforeunload",f)}};WP.Events.beforeUnload.alreadyRan=false;WP.Events.beforeUnload.trigger=function(){WP.Events.beforeUnload.alreadyRan=false}};function specialEffects(){var i,j,f,currentURL,pefURL;if((!document.getElementsByTagName)||(!document.getElementById)){return false}setScannedImageSize();var url=document.location;var topmenu=document.getElementById("menu");var menus=[];var formname;if(topmenu){var prxMode;var menudisplay=topmenu.style.display;topmenu.style.display="none";menus=topmenu.getElementsByTagName("ul");if(menus.length>0){currentURL=url.toString();currentURL=currentURL.substring(currentURL.indexOf("mode=")+5);if(currentURL.indexOf("&")>0){currentURL=currentURL.substring(0,currentURL.indexOf("&"))}switch(currentURL){case"showform":currentURL=url.toString();currentURL=currentURL.substring(currentURL.indexOf("mode=")+5);formname=currentURL.substring(currentURL.length-20);if((formname=="formname=ApptReqDept")||(formname=="formname=ApptReqProv")){currentURL="showform&formname=ApptReqCntr"}break;case"labdetail":currentURL="labs";break;case"labchartgraph":currentURL="labs";break;case"displayscans":currentURL="labs";break;case"fshreport":currentURL="fshreportlist";break;case"cccsum":currentURL="cclist";break;case"crmsum":currentURL="cclist";break;case"msgapptmake":currentURL="apptsched";break;case"tktapptmake":currentURL="apptmake";break;case"accountdetail":currentURL="accountsummary";break;case"recentpay":currentURL="accountsummary";break;case"hbaccountdetail":currentURL="accountsummary";break;case"hospaccntdetail":currentURL="accountsummary";break;case"hospstmntdetail":currentURL="accountsummary";break;case"payment":currentURL="accountsummary";break;case"sboaccountdetail":currentURL="accountsummary";break;case"paperless":currentURL="accountsummary";break;case"benefitdetail":currentURL="insurance";break;case"hmsched":currentURL="healthmaint";break;case"deptdrive":currentURL="appointments";break;case"editwalletcard":currentURL="walletcard";break;case"eligibility":currentURL="coverage";break;case"claims":currentURL="coverage";break;case"referrals":currentURL="coverage";break;case"benefitinfo":currentURL="coverage";break;case"visitsummary":currentURL="recentappts";break;case"copaypayment":currentURL="appointments";break;case"medadvice":currentURL="msgoptions";break;case"evisit":currentURL="msgoptions";break;case"questionnaire":if(url.toString().indexOf("src=list")>0){currentURL="questionnairelist"}else{if(url.toString().indexOf("mid")>0){currentURL="messages&mbox=1"}else{if(url.toString().indexOf("evQtn")>0){currentURL="msgoptions"}else{if(url.toString().indexOf("svyQtn")>0){currentURL="questionnairelist"}else{if(url.toString().indexOf("Qtn")>0){currentURL="appointments"}else{if(url.toString().indexOf("quesid")>0){currentURL="questionnairelist"}}}}}}break;case"apptcancel":if(url.toString().indexOf("src=apptdetail")>0){currentURL="appointments"}else{currentURL="apptcancelpage"}break;case"apptdircancel":if(url.toString().indexOf("src=apptdetail")>0){currentURL="appointments"}else{currentURL="apptcancelpage"}break;case"provsrch":if(url.toString().indexOf("mnu=ds")>0){currentURL="apptmake"}else{if(url.toString().indexOf("mnu=chg")>0){currentURL="chgpcp"}}break;case"itinerary":if(url.toString().indexOf("dat")>0){currentURL="admissions"}break;case"histques":if(url.toString().indexOf("mid")>0){currentURL="messages&mbox=1"}else{if(url.toString().indexOf("Qtn")>0){currentURL="appointments"}}break;case"messages":if(url.toString().indexOf("mbox=2")>0){currentURL="messages&mbox=2"}else{currentURL="messages&mbox=1"}break;case"apptdetails":if(url.toString().indexOf("recentvisit=yes")>0){currentURL="recentappts"}else{if(url.toString().indexOf("fromIP=1")>0){currentURL="itinerary"}else{if(url.toString().indexOf("fromHos=1")>0){currentURL="admissions"}else{currentURL="appointments"}}}break;case"stdfile":if(url.toString().indexOf("option")>0){currentURL="stdfile&option="+url.toString().match("option=[A-Za-z0-9_]*")[0].substr(7)}break;case"crr":if(url.toString().indexOf("fromEv")>0){currentURL="msgoptions"}else{if(url.toString().indexOf("proccode")>0){currentURL="labs"}else{if(url.toString().indexOf("ndc")>0){currentURL="medslist"}else{if(url.toString().indexOf("icd")>0){currentURL="hlthissues"}else{currentURL="snapshot"}}}}break;case"showrep":if(url.toString().indexOf("submode=")>0){pefURL=url.toString();pefURL=pefURL.substring(pefURL.indexOf("submode=")+8);currentURL="showrep&submode="+pefURL}break;case"pefltdtl":if(url.toString().indexOf("fltid=")>0){pefURL=url.toString();pefURL=pefURL.substring(pefURL.indexOf("fltid=")+6);if(pefURL.toString().indexOf("&")>0){pefURL=pefURL.substring(0,pefURL.toString().indexOf("&"))}currentURL="pefltdtl&fltid="+pefURL}else{currentURL="pefltlst"}break;case"mycondition":if(url.toString().indexOf("id=")>0){var mycondURL=url.toString();mycondURL=mycondURL.substring(mycondURL.indexOf("id=")+3);if(mycondURL.toString().indexOf("&")>0){mycondURL=mycondURL.substring(0,mycondURL.toString().indexOf("&"))}currentURL="mycondition&id="+mycondURL}break;case"proxyaccess":if(url.toString().indexOf("id=")>0){var prxURL=url.toString();prxURL=prxURL.substring(prxURL.indexOf("id=")+3);if(prxURL.toString().indexOf("&")>0){prxURL=prxURL.substring(0,prxURL.toString().indexOf("&"))}currentURL="proxyaccess&action=switchcontext&src=0&id="+prxURL;prxMode="proxyaccess"}break;case"echeckin":currentURL="appointments";break;default:break}var collapsible=(topmenu.className=="collapsible");var items,link,mode;for(i=0;i<menus.length;i++){if(menus[i].className.indexOf("home")>=0){continue}if(menus[i].className.indexOf("richdisplay")>=0){continue}if(collapsible){closeMenu(menus[i])}items=menus[i].getElementsByTagName("a");for(j=0;j<items.length;j++){link=items[j].getAttribute("href");if(link){mode=link.substring(link.indexOf("mode=")+5);if(currentURL==mode){if(collapsible){openMenu(menus[i])}if(items[j].parentNode.className!="title"){items[j].parentNode.className="selected"}prxMode=""}}}}if(prxMode&&prxMode.length>0){for(i=0;i<menus.length;i++){items=menus[i].getElementsByTagName("a");for(j=0;j<items.length;j++){link=items[j].getAttribute("href");if(link){mode=link.substring(link.indexOf("mode=")+5);if(prxMode==mode){if(collapsible){openMenu(menus[i])}if(items[j].parentNode.className!="title"){items[j].parentNode.className="selected"}prxMode="";j=items.length;i=menus.length}}}}}}topmenu.style.display=menudisplay}if(url.toString().indexOf("printmode")==-1){try{generateTableEffects()}catch(tableErr){}try{setupExpandableTables()}catch(expandErr){}try{setupTabbedSections()}catch(tabbedErr){}}resizeLargeImgAndTable();if(typeof loadGraphs==="function"){try{loadGraphs()}catch(err){}}var forms=document.getElementsByTagName("form");for(i=0;i<forms.length;i++){forms[i].setAttribute("autocomplete","off")}var inputs=document.getElementsByTagName("input");for(i=0;i<inputs.length;i++){inputs[i].setAttribute("autocomplete","off")}if(url.toString().indexOf("printmode")==-1&&!window.location.hash){var focusSet=false;for(f=0;f<document.forms.length;f++){if(document.forms[f].parentNode.id!="menu"){for(i=0;i<document.forms[f].length;i++){if(document.forms[f][i].type!="hidden"&&document.forms[f][i].className.indexOf("readonly")==-1&&document.forms[f][i].className.indexOf("hidden")==-1&&document.forms[f][i].className.indexOf("button")==-1&&document.forms[f][i].className.indexOf("radio")==-1&&document.forms[f][i].className.indexOf("noautofocus")==-1&&document.forms[f][i].nodeName.toLowerCase()!="fieldset"&&document.forms[f][i].disabled!=true&&document.forms[f][i].parentNode.style.display!="none"){document.forms[f][i].focus();focusSet=true}if(focusSet){break}}}if(focusSet){break}}if(url.toString().indexOf("reply")>0){var tas=document.getElementsByTagName("textarea");if(tas.length>0){tas[0].focus()}}}if(!window.location.hash){setTimeout("window.scroll(0,0);",1)}var printbar=document.getElementById("printbar");if(printbar){printbar.style.display="block"}if(url.toString().indexOf("printmode")>0){var mainTag;if(document.getElementById("main")){mainTag=document.getElementById("main")}else{mainTag=document.getElementById("datatile")}var links=mainTag.getElementsByTagName("a");for(i=0;i<links.length;i++){links[i].href="";links[i].onclick="";links[i].removeAttribute("href");links[i].removeAttribute("onclick");links[i].removeAttribute("title");links[i].removeAttribute("target")}var rows=mainTag.getElementsByTagName("tr");for(i=0;i<rows.length;i++){rows[i].onclick="";rows[i].removeAttribute("onclick");rows[i].removeAttribute("title")}var inputsFields=mainTag.getElementsByTagName("input");for(i=0;i<inputsFields.length;i++){inputsFields[i].disabled=true}var selects=mainTag.getElementsByTagName("select");for(i=0;i<selects.length;i++){selects[i].disabled=true}var textareas=mainTag.getElementsByTagName("textarea");for(i=0;i<textareas.length;i++){textareas[i].disabled=true}}doTextHighlight();matchWrapHeight()}function matchWrapHeight(){var elemToStretch,divWrap=document.getElementById("wrap"),divBaselinks=document.getElementById("baselinks"),WpadBtm,padTop,padBtm,mgnBtm,BLpadTop=0;if(!(elemToStretch=document.getElementById("infoColumn"))){if(document.getElementById("menu")){elemToStretch=document.getElementById("main")}}if(elemToStretch){if(elemToStretch.style.minHeight){elemToStretch.style.minHeight="0px"}WpadBtm=parseInt(WP.DOM.Read.getStyle(divWrap,"padding-bottom"));padTop=parseInt(WP.DOM.Read.getStyle(elemToStretch,"padding-top"));padBtm=parseInt(WP.DOM.Read.getStyle(elemToStretch,"padding-bottom"));mgnBtm=parseInt(WP.DOM.Read.getStyle(elemToStretch,"margin-bottom"));if(divBaselinks){BLpadTop=parseInt(WP.DOM.Read.getStyle(divBaselinks,"padding-top"))}elemToStretch.style.minHeight=(divWrap.offsetHeight-elemToStretch.offsetTop-WpadBtm-padTop-padBtm-mgnBtm-BLpadTop)+"px"}}function highlightNodeText(node,searchStr){var children,expression,child,index,spanElmnt;if(node===null){return}children=node.childNodes;if(children===null||children.length===0){return}expression=new RegExp("("+searchStr+")","gi");for(index=0;index<children.length;index=index+1){child=children[index];if(child!==null){if(child.nodeType===3){if(expression.test(child.nodeValue)){spanElmnt=document.createElement("span");spanElmnt.innerHTML=child.nodeValue.replace(expression,'<span class="hilite">$1</span>');node.insertBefore(spanElmnt,child);node.removeChild(child)}}else{if(child.nodeType===1){highlightNodeText(child,searchStr)}}}}}function doTextHighlight(){var highlightForm,inputElmntArr,inputElmnt,highlightStr,highlightIdElmnt,highlightId,highlightRootElmnt,index;highlightForm=document.getElementById("hilitefxform");if(highlightForm===null){return}highlightIdElmnt=document.getElementById("hilitefxid");if(highlightIdElmnt===null){return}highlightId=highlightIdElmnt.value;if(typeof highlightId==="undefined"||highlightId===null||highlightId.length===0){return}highlightRootElmnt=document.getElementById(highlightId);if(highlightRootElmnt===null){return}inputElmntArr=highlightForm.getElementsByTagName("input");if(inputElmntArr===null){return}var srchblArr=new Array(3);srchblArr[0]=document.getElementsByTagName("TD");srchblArr[1]=document.getElementsByTagName("DIV");srchblArr[2]=document.getElementsByTagName("SPAN");var j,k,srchblElmnt;for(j=0;j<srchblArr.length;j=j+1){for(k=0;k<srchblArr[j].length;k=k+1){srchblElmnt=srchblArr[j][k];if(containsClassName(srchblElmnt,"srchbl")){for(index=0;index<inputElmntArr.length;index=index+1){inputElmnt=inputElmntArr[index];if(inputElmnt===null){return}if(inputElmnt.getAttribute("id")===null||inputElmnt.getAttribute("id").indexOf("hilitefxid")===-1){highlightStr=inputElmnt.value;if(highlightStr.length>0){highlightNodeText(srchblElmnt,highlightStr)}}}}}}}function setupExpandableTables(){var tables,rows,index,index2,tableKids;tables=document.getElementsByTagName("table");for(index=0;index<tables.length;index++){if(tables[index].className.indexOf("expandable")>-1){tableKids=tables[index].children;for(index2=0;index2<tableKids.length;index2++){if(tableKids[index2].tagName.toLowerCase()==="tbody"){rows=tableKids[index2].children;index2=tableKids.length}}if(rows!==null&&rows!==undefined){for(index2=0;index2<rows.length;index2++){if(rows[index2].className.indexOf("clickable")>-1){collapseTableRow(rows[index2],function(){expandTableRowExcl(this);return false})}}}}}}function expandTableRow(trElmnt){setSlaveRowDisp(trElmnt,true);trElmnt.onclick=function(){collapseTableRow(this,function(){expandTableRow(this);return false});return false}}function collapseTableRow(trElmnt,expFunc){setSlaveRowDisp(trElmnt,false);trElmnt.onclick=expFunc}function expandTableRowExcl(trElmnt){var rows,index;rows=trElmnt.parentNode.children;for(index=0;index<rows.length;index++){if(rows[index].className.indexOf("clickable")>-1){collapseTableRow(rows[index],function(){expandTableRowExcl(this);return false})}}setSlaveRowDisp(trElmnt,true);trElmnt.onclick=function(){collapseTableRow(this,function(){expandTableRowExcl(this);return false});return false}}function setSlaveRowDisp(trElmnt,IsShown){var slaveElmnt,imgs,tds,imgStr,dispAttr,index,slaveId;slaveId=trElmnt.getAttribute("id");if(slaveId!==null){slaveId=slaveId.substring(5,slaveId.length)}slaveElmnt=document.getElementById(slaveId);if(slaveElmnt!==null){imgs=trElmnt.getElementsByTagName("img");tds=slaveElmnt.children;if(IsShown){imgStr="en-US/images/rowopen.gif";dispAttr=""}else{imgStr="en-US/images/rowclosed.gif";dispAttr="none"}slaveElmnt.style.display=dispAttr;for(index=0;index<tds.length;index++){tds[index].style.display=dispAttr}if(imgs.length>0&&imgs[0].className.indexOf("icon")>-1){imgs[0].setAttribute("src",imgStr)}}}function setupTabbedSections(){var tabdiv,links,index,url,urlMatches,linkId,selectedLink;tabdiv=document.getElementById("innertabs");if(tabdiv!==null){links=tabdiv.getElementsByTagName("a");if(links.length>0){for(index=0;index<links.length;index=index+1){links[index].onclick=function(){showTabbedSection(this);return false}}url=document.location.toString();urlMatches=url.match("tabbedsec=tab_[A-Za-z0-9_]*");if(urlMatches!==null&&urlMatches.length>0){linkId=urlMatches[0].split("=")[1];selectedLink=document.getElementById(linkId);if(selectedLink!==null){showTabbedSection(selectedLink)}else{showTabbedSection(links[0])}}else{showTabbedSection(links[0])}}}}function showTabbedSection(linkElmnt){var links,secID,secElmnt,index;links=linkElmnt.parentNode.parentNode.getElementsByTagName("a");for(index=0;index<links.length;index=index+1){links[index].className="";secID=links[index].getAttribute("id");secID=secID.substring(4,secID.length);secElmnt=document.getElementById(secID);if(secElmnt!==null){secElmnt.style.display="none"}}linkElmnt.className="selected";secID=linkElmnt.getAttribute("id");secID=secID.substring(4,secID.length);secElmnt=document.getElementById(secID);if(secElmnt!==null){secElmnt.style.display="block"}}function closeMenu(menu){var image,j,submenus;menu.className="closed";image=menu.getElementsByTagName("img")[0];if(image&&image.className=="arrow"){image.setAttribute("src","en-US/images/menuclosed.gif");image.setAttribute("alt","Expand Menu");image.setAttribute("title","Expand Menu")}submenus=menu.getElementsByTagName("li");for(j=1;j<submenus.length;j++){submenus[j].style.display="none"}submenus[0].onclick=function(){openMenu(this.parentNode);return false};matchWrapHeight()}function openMenu(menu){var image,menus,i,j,submenus;menus=menu.parentNode.parentNode.getElementsByTagName("ul");for(i=0;i<menus.length;i++){if(menus[i].className.indexOf("home")>=0){continue}if(menus[i].className.indexOf("richdisplay")>=0){continue}closeMenu(menus[i])}menu.className="";image=menu.getElementsByTagName("img")[0];if(image&&image.className=="arrow"){image.setAttribute("src","en-US/images/menu.gif");image.setAttribute("alt","Close Menu");image.setAttribute("title","Close Menu")}submenus=menu.getElementsByTagName("li");for(j=1;j<submenus.length;j++){submenus[j].style.display="block"}submenus[0].onclick=function(){closeMenu(this.parentNode);return false};matchWrapHeight()}function setScannedImageSize(){var img,w,h,maxW;maxW=700;if(img=document.getElementById("scan")){w=img.width;if(w>maxW){h=img.height*maxW/w;h=h-h%1;w=maxW;img.style.height=""+h+"px";img.style.width=""+w+"px"}}}function adjustLightbox(){var divLB=document.getElementById("lightbox"),divWrap=document.getElementById("wrap"),realLBHeight,child,marginTop,newTop;if(!divLB||!divWrap){return}realLBHeight=divLB.clientHeight;for(childnum=0;childnum<divLB.children.length;childnum++){child=divLB.children[childnum];if(realLBHeight<child.clientHeight){realLBHeight=child.clientHeight}}if(window.innerHeight){if(realLBHeight>window.innerHeight){return}newTop=window.pageYOffset+0.5*(window.innerHeight-realLBHeight)}else{if(realLBHeight>document.documentElement.clientHeight){return}newTop=document.documentElement.scrollTop+0.5*(document.documentElement.clientHeight-realLBHeight)}marginTop=parseInt(WP.DOM.Read.getStyle(divWrap,"margin-top"));newTop=newTop-marginTop;if(newTop<0){newTop=0}divLB.style.marginTop=newTop+"px"}function hideLightbox(){var divLB=document.getElementById("lightbox"),divLBoverlay=document.getElementById("lightbox_overlay");if(!divLB||!divLBoverlay){return}divLB.style.display="none";divLBoverlay.style.display="none"}function initLightbox(url,callbackFunction){var ah=new AJAXHandler(),divLB=document.getElementById("lightbox"),divLBoverlay=document.getElementById("lightbox_overlay"),fillLightbox,Tadjust;if(!ah||!divLB||!divLBoverlay){window.location.href=url;return}fillLightbox=function(response){divLB.innerHTML=response;divLBoverlay.style.display="block";divLB.style.display="block";adjustLightbox();if(WP.Events){WP.Events.addListener(window,"resize",function(){if(Tadjust!==null){clearTimeout(Tadjust)}Tadjust=setTimeout(adjustLightbox,100)});WP.Events.addListener(window,"scroll",function(){if(Tadjust!==null){clearTimeout(Tadjust)}Tadjust=setTimeout(adjustLightbox,100)})}divLB.setAttribute("tabindex",0);divLB.focus();if(typeof callbackFunction==="function"){callbackFunction()}};try{ah.init(url,fillLightbox,"GET","lb=true",ah.RESPONSETYPE_CONTENTONLY)}catch(err){window.location.href=url}}function moretabsFocus(){var elem=document.getElementById("moretabs");if(elem){elem.className=elem.className.replace(/\s*mtHide/," mtShow")}}function moretabsBlur(){var elem=document.getElementById("moretabs");if(elem){elem.className=elem.className.replace(/\s*mtShow/," mtHide")}}function localesLinkFocus(){var elem=document.getElementById("morelocales");if(elem){replaceClassNames(elem,"localeHide","localeShow")}}function localesLinkBlur(){var elem=document.getElementById("morelocales");if(elem){replaceClassNames(elem,"localeShow","localeHide")}}var proxyPopup;var gotTheMessage=false;function photoIframe(photoID){var iframe=document.getElementById("iframeproxypicker_"+photoID),spin,tr,td,tbody,photo,delPhoto;tbody=iframe.parentElement.parentElement.parentElement.parentElement;spin=new WP.Controls.ProgressSpinner(iframe.parentNode.parentNode," ","inline",16);photo=document.getElementById("photoImg_"+photoID);spin.hide();tr=WP.DOM.Create.tag("tr","tableRowMessage preview");td=WP.DOM.Create.tag("td","tableProxyMessage alert");td.colSpan=5;tr.appendChild(td);tbody.appendChild(tr);iframe.writeError=function(msg){td.innerHTML=msg;if(spin.oldDisp){photo.style.display=spin.oldDisp}spin.hide();photo.style.display=spin.oldDisp};iframe.showFocus=function(hasFocus){var f=hasFocus===true?applyClass:removeClassNames;f(getChild(iframe.parentElement,0),"focus")};iframe.setHover=function(isHovering){var f=isHovering===true?applyClass:removeClassNames;f(getChild(iframe.parentElement,0),"hover")};iframe.previousElement=WP.DOM.Search.getPrevious(iframe);while(!WP.DOM.Test.canFocus(iframe.previousElement)){iframe.previousElement=WP.DOM.Search.getPrevious(iframe.previousElement)}WP.Events.addListener(iframe.previousElement,"keydown",function(e){var keyCode,evt;evt=e||window.event;keyCode=evt.keyCode||evt.which;if(keyCode===9&&evt.shiftKey===false){window.setTimeout(function(){iframe.focusInner()},1);return WP.Events.cancelEvent(e)}});delPhoto=document.getElementById("photodelete_"+photoID);delPhoto.style.display=(photo.src.indexOf("ProxySilhouette.png")>0)?"none":"";WP.Events.addListener(delPhoto,"click",function(){var fld;if(spin.isHidden===false){iframe.src=iframe.src;spin.hide();photo.style.display=spin.oldDisp;delPhoto.style.display=(photo.src.indexOf("ProxySilhouette.png")>0)?"none":"";return}photo.src="./en-US/images/ProxySilhouette.png";fld=document.getElementById("photo_"+photoID);fld.value="";WP.Events.fireEvent(fld,"change");delPhoto.style.display="none";iframe.nextElement=document.getElementById("displayName_"+photoID)});window.setTimeout(function(){iframe.nextElement=delPhoto.style.display==="none"?document.getElementById("displayName_"+photoID):delPhoto},1);iframe.showSpinner=function(){spin.show();spin.oldDisp=photo.style.display;photo.style.display="none";delPhoto.style.display=""};iframe.viewer={addImage:function(){},transferToForm:function(){}};iframe.onupload=function(type,fileDescription,fullKey,thumbkey){var fld;photo.style.display=spin.oldDisp;spin.hide();if(type!==1){iframe.writeError("Only images may be used as your patient photo.");return}fld=document.getElementById("photo_"+photoID);fld.value="showfile.asp?key="+thumbkey;WP.Events.fireEvent(fld,"change");photo.src="showfile.asp?key="+thumbkey;delPhoto.style.display="";iframe.nextElement=delPhoto;window.setTimeout(function(){if(gotTheMessage===false){alert("When you click Save on the profile page, this image will be saved to the medical record and visible to medical staff.")}gotTheMessage=true},1)};if(!proxyPopup){proxyPopup=document.getElementById("popupphotopopup");proxyPopup.parentElement.removeChild(proxyPopup);document.getElementById(tbody.parentElement.id+"_col0").appendChild(proxyPopup)}}function updateSilhouetteColor(changedItem,photoID){var oldClass,photo=document.getElementById("photoImg_"+photoID);if(!photo){return}oldClass=photo.className.substr(photo.className.indexOf("color"),6);removeClassNames(photo,oldClass);applyClass(photo,escape(changedItem.value))}function setupActionBar(){var container=document.getElementById("actionitem"),anchors,anchor,lastAnchor;dropOn=function(e){var evt=e||window.event,node=WP.Events.getThis(evt);while(node&&!(node.id==="actionitem")){node=node.parentElement}applyClass(node,"openaction");return WP.Events.cancelEvent(e)};dropOff=function(e){var evt=e||window.event,node=WP.Events.getThis(evt),isClick=(evt.type==="keydown");while(node&&!(node.id==="actionitem")){node=node.parentElement}removeClassNames(node,"openaction");return WP.Events.cancelEvent(e)};if(container){anchors=container.getElementsByTagName("A");if(anchors){anchor=anchors[0];lastAnchor=anchors[anchors.length-1];WP.Events.addListener(container,"mouseover",dropOn);WP.Events.addListener(container,"mouseout",dropOff);if(anchor){WP.Events.addListener(anchor,"click",dropOn);WP.Events.addListener(anchor,"keydown",function(e){var evt=e||window.event,key=evt.keyCode||evt.which;if(key===9&&evt.shiftKey===true){dropOff(e)}})}if(lastAnchor){WP.Events.addListener(lastAnchor,"keydown",function(e){var evt=e||window.event,key=evt.keyCode||evt.which;if(key===9&&evt.shiftKey!==true){dropOff(e)}})}}}}function showSubwayUI(){var numPast,numFuture,$subway,$subwayStops,$pastStops,$futureStops,$subwayLine,$pastLines,$futureLines;$subway=$(".subway");if($subway.length>0){$subwayStops=$subway.find(".stops"),$subwayLine=$subway.find(".line");$pastStops=$subwayStops.find(".past"),$futureStops=$subwayStops.find(".future");$pastLines=$subwayLine.find(".past"),$futureLines=$subwayLine.find(".future");numPast=$pastStops.length;numFuture=$futureStops.length;if(numPast>0){$pastLines.eq(-1).addClass("showStep");$pastStops.eq(-1).addClass("showStep");$pastLines.eq(-2).addClass("showStep");$pastStops.eq(-2).addClass("showStep");$pastLines.eq(-3).addClass("showStep");if(numFuture==0){$pastStops.eq(-3).addClass("showStep");$pastLines.eq(-4).addClass("showStep")}}if(numFuture>0){$futureLines.eq(0).addClass("showStep");$futureStops.eq(0).addClass("showStep");$futureLines.eq(1).addClass("showStep");if(numPast<2){$futureStops.eq(1).addClass("showStep");$futureLines.eq(2).addClass("showStep");if(numPast<1){$futureStops.eq(2).addClass("showStep");$futureLines.eq(3).addClass("showStep")}}}if(($subwayStops.children().length)>4){if(($futureStops.length)<2){$subwayLine.addClass("leftShift")}else{if(($pastStops.length)<3){$subwayLine.addClass("rightShift")}}}}}function resizeLargeImgAndTable(){var tablewidth,parentwidth,imgwidth,tbls,index,wrapper,imgs,tblSelector,imgSepector,j;tbls=document.querySelectorAll(".report table");for(index=0;index<tbls.length;index++){imgs=tbls[index].getElementsByTagName("img");if(imgs.length>0){tbls[index].style.tableLayout="fixed";tablewidth=tbls[index].parentNode.clientWidth;for(j=0;j<imgs.length;j++){imgwidth=imgs[j].width;parentwidth=imgs[j].parentNode.offsetWidth;if(imgwidth>tablewidth&&imgs[j].parentNode.className!="large_img"){wrapper=WP.DOM.Create.tag("div","large_img","","","");wrapper.appendChild(imgs[j].cloneNode(true));imgs[j].parentNode.replaceChild(wrapper,imgs[j])}}}}if(getUrlValue("mode")=="letters"){tblSelector="body.inside .section table";imgSepector="body.inside .section img"}else{tblSelector=".section#summary table,.section#discharge table,.section#patedu table,.section#instructions table,.report table";imgSepector=".section#summary img,.section#discharge img,.section#patedu img,.section#instructions img"}tbls=document.querySelectorAll(tblSelector);for(index=0;index<tbls.length;index++){tablewidth=tbls[index].width;parentwidth=tbls[index].parentNode.offsetWidth;if(tablewidth>parentwidth){wrapper=WP.DOM.Create.tag("div","table_wrapper","","","");wrapper.appendChild(tbls[index].cloneNode(true));tbls[index].parentNode.replaceChild(wrapper,tbls[index])}}imgs=document.querySelectorAll(imgSepector);for(index=0;index<imgs.length;index++){imgwidth=imgs[index].width;parentwidth=imgs[index].parentNode.offsetWidth;if(imgwidth>parentwidth&&imgs[index].parentNode.className!="large_img"){wrapper=WP.DOM.Create.tag("div","large_img","","","");wrapper.appendChild(imgs[index].cloneNode(true));imgs[index].parentNode.replaceChild(wrapper,imgs[index])}}}function getUrlValue(valueName){var paramString,paramArray,param,i;paramString=window.location.search.substring(1);paramArray=paramString.split("&");for(i=0;i<paramArray.length;i++){param=paramArray[i].split("=");if(param[0]==valueName){return param[1]}}};function highlightColorband(e){var obj=WP.Events.getThis(e);if(obj.className.indexOf("colorband")<0){obj=obj.parentNode}applyClass(obj,"selected")}function lowlightColorband(e){var obj=WP.Events.getThis(e);if(obj.className.indexOf("colorband")<0){obj=obj.parentNode}removeClassNames(obj,"selected")}function generateMouseOverEffect(rows){var fcn_over,fcn_out,fcn_stopProp,fcn_check,fcn_p,i,numRows,j,headers,check,p,anchors,anchor;fcn_over=function(numRows,whichRow){return function(e){var parentRow=WP.Events.getThis(e),parentTable,k,baseRow;while(parentRow.nodeName.toUpperCase()!="TR"){parentRow=parentRow.parentNode}parentTable=parentRow.parentNode;while(parentTable.nodeName.toUpperCase()!="TBODY"){parentTable=parentTable.parentNode}parentTable=parentTable.rows;baseRow=parentRow.sectionRowIndex-whichRow;for(k=0;k<numRows;k++){applyClass(parentTable[baseRow+k],"hover")}}};fcn_out=function(numRows,whichRow){return function(e){var parentRow=WP.Events.getThis(e),parentTable,k,baseRow;while(parentRow.nodeName.toUpperCase()!="TR"){parentRow=parentRow.parentNode}parentTable=parentRow.parentNode;while(parentTable.nodeName.toUpperCase()!="TBODY"){parentTable=parentTable.parentNode}parentTable=parentTable.rows;baseRow=parentRow.sectionRowIndex-whichRow;for(k=0;k<numRows;k++){removeClassNames(parentTable[baseRow+k],"hover")}}};fcn_stopProp=function(event){if(document.all){window.event.cancelBubble=true}else{event.stopPropagation()}};fcn_check=function(event){var obj=WP.Events.getThis(event);if(obj.className.indexOf("colorband")>-1){obj=obj.cb}if(obj.onclickOrig){obj.onclickOrig()}fcn_stopProp(event)};fcn_p=function(event){if(WP.Events.getThis(event).cb){WP.Events.getThis(event).cb.checked=!WP.Events.getThis(event).cb.checked;fcn_check(event)}};for(i=0;i<rows.length;i++){if(rows[i].onclick!=null){numRows=parseInt(rows[i].getElementsByTagName("td")[0].getAttribute("rowspan"),10);if(numRows<1||isNaN(numRows)){numRows=1}for(j=0;j<numRows;j++){rows[i+j].className+=" clickable";WP.Events.addListener(rows[i+j],"mouseover",fcn_over(numRows,j));WP.Events.addListener(rows[i+j],"focus",fcn_over(numRows,j));WP.Events.addListener(rows[i+j],"mouseout",fcn_out(numRows,j));WP.Events.addListener(rows[i+j],"blur",fcn_out(numRows,j))}headers=rows[i].getElementsByTagName("th");for(j=0;j<headers.length;j++){WP.Events.addListener(headers[j],"mouseover",fcn_stopProp);WP.Events.addListener(headers[j],"focus",fcn_stopProp);WP.Events.addListener(headers[j],"click",fcn_stopProp)}check=rows[i].getElementsByTagName("input")[0];if(check&&check.className.indexOf("radio")>-1){if(check.onclick){check.onclickOrig=check.onclick}WP.Events.addListener(check,"click",fcn_check);p=check.parentNode;if(p&&p.className&&p.className.indexOf("colorband")>-1){p.cb=check;WP.Events.addListener(p,"click",fcn_p);WP.Events.addListener(p,"mouseover",highlightColorband);WP.Events.addListener(p,"focus",highlightColorband);WP.Events.addListener(p,"mouseout",lowlightColorband);WP.Events.addListener(p,"blur",lowlightColorband)}}anchors=rows[i].getElementsByTagName("a");for(j=0;j<anchors.length;j++){anchor=anchors[j];if(anchor){anchor.onclick=fcn_stopProp}}i+=numRows-1}}}function toggleTimeDetails(){var detailclass,urlHTML,IsChange,tdArray,indx,tdElmnt,linkArr,link,numFound,timeUrlArr;linkArr=document.getElementsByTagName("A");numFound=0;timeUrlArr=[];if(linkArr!==null){for(indx=0;indx<linkArr.length;indx=indx+1){link=linkArr[indx];if(link!==null&&link.getAttribute("id")==="timeurl"){timeUrlArr[numFound]=link;numFound=numFound+1;if(numFound===1){if(link.innerHTML.toString().indexOf("Hide Times")<0){detailclass="inlinetime";urlHTML="Hide Times"}else{detailclass="inlinetime  hidden";urlHTML="Show Times"}}}}}if(numFound>0){tdArray=document.getElementsByTagName("TD");if(tdArray===null||tdArray.length===0){return}for(indx=0;indx<tdArray.length;indx=indx+1){tdElmnt=tdArray[indx];if(tdElmnt!==null&&tdElmnt.className!==null&&tdElmnt.className.indexOf("inlinetime")>-1){tdElmnt.className=detailclass;IsChange=true}}if(IsChange){for(indx=0;indx<timeUrlArr.length;indx=indx+1){link=timeUrlArr[indx];link.innerHTML=urlHTML}}}}function generateTableEffects(){var rows,calendar,dates;rows=document.getElementsByTagName("tr");generateMouseOverEffect(rows);calendar=document.getElementById("aspcalendar");if(calendar!=null){dates=calendar.getElementsByTagName("td");generateMouseOverEffect(dates)}toggleTimeDetails()}function writeTimeURL(){if(typeof(document)=="object"){document.write('<a id="timeurl" href="javascript:toggleTimeDetails()">Hide Times</a>')}}function createTableOverlay(tableId){var tmpDiv,tableHtml,tableContainer,tableElement,overlayWrapper,overlayWrapperId,tmpNode,done,expr;if(tableId===null||tableId.length===0){return}tableElement=document.getElementById(tableId);if(tableElement===null){return}tableHtml=tableElement.innerHTML;if(tableHtml===null||tableHtml.length===0){return}expr=new RegExp(">s+<","g");tableHtml=tableHtml.replace(expr,"><");tableHtml='<table id="'+tableId+'_ovrly_tb" class="'+tableElement.className+' ">'+tableHtml+"</table>";overlayWrapperId=tableId+"_ovrly_dv";overlayWrapper=document.getElementById(overlayWrapperId);if(overlayWrapper!==null){hideElement(null,overlayWrapperId);overlayWrapper.innerHTML=tableHtml;showElement(null,overlayWrapperId);return}else{tableContainer=tableElement.parentNode;if(tableContainer!==null){tableContainer=tableContainer.parentNode}if(tableContainer===null){return}tmpDiv=document.createElement("div");tmpDiv.setAttribute("id",overlayWrapperId);tmpDiv.className="tableOverlay";tmpDiv.innerHTML=tableHtml;tableContainer.appendChild(tmpDiv)}overlayWrapper=document.getElementById(overlayWrapperId);if(overlayWrapper===null){return}tmpNode=overlayWrapper.firstChild;while(tmpNode!==null&&!done){if(tmpNode.tagName.toUpperCase()==="TABLE"){tmpNode.setAttribute("summary","Please ignore this table. It is a copy of the previous one.")}tmpNode=tmpNode.nextSibling}}function handleSearchFldFocus(fldId){var inputElmnt,pos,className;inputElmnt=document.getElementById(fldId);if(inputElmnt===null){return}className=inputElmnt.className;if(className===null){return}pos=className.indexOf("empty");if(pos>=0){inputElmnt.value="";removeClassNames(inputElmnt,"empty")}else{inputElmnt.select()}}function handleSearchFldBlur(fldId){var inputElmnt;inputElmnt=document.getElementById(fldId);if(inputElmnt===null){return}if(inputElmnt.value===""){inputElmnt.className=inputElmnt.className+" empty";inputElmnt.value="Search this list"}}function handleSearchBtnClick(elmntId,value){var element;if(typeof elmntId!=="string"||typeof value!=="string"){return}element=document.getElementById(elmntId);if(element===null){return}element.setAttribute("value",value)};var TotalReadingsAllowed=3;function writeAddPEFReading(formname,floDetails,totalRow,calendarImageSource,infoImageSource,caption,tooltip,displayDetails){if(TotalReadingsAllowed>1){var totalColumn,totalColumnValue=document.getElementById("totalColumn");if(totalColumnValue!=null){totalColumn=new Number(totalColumnValue.value)}if(totalColumn==TotalReadingsAllowed){document.write('<input class="button" id="AddNewReading" name="AddNewReading" tabindex="1001" onclick="buildTable(\''+formname+"','"+escape(unescape(floDetails))+"',"+totalRow+",0,'"+calendarImageSource+"','"+infoImageSource+"','"+displayDetails+'\'); return false;" type="button" disabled="disabled" title="'+tooltip+'" value="'+caption+'"/>')}else{document.write('<input class="button" id="AddNewReading" name="AddNewReading" tabindex="1001" onclick="buildTable(\''+formname+"','"+escape(unescape(floDetails))+"',"+totalRow+",0,'"+calendarImageSource+"','"+infoImageSource+"','"+displayDetails+'\'); return false;" type="button" title="'+tooltip+'" value="'+caption+'"/>')}}}function writeDeletePEFReading(formname,floDetails,totalRow,remcolumn,calendarImageSource,infoImageSource,tabind,caption,tooltip,displayDetails){document.write('<td><input class="button" tabindex=\''+tabind+"' onclick=\"buildTable('"+formname+"','"+escape(unescape(floDetails))+"',"+totalRow+","+remcolumn+",'"+calendarImageSource+"','"+infoImageSource+"','"+displayDetails+'\'); return false;" type="button" title="'+tooltip+'" value="'+caption+'" /></td>')}function nowButtonHTML(datename,hourname,minutename,AMname,PMname,timename,caption,tooltip){return'<input class="button" onclick="getCurDateTime(\''+datename+"','"+hourname+"','"+minutename+"','"+AMname+"','"+PMname+"','"+timename+'\'); return false;" type="button" title="'+tooltip+'" value="'+caption+'"/>'}function getTimeHTML(timeSeparator,amIndicator,pmIndicator,appendString,realColumn,tabIndex){var hour;var minute;var PMChecked;var timetabindex=tabIndex;var timeHTML;var totalHours=24;var ampmtabindex=tabIndex+2;var ampmHTML="";var time,newValue;if(timeSeparator!=null){if((timeSeparator.length)>0){timeHTML="<fieldset class='clearfieldset'><table><tr>";newValue=document.getElementById("hour_"+appendString+"");if(newValue!=null){hour=newValue.value}else{hour=""}var newValueMin=document.getElementById("minute_"+appendString+"");if(newValueMin!=null){minute=newValueMin.value}else{minute=""}if((amIndicator!=null)&&(pmIndicator!=null)){if(((amIndicator.length)>0)&&((pmIndicator.length)>0)){var newValueAMPM=document.getElementById("PM_"+appendString+"");if(newValueAMPM!=null){PMChecked=newValueAMPM.checked}else{PMChecked=false}if(PMChecked==true){ampmHTML="<td><label class='clearlabel' for='AM_"+realColumn+"'>AM</label><input class='radio' type='radio' id='AM_"+realColumn+"' tabindex='"+ampmtabindex+"' name='AMPM_"+realColumn+"' value='AM'  /></td><td>"+amIndicator+"</td>";ampmHTML=ampmHTML+"</tr><tr><td><label class='clearlabel' for='PM_"+realColumn+"'>PM</label><input class='radio' type='radio' id='PM_"+realColumn+"' name='AMPM_"+realColumn+"' value='PM' checked='checked' /></td><td class='topt'>"+pmIndicator+"</td>"}else{ampmHTML="<td><label class='clearlabel' for='AM_"+realColumn+"'>AM</label><input class='radio' type='radio' id='AM_"+realColumn+"' tabindex='"+ampmtabindex+"' name='AMPM_"+realColumn+"' value='AM' checked='checked' /></td><td>"+amIndicator+"</td>";ampmHTML=ampmHTML+"</tr><tr><td><label class='clearlabel' for='PM_"+realColumn+"'>PM</label><input class='radio' type='radio' id='PM_"+realColumn+"' name='AMPM_"+realColumn+"' value='PM'  /></td><td class=>"+pmIndicator+"</td>"}totalHours=12}}timeHTML=timeHTML+"<td rowspan='2'><label class='clearlabel' for='hour_"+realColumn+"'>hour</label><input class='time' type='text' id='hour_"+realColumn+"' name='hour_"+realColumn+"' tabindex='"+timetabindex+"' maxlength='2' size='1' value='"+hour+"' onblur='IsNumericMinMax(this,0,"+totalHours+",0);'></td>";timeHTML=timeHTML+"<td rowspan='2' style='font-size: 1.4em; font-family: verdana, sans-serif;'>"+timeSeparator+"</td>";timetabindex=timetabindex+1;timeHTML=timeHTML+"<td rowspan='2'><label class='clearlabel' for='minute_"+realColumn+"'>minute</label><input class='time' type='text' id='minute_"+realColumn+"' name='minute_"+realColumn+"' tabindex='"+timetabindex+"' maxlength='2' size='1' value='"+minute+"' onblur='IsNumericMinMax(this,0,59,0);'></td>";timeHTML=timeHTML+ampmHTML+"</tr></table></fieldset>"}else{newValue=document.getElementById("time_"+appendString+"");if(newValue!=null){time=newValue.value}else{time=""}timeHTML="<label class='clearlabel' for='time_"+realColumn+"'>time</label><input class='date' type='text' id='time_"+realColumn+"' name='time_"+realColumn+"' tabindex='"+timetabindex+"' MaxLength='10' value='"+time+"'/>"}}else{newValue=document.getElementById("time_"+appendString+"");if(newValue!=null){time=newValue.value}else{time=""}timeHTML=timeHTML+"<label class='clearlabel' for='time_"+realColumn+"'>time</label><input class='date' type='text' id='time_"+realColumn+"' name='time_"+realColumn+"' tabindex='"+timetabindex+"' MaxLength='10' value='"+time+"'/>"}return timeHTML}function buildTable(formname,floDetails,totalRow,remcolumn,calendarImageSource,infoImageSource,displayDetails){floDetails=unescape(floDetails);var floDetailsArray=floDetails.split("$~$");var outputStr="";var inclass;var sname;var offset;var totalColumn;var custArray;var realColumn;var nvalue;var tabind;var dispDetailsArray=displayDetails.split("$~$");var calendars=[];var objName,newValue,fielddate,i,j;offset=0;outputStr=outputStr+"<table>";outputStr=outputStr+"<thead><tr>";outputStr=outputStr+"<th class='locked'>&nbsp;</th>";var totalColumnValue;totalColumnValue=document.getElementById("totalColumn");if(totalColumnValue!=null){totalColumn=new Number(totalColumnValue.value)}if(remcolumn==0){totalColumn=totalColumn+1}if(TotalReadingsAllowed<totalColumn){return false}for(j=1;j<(totalColumn+1);j++){if(j==remcolumn){if(j==totalColumn){break}j=j+1;offset=1}outputStr=outputStr+"<th>"+dispDetailsArray[2].replace("@MYCHART@COLUMN@",(j-offset))+"</th>"}outputStr=outputStr+"</tr></thead>";outputStr=outputStr+"<tbody><tr><td id='date' class='locked'>"+dispDetailsArray[0]+"</td>";offset=0;for(j=1;j<(totalColumn+1);j++){if(j==remcolumn){if(j==totalColumn){break}j=j+1;offset=1}realColumn=j-offset;newValue=document.getElementById("date_"+j+"");if(newValue!=null){nvalue=newValue.value}else{nvalue=""}sname="date_"+realColumn;tabind=((realColumn-1)*(totalRow+5))+1;outputStr=outputStr+"<td><label class='clearlabel' for='date_"+realColumn+"'>date</label><input id='date_"+realColumn+"' tabindex='"+tabind+"' type='text' name='"+sname+"' class='date' value='"+nvalue+"' onblur='formatDateField(this,4);'>";calendars.push(sname);if((remcolumn>0)&&(totalColumn==2)){outputStr=outputStr+nowButtonHTML(sname,"hour_"+realColumn,"minute_"+realColumn,"AM_"+realColumn,"PM_"+realColumn,"time_"+realColumn,dispDetailsArray[8],dispDetailsArray[9])}outputStr=outputStr+"</td>"}outputStr=outputStr+"</tr>";offset=0;outputStr=outputStr+"<tr><td id='time' class='locked'>"+dispDetailsArray[1]+"</td>";for(j=1;j<(totalColumn+1);j++){if(j==remcolumn){if(j==totalColumn){break}j=j+1;offset=1}realColumn=j-offset;var hour;var minute;var PMChecked;tabind=((realColumn-1)*(totalRow+5))+2;outputStr=outputStr+"<td>"+getTimeHTML(dispDetailsArray[5],dispDetailsArray[6],dispDetailsArray[7],j,realColumn,tabind)+"</td>"}outputStr=outputStr+"</tr>";for(i=1;i<(totalRow+1);i++){var floArray=floDetailsArray[i].split("#^#");var floName=floArray[0];var PtInstructions=floArray[1];var floType=floArray[2];outputStr=outputStr+"<tr>";if(floType=="0"){outputStr=outputStr+"<td class='bold locked'>"+floName}else{outputStr=outputStr+"<td class='locked'>"+floName}if((PtInstructions.length)>0){outputStr=outputStr+"<div id='popup"+(i-1)+"' class='popupiconcontainer'></div>"}outputStr=outputStr+"</td>";offset=0;for(j=1;j<(totalColumn+1);j++){if(j==remcolumn){if(j==totalColumn){break}j=j+1;offset=1}realColumn=j-offset;if((floType=="0")){outputStr=outputStr+"<td>&nbsp;</td>"}else{newValue=document.getElementById("cell_"+i+"_"+j+"");if(newValue!=null){nvalue=newValue.value}else{nvalue=""}sname="value_"+i+"_"+realColumn;tabind=((realColumn-1)*(totalRow+5))+i+4;if(floType=="1"){outputStr=outputStr+"<td><label class='clearlabel' for='cell_"+i+"_"+realColumn+"'>"+floName+"</label><input class='short'  id='cell_"+i+"_"+realColumn+"' tabindex='"+tabind+"' type='text' name='"+sname+"' value='"+nvalue+"' onblur='IsNumericMinMax(this,\""+floArray[3]+'","'+floArray[4]+"\",1);'></td>"}else{if(floType=="2"){outputStr=outputStr+"<td><label class='clearlabel' for='cell_"+i+"_"+realColumn+"'>"+floName+"</label><input id='cell_"+i+"_"+realColumn+"' tabindex='"+tabind+"' type='text' name='"+sname+"' maxlength='30' value='"+nvalue+"'></td>"}else{if(floType==8){custArray=floArray[5].split("^");outputStr=outputStr+"<td><select class='short' id='cell_"+i+"_"+realColumn+"' tabindex='"+tabind+"' name='"+sname+"' value='"+nvalue+"'>";outputStr=outputStr+"<option value=''>&nbsp;</option>";for(var optioncount=1;optioncount<custArray.length;optioncount++){if(nvalue==custArray[optioncount]){outputStr=outputStr+"<option value='"+custArray[optioncount]+"' selected>"+custArray[optioncount]+"</option>"}else{outputStr=outputStr+"<option value='"+custArray[optioncount]+"'>"+custArray[optioncount]+"</option>"}}outputStr=outputStr+"</select></td>"}}}}}outputStr=outputStr+"</tr>"}if(remcolumn>0){totalColumn=totalColumn-1;fielddate=document.getElementById("AddNewReading");if(fielddate!=null){fielddate.disabled=false}}else{if(totalColumn==TotalReadingsAllowed){fielddate=document.getElementById("AddNewReading");if(fielddate!=null){fielddate.disabled=true}}}if(totalColumn>1){outputStr=outputStr+"<tr><td class='locked'>&nbsp;</td>";for(j=1;j<(totalColumn+1);j++){tabind=((j-1)*(totalRow+5))+(totalRow+5);outputStr=outputStr+"<td><input class='button' tabindex=\""+tabind+'" onclick=\'buildTable("'+formname+'","'+escape(floDetails)+'",'+totalRow+","+j+',"'+calendarImageSource+'","'+infoImageSource+'","'+displayDetails+"\"); return false;' type='button' title='"+dispDetailsArray[4]+"' value='"+dispDetailsArray[3]+"' /></td>"}outputStr=outputStr+"</tr>"}outputStr=outputStr+"</tbody></table>";outputStr=outputStr+"<input class='hidden' type='hidden' id='totalColumn' name='totalColumn' value='"+totalColumn+"' />";document.getElementById("PEF-Table").innerHTML=outputStr;for(i=0;i<totalRow;i++){floArray=floDetailsArray[i+1].split("#^#");PtInstructions=floArray[1];if((PtInstructions.length)>0){var info=WP.Controls.InfoButton($("popup"+i),PtInstructions,"popupparentdiv_"+i,null,"")}}while(calendars.length){writeCalendar(calendars.pop(),"past",calendarImageSource)}if((remcolumn>0)&&(remcolumn<totalColumn)){objName=document.getElementById("date_"+remcolumn);if(objName!=null){objName.select();objName.focus()}}else{objName=document.getElementById("date_"+totalColumn);if(objName!=null){objName.select();objName.focus()}}specialEffects()}function writeNowButton(datename,hourname,minutename,AMname,PMname,timename,caption,tooltip){if(typeof(document)=="object"&&(hourname!=null||minutename!=null||AMname!=null||PMname!=null||timename!=null||datename!=null)){document.write(nowButtonHTML(datename,hourname,minutename,AMname,PMname,timename,caption,tooltip))}}function getCurDateTime(datename,hourname,minutename,AMname,PMname,timename){var now=new Date();if(datename!=null&&document.getElementById(datename)!=null){document.getElementById(datename).value=formatDate(now)}if(hourname!=null&&minutename!=null&&document.getElementById(hourname)!=null&&document.getElementById(minutename)!=null){if(AMname!=null&&PMname!=null&&document.getElementById(AMname)!=null&&document.getElementById(PMname)!=null){if(now.getHours()>=12){document.getElementById(AMname).checked=false;document.getElementById(PMname).checked=true}else{document.getElementById(AMname).checked=true;document.getElementById(PMname).checked=false}}document.getElementById(hourname).value=formatHour(now);document.getElementById(minutename).value=formatMinute(now)}else{if(timename!=null&&document.getElementById(timename)!=null){document.getElementById(timename).value=formatTime(now)}}};function toggleChartGraph(chartDivID,graphDivID){var chartDiv,graphDiv;chartDiv=document.getElementById(chartDivID);graphDiv=document.getElementById(graphDivID);if(chartDiv!==null&&graphDiv!==null){if(graphDiv.style.display==="none"){chartDiv.style.display="none";graphDiv.style.display="block"}else{chartDiv.style.display="block";graphDiv.style.display="none"}}}function hndlSrsButnClk(button,cgPrefix,buttonType){var otherButtonId,otherButton,updtButtonId,updtButton;if(button===null){return false}otherButtonId=cgPrefix+"_"+(buttonType===1?"selectnone":"selectall");otherButton=document.getElementById(otherButtonId);if(otherButton===null){return false}updtButtonId=cgPrefix+"_updategraph";updtButton=document.getElementById(updtButtonId);if(updtButton===null){return false}disableBtn(button);enableBtn(otherButton);if(buttonType===1){enableBtn(updtButton)}else{disableBtn(updtButton)}if(buttonType===1){setCheckboxesByPrefix(cgPrefix+"_srsChk")}else{unsetCheckboxesByPrefix(cgPrefix+"_srsChk")}return false}function hndlSrsChkBxClick(cgPrefix){var allButton,clearButton,goButton;allButton=document.getElementById(cgPrefix+"_selectall");clearButton=document.getElementById(cgPrefix+"_selectnone");goButton=document.getElementById(cgPrefix+"_updategraph");if(allButton===null||clearButton===null||goButton===null){return}switch(statusOfCheckboxesByPrefix(cgPrefix+"_srsChk")){case 1:enableBtn(allButton);disableBtn(clearButton);disableBtn(goButton);break;case 2:enableBtn(allButton);enableBtn(clearButton);enableBtn(goButton);break;case 3:disableBtn(allButton);enableBtn(clearButton);break}}function hndlCGDataFieldKeyDown(e,activateIds,deactivateIds,cgPrefix,filterValue){var keyNum;if(window.event){keyNum=window.event.keyCode}else{if(e.which){keyNum=e.which}}if((e.shiftKey&&keyNum===16)||keyNum===9){return}hndlCGFldActivate(activateIds,deactivateIds,cgPrefix,filterValue)}function hndlCGFldActivate(activateIds,deactivateIds,cgPrefix,filterValue){var filterElement;activateFieldsByIds(activateIds);deactivateFieldsByIds(deactivateIds);filterElement=document.getElementById(cgPrefix+"_filter");if(filterElement===null){return}filterElement.setAttribute("value",filterValue)}function handleCGSeriesSelShow(cgPrefix){var selWrapper;if(typeof cgPrefix!=="string"){return false}selWrapper=document.getElementById(cgPrefix+"_serSelWrap");if(selWrapper===null){return false}showElement(null,cgPrefix+"_serSel");showElement(null,cgPrefix+"_serSel_hide");hideElement(null,cgPrefix+"_serSel_show");removeClassNames(selWrapper,"hide");return false}function handleCGSeriesSelHide(cgPrefix){var selWrapper;if(typeof cgPrefix!=="string"){return false}selWrapper=document.getElementById(cgPrefix+"_serSelWrap");if(selWrapper===null){return false}hideElement(null,cgPrefix+"_serSel");hideElement(null,cgPrefix+"_serSel_hide");showElement(null,cgPrefix+"_serSel_show");selWrapper.className=selWrapper.className+" hide";return false}function cgClndrCallbackFactory(datename){return function(y,m,d){var fielddate=document.getElementById(datename);if(fielddate){fielddate.holdErrors=false;fielddate.openingCalendar=false;if(y&&!isNaN(m)&&(m>-1)&&(m<12)&&d){fielddate.value=formatDate(new Date(y,m,d));if(document.createEvent){fielddate.click=function(){var event=document.createEvent("MouseEvents");event.initMouseEvent("click",true,true,this.ownerDocument.defaultView,1,0,0,0,0,false,false,false,false,0,null);this.dispatchEvent(event)}}fielddate.click()}}}}function loadGraphs(){var forms,index,currForm,formName;forms=document.getElementsByTagName("form");if(forms!==null){for(index=0;index<forms.length;index=index+1){currForm=forms[index];if(currForm!==null){if(currForm.className==="graphXmlForm"){formName=currForm.getAttribute("name");getGraphHtml(formName,2)}}}}}function getGraphHtml(formName,numRetries){var graphForm,graphName,reqestArgs,ajaxObj,responseHandler,container,graphWidth,graphHeight,graphXml,graphImg,debug,canvasFunction,errorFunction;if(typeof formName==="undefined"||formName.length===0){return true}graphForm=document.getElementById(formName);graphName=graphForm.elements.graphPrefix.value;graphWidth=graphForm.elements.width.value;graphHeight=graphForm.elements.height.value;graphXml=graphForm.elements.graphXml.value;reqestArgs="graphPrefix="+graphName;reqestArgs=reqestArgs+"&graphXml="+graphXml;container=document.getElementById(graphName+"_container");if(container===null){return false}container.style.height=graphHeight+"px";ajaxObj=new AJAXHandler();responseHandler=function(response){var innerContainer,errorContainer,expr;container.innerHTML="";expr=new RegExp(graphName+"msChart_graphPanel");if(response.match(expr)){if(numRetries>0){errorFunction="getGraphHtml('"+formName+"', "+(numRetries-1)+");"}canvasFunction="createGraphCanvas('"+graphName+"', "+graphWidth+", "+graphHeight+");";response=response.replace(/<img /i,'<IMG onload="'+canvasFunction+'" onerror="'+errorFunction+'" ');response=response.replace(/src=".*(graphing\/ChartImg\.axd[^"]*)"/i,'src="'+makeLink("$1")+'"');innerContainer=WP.DOM.Create.tag("div","cgImgContainer",graphName+"_imgContainer","",response);innerContainer.style.width=graphWidth+"px";innerContainer.style.height=graphHeight+"px";innerContainer.style.marginLeft="-"+(graphWidth/2)+"px"}else{innerContainer=WP.DOM.Create.tag("div","alert","","",'<p class="errmsg"><span class=\"clearlabel\">Error: </span>There was a problem generating the graph. Try reloading the page.</p>');if(debug){errorContainer=WP.DOM.Create.tag("div","hidden grapherror","","",response);container.appendChild(errorContainer)}}innerContainer.appendChild(cgTooltipDiv(graphName));container.appendChild(innerContainer);setupImageMapAreas(graphName);graphImg=document.getElementById(graphName+"msChart");if(graphImg!==null){graphImg.setAttribute("alt","Image of graph");graphImg.setAttribute("title","")}};ajaxObj.init(makeLink("graphing/Graph.aspx"),responseHandler,"POST",reqestArgs,ajaxObj.RESPONSETYPE_CONTENTONLY)}function createGraphCanvas(graphName,width,height){var canvas,image,container,imgContainer,context,descElement,printerFriendlyLink,graphPrinterMessage;if(!WP.DOM.Browser.isIE){return true}canvas=WP.DOM.Create.tag("canvas","graphCanvas",graphName+"_canvas");if(!canvas||typeof canvas.getContext!=="function"){if(WP.DOM.Browser.IEDocMode<9){printerFriendlyLink=document.getElementById("printerfriendlylink");if(printerFriendlyLink){printerFriendlyLink.style.visibility="hidden"}container=document.getElementById(graphName+"_container");if(!container){return true}graphPrinterMessage=WP.DOM.Create.tag("p","noPrintWarning printonly","","","Note: Printing graphs is not supported in Internet Explorer prior to version 9. Please upgrade to Internet Explorer 9 or later, or use a different web browser such as Firefox, Chrome, or Safari.");container.parentNode.insertBefore(graphPrinterMessage,container.nextSibling);container.className="hideonpaper"}return true}canvas.width=width;canvas.height=height;descElement=WP.DOM.Create.tag("p","","","","Copy of graph used for technical purposes. Please ignore.");canvas.appendChild(descElement);imgContainer=document.getElementById(graphName+"_imgContainer");if(!imgContainer){return true}canvas.style.position="absolute";canvas.style.width=width+"px";canvas.style.height=height+"px";canvas.style.left="50%";canvas.style.marginLeft=(width/-2)+"px";canvas.style.top=imgContainer.offsetTop+"px";container=document.getElementById(graphName+"_container");if(!container){return true}container.insertBefore(canvas,imgContainer);image=document.getElementById(graphName+"msChart");if(!image){return true}context=canvas.getContext("2d");context.drawImage(image,0,0);image.style.opacity=0}function cgTooltipDiv(graphName){var ttElement,ttElementHTML;graphName=graphName+"msChart";ttElementHTML='<div id="'+graphName+'_ttSeriesNameDiv" class="ttSeriesNameDiv"></div><div id="'+graphName+'_ttValueDiv" class="ttValueDiv"><div id="'+graphName+'_ttUpperValDiv" class="ttUpperValDiv"></div><div id="'+graphName+'_ttLowerValDiv" class="ttLowerValDiv"></div></div><div id="'+graphName+'_ttDetailsDiv" class="ttDetailsDiv"></div><div id="'+graphName+'_ttDateTimeDiv" class="ttDateTimeDiv"></div><div id="'+graphName+'_ttMessageDiv" class="ttMessageDiv"></div>';ttElement=WP.DOM.Create.tag("div","tooltipDiv noprint",graphName+"_tooltipDiv","",ttElementHTML);return ttElement}var cgIsMouseIn=false;function setupImageMapAreas(graphName){var imgMap,areas,thisArea,coords,IsRect,IsCirc,top,left,width,height,i;imgMap=document.getElementById(graphName+"msChartImageMap");if(imgMap===null){return}areas=imgMap.getElementsByTagName("area");for(i=0;i<areas.length;i=i+1){thisArea=areas[i];thisArea.setAttribute("title","");thisArea.setAttribute("alt","");IsRect=(thisArea.shape.toLowerCase()==="rect");IsCirc=(thisArea.shape.toLowerCase()==="circle");if(IsRect||IsCirc){coords=thisArea.coords.split(",");left=coords[0];top=coords[1];if(IsRect){width=coords[2]-left;height=coords[3]-top}else{width=height=(coords[2]*2)}thisArea.setAttribute("l",left);thisArea.setAttribute("t",top);thisArea.setAttribute("w",width);thisArea.setAttribute("h",height)}}}function stt(graphName,elmntId){var ttDiv,elmnt,areaLeft,areaTop,areaWidth,message,ttMessage,seriesName,ttSeriesName,upperVal,ttUpperVal,upperUnits,lowerVal,ttLowerVal,lowerUnits,dateTime,ttDateTime,ttDivStyle,divWidth,divHeight,imgElmnt,ttLeft,ttTop,details,ttDetails;if(!cgIsMouseIn){cgIsMouseIn=true;document.body.style.cursor="default";ttDiv=document.getElementById(graphName+"_tooltipDiv");elmntId=graphName+"_"+elmntId;elmnt=document.getElementById(elmntId);if(ttDiv!==null&&elmnt!==null){areaLeft=elmnt.getAttribute("l")-0;areaTop=elmnt.getAttribute("t")-0;areaWidth=elmnt.getAttribute("w")-0;message=elmnt.getAttribute("tip");if(message!==null){ttMessage=document.getElementById(graphName+"_ttMessageDiv");if(ttMessage!==null){ttMessage.innerHTML=message;showElement(ttMessage)}}else{seriesName=elmnt.getAttribute("sn");ttSeriesName=document.getElementById(graphName+"_ttSeriesNameDiv");if(ttSeriesName!==null){if(seriesName!==null){ttSeriesName.innerHTML=seriesName;showElement(ttSeriesName)}else{hideElement(ttSeriesName)}}upperVal=elmnt.getAttribute("y0");if(upperVal!==null){ttUpperVal=document.getElementById(graphName+"_ttUpperValDiv");if(ttUpperVal!==null){ttUpperVal.innerHTML=upperVal;showElement(ttUpperVal);removeClassNames(ttUpperVal,"underline");upperUnits=elmnt.getAttribute("y0u");if(upperUnits!==null){ttUpperVal.innerHTML=ttUpperVal.innerHTML+" "+upperUnits}}}lowerVal=elmnt.getAttribute("y1");if(lowerVal!==null){ttLowerVal=document.getElementById(graphName+"_ttLowerValDiv");if(ttLowerVal!==null){ttLowerVal.innerHTML=lowerVal;showElement(ttLowerVal);lowerUnits=elmnt.getAttribute("y1u");if(lowerUnits!==null){ttLowerVal.innerHTML=ttLowerVal.innerHTML+" "+lowerUnits}if(ttUpperVal!==null){if(!containsClassName(ttUpperVal,"underline")){ttUpperVal.className=ttUpperVal.className+" underline"}}}}dateTime=elmnt.getAttribute("x");if(dateTime!==null){ttDateTime=document.getElementById(graphName+"_ttDateTimeDiv");if(ttDateTime!==null){ttDateTime.innerHTML=dateTime;showElement(ttDateTime)}}details=elmnt.getAttribute("dtl");if(details!==null){ttDetails=document.getElementById(graphName+"_ttDetailsDiv");if(ttDetails!==null){ttDetails.innerHTML=details;showElement(ttDetails)}}message=elmnt.getAttribute("msg");if(message!==null){ttMessage=document.getElementById(graphName+"_ttMessageDiv");if(ttMessage!==null){ttMessage.innerHTML=message;showElement(ttMessage)}}}ttDivStyle=ttDiv.style;ttDivStyle.left="-10000px";ttDivStyle.top="-10000px";ttDivStyle.display="block";divWidth=ttDiv.offsetWidth-0;divHeight=ttDiv.offsetHeight-0;imgElmnt=document.getElementById(graphName);ttLeft=areaLeft;ttTop=areaTop;if(ttLeft+divWidth>imgElmnt.width){ttLeft=(areaLeft-divWidth);if(!containsClassName(ttDiv,"leftside")){ttDiv.className=ttDiv.className+" leftside"}}else{removeClassNames(ttDiv,"leftside")}if(ttTop+divHeight+1>imgElmnt.height){ttTop-=(ttTop+divHeight-imgElmnt.height+1)}ttDivStyle.left=ttLeft+"px";ttDivStyle.top=ttTop+"px"}}}function htt(graphName,elmntId){var ttDiv;cgIsMouseIn=false;ttDiv=document.getElementById(graphName+"_tooltipDiv");if(ttDiv!==null){ttDiv.style.display="none";clearDiv(ttDiv)}}function clearDiv(elmnt){var indx,arr;arr=elmnt.getElementsByTagName("div");if(arr===null||arr.length===0){elmnt.innerHTML="";hideElement(elmnt)}else{for(indx=0;indx<arr.length;indx=indx+1){if(arr[indx]!==null){clearDiv(arr[indx])}}}};function getMonthName(m){var months=['January','February','March','April','May','June','July','August','September','October','November','December'];return months[m-1]}function getMonthAbbr(m){var months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sept','Oct','Nov','Dec'];return months[m-1]}function getDayName(d){var days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];return days[d]}function getDayAbbr(d){var days=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];return days[d]}function getDayLetter(d){var days=['S','M','T','W','T','F','S'];return days[d]}function getFirstDayOfWeek(){return 0}function getHour12(h){if(h%12===0){return 12}else{return h%12}}function getAMPM(h){var ampm=['AM','PM'];return(h<12)?ampm[0]:ampm[1]}function getAMPMAbbr(h){var ampm=['A','P'];return(h<12)?ampm[0]:ampm[1]}function makeInstant(year,month,day,hour,minute,second){var now=new Date();if(!year){year=now.getFullYear()}else{year=Number(year);if(year<30){year+=2000}}if(!month&&month!==0){month=now.getMonth()+1;if(!day){day=now.getDate()}}else{if(!day){day=1}}if(!hour&&hour!==0){hour=now.getHours()}if(!minute&&minute!==0){minute=now.getMinutes()}if(!second&&second!==0){second=now.getSeconds()}return new Date(year,Number(month)-1,day,hour,minute,second)}function makeDate(year,month,day){return makeInstant(year,month,day,0,0,0)}function makeTime(hour,minute,second){return makeInstant(null,null,null,hour,minute,second)}function buildFormat(dateFormat){dateFormat=dateFormat.replace(/(\\.|(.)\2*)/g,"$1\n");var datePieces=dateFormat.split(/\n/);var formatter;for(var i=0;i<datePieces.length;i++){if(datePieces[i].match(/^y+$/)){switch(datePieces[i].length){case 2:datePieces[i]=function(date){return((date.getFullYear()%100).toString())};break;case 4:datePieces[i]=function(date){return(date.getFullYear().toString())};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^M+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return((date.getMonth()+1).toString())};break;case 2:datePieces[i]=function(date){return(padNumber(date.getMonth()+1,2))};break;case 3:datePieces[i]=function(date){return(getMonthAbbr(date.getMonth()+1))};break;case 4:datePieces[i]=function(date){return(getMonthName(date.getMonth()+1))};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^d+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return(date.getDate().toString())};break;case 2:datePieces[i]=function(date){return(padNumber(date.getDate(),2))};break;case 3:datePieces[i]=function(date){return(getDayAbbr(date.getDay()))};break;case 4:datePieces[i]=function(date){return(getDayName(date.getDay()))};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^h+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return(getHour12(date.getHours()).toString())};break;case 2:datePieces[i]=function(date){return(padNumber(getHour12(date.getHours()),2))};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^H+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return(date.getHours().toString())};break;case 2:datePieces[i]=function(date){return(padNumber2(date.getHours(),2))};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^m+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return(date.getMinutes().toString())};break;case 2:datePieces[i]=function(date){return(padNumber2(date.getMinutes(),2))};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^s+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return(date.getSeconds().toString())};break;case 2:datePieces[i]=function(date){return(padNumber2(date.getSeconds(),2))};break;default:datePieces[i]=function(date){return""}}}else{if(datePieces[i].match(/^t+$/)){switch(datePieces[i].length){case 1:datePieces[i]=function(date){return(getAMPMAbbr(date.getHours()))};break;case 2:datePieces[i]=function(date){return(getAMPM(date.getHours()))};break;default:datePieces[i]=function(date){return""}}}else{datePieces[i]=datePieces[i].replace(/(\\)(?!\\)/,"")}}}}}}}}}return function(date){var ret="",i;if(!date){return"\\"}else{for(i=0;i<datePieces.length;i++){if(typeof datePieces[i]==="function"){ret+=datePieces[i](date)}else{ret+=datePieces[i]}}return ret}}}var formatDate=buildFormat("M/d/yyyy");var formatTime=buildFormat("h:mm tt");var parseDate=buildDateParser("M/d/yyyy");var formatHour=buildFormat("h:mm tt".replace(/[^hH]/g,""));var formatMinute=buildFormat("h:mm tt".replace(/[^m]/g,""));function dateInputError(str,dateString,min,max){var mnemonics={};mnemonics["@MYCHART@DATEFORMAT@"]="mm/dd/yyyy";mnemonics["@MYCHART@ENTEREDDATE@"]=dateString;if(min){mnemonics["@MYCHART@MINDATE@"]=formatDate(min)}if(max){mnemonics["@MYCHART@MAXDATE@"]=formatDate(max)}WP.Validators.DisplayErrors(decodeMnemonics(str,mnemonics))}function formatDateField(field,validType,min,max){if(!field||!field.value){field=WP.Events.getThis()}if(!field||!field.value){return}if(field.holdErrors===true){window.setTimeout(function(){formatDateField(field,validType,min,max)},100);return}else{if(field.openingCalendar===true){field.openingCalendar=false;return}}var isValid=true;if(field.value.match(/^\s*$/)){return true}var date=parseDate(field.value);var dateString;var today=new Date();today.setHours(0);today.setMinutes(0);today.setSeconds(0);today.setMilliseconds(0);if(!date){return}else{dateString=formatDate(date)}switch(validType){case 1:if(date>=today){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe date must be in the past.",dateString);isValid=false}break;case 2:if(date<=today){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe date must be in the future.",dateString);isValid=false}break;case 3:if(date<today){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe date must be today or in the future.",dateString);isValid=false}break;case 4:if(date>today){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe date must be today or in the past.",dateString);isValid=false}break;case 5:if(date<min||date>max){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe date must be between @MYCHART@MINDATE@ and @MYCHART@MAXDATE@.",dateString,min,max);isValid=false}break;default:isValid=false}if(isValid===true){field.value=dateString}return true}function buildDateParser(dateFormat){var regex;dateFormat=dateFormat.replace(/[^yMd]*([yMd])+[^yMd]*/g,"$1");switch(dateFormat.indexOf("y")){case 0:regex=/^\s*(?:(?:((?:\d{2})?\d{2})\D)?(\d{1,2})\D(\d{1,2})|(?:((?:\d{2})?\d{2}))?(\d{2})(\d{2}))\s*$/;break;case 1:regex=/^\s*(?:(\d{1,2})\D(?:((?:\d{2})?\d{2})\D)?(\d{1,2})|(\d{2})(?:((?:\d{2})?\d{2}))?(\d{2}))\s*$/;break;case 2:regex=/^\s*(?:(\d{1,2})\D(\d{1,2})(?:\D((?:\d{2})?\d{2}))?|(\d{2})(\d{2})(?:((?:\d{2})?\d{2}))?)\s*$/;break}return function(regex,dateFormat){return function(dateString,suppressErrors){var parsed,year,month,day;if(dateString.length<6){if(suppressErrors!==true){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nPlease reenter the date in @MYCHART@DATEFORMAT@ format.",dateString)}return}var matches=dateString.match(regex);if(!matches){if(suppressErrors!==true){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nPlease reenter the date in @MYCHART@DATEFORMAT@ format.",dateString)}return}if(matches[1]!==null&&matches[1]!==""){year=matches[(dateFormat.indexOf("y")+1)];month=matches[(dateFormat.indexOf("M")+1)];day=matches[(dateFormat.indexOf("d")+1)]}else{year=matches[(dateFormat.indexOf("y")+4)];month=matches[(dateFormat.indexOf("M")+4)];day=matches[(dateFormat.indexOf("d")+4)]}parsed=makeDate(year,month,day);month=parseInt(month,10);day=parseInt(day,10);if(month<1||month>12){if(suppressErrors!==true){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe month must be between 1 and 12.",dateString)}}else{if(parsed.getDate()!==day){if(suppressErrors!==true){dateInputError("@MYCHART@ENTEREDDATE@ is not valid.\nThe day is not valid for this month.",dateString)}}else{return parsed}}}}(regex,dateFormat)};function findBackground(element,index,array){var tmp,att,val;element=element.trim();if(element===""||array.backgroundColor){return}tmp=element.split(":");att=tmp[0].trim(),val=tmp[1].trim();if(att!=="background-color"){return}array.backgroundColor=val}function fixBorders(element,index,array){var bgColor,tmp,att,val;element=element.trim();if(element===""){return}tmp=element.split(":");att=tmp[0].trim(),val=tmp[1].trim();bgColor=array.backgroundColor;if(new RegExp("border").test(att)){if(new RegExp(bgColor+"|transparent").test(val)){array[index]=""}}}var initReportStyles=function(styleChunk){var styleSheet=WP.DOM.Add.addStyleSheet(),re,match,selectors,props,propsArray,moreSpecificSelector;re=/([\s\S]*?)\{([\s\S]*?)\}/g;while(match=re.exec(styleChunk)){var selectors=match[1],props=match[2];propsArray=props.split(";");propsArray.forEach(findBackground);if(propsArray.backgroundColor){propsArray.forEach(fixBorders);propsArray.backgroundColor=""}props=propsArray.join(";");if(/\.rz_\w+/.test(selectors.trim())){var moreSpecificSelector=".section .report "+selectors;WP.DOM.Add.addCSSRule(styleSheet,moreSpecificSelector+" { "+props+" }")}}};if(typeof WP==="undefined"){WP={}}if(typeof WP.Comm==="undefined"){WP.Comm={}}WP.Comm.RESPONSETYPE_COMPLETE=0;WP.Comm.RESPONSETYPE_CONTENTONLY=1;WP.Comm.AJAXHandler=function(){this.RESPONSETYPE_COMPLETE=WP.Comm.RESPONSETYPE_COMPLETE;this.RESPONSETYPE_CONTENTONLY=WP.Comm.RESPONSETYPE_CONTENTONLY;this.AH_reqObj=null;this.AH_URL=null;this.AH_extHandler=null;this.AH_postMethod=null;this.AH_reqParams=null;this.AH_respType=null;this.init=function(url,externalHandler,postMethod,reqParams,respType,avoidRedirect){respType=respType||WP.Comm.RESPONSETYPE_CONTENTONLY;reqParams=reqParams||"1";postMethod=postMethod||"GET";externalHandler=externalHandler||function(){};if(!url){return false}postMethod=postMethod.toUpperCase();if(this.AH_reqObj=this.createXMLHttpRequest()){this.AH_URL=url;this.AH_extHandler=externalHandler;this.AH_postMethod=postMethod;this.AH_reqParams=reqParams;this.AH_respType=respType;var ro=this.AH_reqObj;if(ro.readyState===4||ro.readyState===0){if(this.AH_postMethod==="GET"&&this.AH_reqParams.length>0){if(this.AH_URL.indexOf("?")>0){this.AH_URL=this.AH_URL+"&"+this.AH_reqParams}else{this.AH_URL=this.AH_URL+"?"+this.AH_reqParams}}ro.open(this.AH_postMethod,this.AH_URL,true);switch(this.AH_respType){case WP.Comm.RESPONSETYPE_CONTENTONLY:ro.onreadystatechange=function(){if(ro.readyState===4){try{if(avoidRedirect!==true&&ro.responseText.indexOf('http-equiv="refresh"')>0){window.location.href=url;return}}catch(err){return false}var markStart="<!-- Begin Site Wrapper -->",markEnd="<!-- End Site Wrapper -->",regex=new RegExp(markStart+"[\\s\\S]*"+markEnd),cleanResponse;try{cleanResponse=ro.responseText.match(regex)}catch(err2){return false}if(cleanResponse){cleanResponse=cleanResponse[0];cleanResponse=cleanResponse.substring(markStart.length,cleanResponse.length-markEnd.length);externalHandler(cleanResponse)}else{externalHandler(ro.responseText)}}};break;default:ro.onreadystatechange=function(){if(ro.readyState===4){externalHandler(ro.responseText)}};break}if(this.AH_postMethod==="POST"&&this.AH_reqParams.length>0){ro.setRequestHeader("Content-type","application/x-www-form-urlencoded");ro.setRequestHeader("Content-Length",this.AH_reqParams.length);try{ro.send(this.AH_reqParams)}catch(err){}}else{try{ro.send(null)}catch(err2){}}}}else{return false}};this.createXMLHttpRequest=function(){var xmlhttp;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){xmlhttp=false}}}return xmlhttp}};var AJAXHandler=WP.Comm.AJAXHandler;WP.Comm.ajaxRequest=function(url,externalHandler,postMethod,reqParams,respType){var hndlr=new WP.Comm.AJAXHandler();hndlr.init(url,externalHandler,postMethod,reqParams,respType)};WP.Comm.logOut=function(afterExecute){var hndlr=new AJAXHandler();hndlr.init("bye.asp",afterExecute,null,null,null,true)};WP.CH5=String.fromCharCode(5);WP.Comm.startDigiD=function(button,errorContainer){clearElement(errorContainer);var comm=new WP.Comm.AJAXHandler();comm.init("digidprelogin.asp?startlogin=1",function(response){var CH5=WP.CH5;var lSplit=response.indexOf(CH5),sURL=response.substr(0,lSplit),sError;if(sURL.length>0){window.location=sURL;return}if(button){button.disabled=false}sError=response.substr(lSplit+1,response.indexOf(CH5,lSplit+1)-1);errorContainer.innerHTML="";createAlert(sError||"The MyChart webserver could not be reached",true,errorContainer)},"GET","1",999);if(button){button.disabled=true}errorContainer.className="";errorContainer.innerHTML="";errorContainer.appendChild(createElement("h3"));$T(errorContainer.firstChild,"Please wait while we contact DigiD");errorContainer.firstChild.className="alert"};if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(typeof Array.prototype.forEach!=="function"){Array.prototype.forEach=function(fcn){var i;for(i=0;i<this.length;i++){fcn(this[i],i,this)}}}if(typeof WP==="undefined"){WP={}}if(typeof WP.Utils==="undefined"){WP.Utils={}}WP.Utils.iterateFind=function(nextFun,testFun,startElem){var elem=startElem;while(testFun(elem)!==true){elem=nextFun(elem)}return elem};WP.Utils.iterateFindNext=function(nextFun,testFun,startElem){return WP.Utils.iterateFind(nextFun,testFun,nextFun(startElem))};WP.Utils.bind=function(fn,thisArg){if(fn.bind){return fn.bind(thisArg)}else{return function(){return fn.apply(thisArg,arguments)}}};WP.Utils.parseXml=function(s){if(window.DOMParser){return(new DOMParser()).parseFromString(s,"text/xml")}else{var doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s);return doc}};WP.Utils.map=function(fn,origElems){var newElems=[];for(var i=0;i<origElems.length;i++){newElems.push(fn(origElems[i]))}return newElems};WP.Utils.foreach=function(elems,fn){for(var i=0;i<elems.length;i++){fn(elems[i])}};WP.Utils.sortFromKey=function(kfn){return function(a,b){return kfn(a)-kfn(b)}};WP.Utils.dte2date=function(dte){var d2=new Date();d2.setUTCFullYear(1970,0,1);d2.setUTCHours(0,0,0,0);var d1=new Date(d2.valueOf()+(dte-47117)*24*3600*1000);var date=new Date();date.setFullYear(d1.getUTCFullYear(),d1.getUTCMonth(),d1.getUTCDate());date.setHours(0,0,0,0);return date};WP.Utils.date2dte=function(date){var d1=new Date();var d2=new Date();d1.setUTCFullYear(date.getFullYear(),date.getMonth(),date.getDate());d1.setUTCHours(0,0,0,0);d2.setUTCFullYear(1970,0,1);d2.setUTCHours(0,0,0,0);return(d1-d2)/(24*3600*1000)+47117};WP.Utils.Xml2js=function(){this.rename={};this.attr_rename={};this.array_tags={};this.kv_tags={};this.recurse=true;this.attrs=true;this.attrs_key="_attr";this.attrs_nochild=false;var hasChildElement=function(node){var nodeChilds=node.childNodes;for(var i=0;i<nodeChilds.length;i++){if(nodeChilds[i].nodeType==document.ELEMENT_NODE){return true}}return false};var getTextNode=function(node){var nodeChilds=node.childNodes;for(var i=0;i<nodeChilds.length;i++){if(nodeChilds[i].nodeType==document.TEXT_NODE){return nodeChilds[i]}}return null};var attr_kv=function(elem){var kv={};for(var i=0;i<elem.attributes.length;i++){var attr=elem.attributes[i];kv[attr.name]=attr.value}return kv};this.convert=function(a){var ja={};var aChilds=a.childNodes;for(var i=0;i<aChilds.length;i++){var b=aChilds[i];if(b.nodeType!=document.ELEMENT_NODE){continue}var jb;if(!hasChildElement(b)){b.normalize();jb=getTextNode(b).nodeValue}else{if(this.recurse){jb=this.convert(b)}else{return}}var key=b.tagName;if(key in this.rename){key=this.rename[key]}if(b.tagName in this.array_tags){if(!(key in ja)){ja[key]=[]}ja[key].push(jb)}else{if(b.tagName in this.kv_tags){if(!(key in ja)){ja[key]={}}var key_fn=this.kv_tags[b.tagName];ja[key][key_fn(b)]=jb}else{ja[key]=jb}}}if(this.attrs){ja[this.attrs_key]=attr_kv(a)}return ja}};WP.Utils.base16dec=function(s){var tarr=[];for(var i=0;i<s.length;i+=2){tarr.push(16*parseInt(s.substring(i,i+1),16)+parseInt(s.substring(i+1,i+2),16))}return WP.Utils.map(String.fromCharCode,tarr).join("")};WP.Utils.base16enc=function(t){var sarr=[];for(var i=0;i<t.length;i++){sarr.push(t.charCodeAt(i).toString(16))}return sarr.join("")};WP.Utils.flashPopup=function(url){var flashPopup;flashPopup=window.open("","history","toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=0,resizable=0,width=800,height=600");if(flashPopup.closed||(!flashPopup.document.URL)||(flashPopup.document.URL.indexOf("about")==0)){flashPopup.location=url}else{flashPopup.focus()}};if(!("ELEMENT_NODE"in document)){document.ELEMENT_NODE=1;document.ATTRIBUTE_NODE=2;document.TEXT_NODE=3;document.CDATA_SECTION_NODE=4;document.ENTITY_REFERENCE_NODE=5;document.ENTITY_NODE=6;document.PROCESSING_INSTRUCTION_NODE=7;document.COMMENT_NODE=8;document.DOCUMENT_NODE=9;document.DOCUMENT_TYPE_NODE=10;document.DOCUMENT_FRAGMENT_NODE=11;document.NOTATION_NODE=12}if(typeof WP==="undefined"){WP={}}if(typeof WP.DOM==="undefined"){WP.DOM={}}if(typeof WP.DOM.Add==="undefined"){WP.DOM.Add={}}if(typeof WP.DOM.Search==="undefined"){WP.DOM.Search={}}if(typeof WP.DOM.Browser==="undefined"){WP.DOM.Browser={}}WP.DOM.Browser._getIEVersion=function(){var regEx,vers=-1;if(navigator.appName=="Microsoft Internet Explorer"){regEx=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(regEx.exec(navigator.userAgent)!=null){vers=parseFloat(RegExp.$1)}}return vers};WP.DOM.Browser._getIEDocumentMode=function(){if(WP.DOM.Browser.IEVersion===-1){return-1}if(typeof arguments.caller!=="object"){return 9}return 8};WP.DOM.Browser.isSafari=navigator.userAgent.toLowerCase().match(/safari/)!=null;WP.DOM.Browser.isOmniweb=navigator.userAgent.toLowerCase().match(/omniweb/)!=null;WP.DOM.Browser.isOpera=navigator.userAgent.toLowerCase().match(/opera/)!=null;WP.DOM.Browser.userAgent=navigator.userAgent;WP.DOM.Browser.isIE=navigator.appVersion.match(/MSIE/)!=null;WP.DOM.Browser.IEVersion=WP.DOM.Browser._getIEVersion();WP.DOM.Browser.IEDocMode=WP.DOM.Browser._getIEDocumentMode();WP.DOM.Browser.isNewIE=WP.DOM.Browser.isIE&&WP.DOM.Browser.IEVersion>=8;WP.DOM.Browser.isOldIE=WP.DOM.Browser.isIE&&!WP.DOM.Browser.isNewIE;WP.DOM.Browser.isFirefox=WP.DOM.Browser.userAgent.match(/firefox/i)!=null;WP.DOM.Browser.isOldFirefox=WP.DOM.Browser.isFirefox&&((WP.DOM.Browser.userAgent.match(/firefox\/2./i)!=null)||(WP.DOM.Browser.userAgent.match(/firefox\/1./i)!=null));WP.DOM.Browser.isNewFirefox=WP.DOM.Browser.isFirefox&&!WP.DOM.Browser.isOldFirefox;WP.DOM.Browser.isWebKit=navigator.appVersion.match(/WebKit/)!=null;WP.DOM.Browser.isChrome=navigator.appVersion.match(/Chrome/)!=null;if(typeof WP.DOM.Create==="undefined"){WP.DOM.Create={}}WP.DOM.Create.tag=function(tagType,className,ID,title,innerHTML){var tag=document.createElement(tagType||"div");if(!tag){return null}if(className){tag.className=className}if(ID){tag.id=ID}if(title){tag.title=title}if(innerHTML){tag.innerHTML=innerHTML}return tag};WP.DOM.Create.anchoredNode=function(content,isHTML,title){var tag=document.createElement("a");tag.href="#";isHTML=(isHTML||false);if(isHTML){tag.innerHTML=content}else{tag.appendChild(document.createTextNode(HTMLUnencode(content)))}if(title){tag.title=title}WP.Events.addListener(tag,"click",function(){return false});return tag};if(typeof WP.DOM.Read==="undefined"){WP.DOM.Read={}}WP.DOM.Read.getStyle=function(el,styleName){var nmAry=styleName.split("-"),jsName=nmAry[0],i,style;if(typeof el==="string"){el=document.getElementById(el)}if(!el||el.nodeName==="#text"||el.nodeName==="#comment"){return}for(i=1;i<nmAry.length;i++){jsName+=nmAry[i].charAt(0).toUpperCase()+nmAry[i].slice(1)}if(el.currentStyle){style=el.currentStyle[jsName]}else{if(window.getComputedStyle){try{style=document.defaultView.getComputedStyle(el,null).getPropertyValue(styleName)}catch(ex){style=""}}}return style};WP.DOM.Read.getBorderWidth=function(el){var borders={};borders.left=parseInt(WP.DOM.Read.getStyle(el,"border-left-width"),10);borders.top=parseInt(WP.DOM.Read.getStyle(el,"border-top-width"),10);borders.right=parseInt(WP.DOM.Read.getStyle(el,"border-right-width"),10);borders.bottom=parseInt(WP.DOM.Read.getStyle(el,"border-bottom-width"),10);return borders};WP.DOM.Read.getAbsolutePosition=function(el){if(typeof el==="string"){el=document.getElementById(el)}if(!el){return}var pos={x:0,y:0},viewportElement,box,scrollLeft,scrollTop,parentNode,offsetParent,borderWidth,parentTagName;if(el!==null){if(el.getBoundingClientRect){viewportElement=document.documentElement;box=el.getBoundingClientRect();scrollLeft=window.pageXOffset;scrollTop=window.pageYOffset;if(!scrollLeft){scrollLeft=viewportElement.scrollLeft}if(!scrollTop){scrollTop=viewportElement.scrollTop}pos.x=box.left+scrollLeft;pos.y=box.top+scrollTop}else{pos.x=el.offsetLeft;pos.y=el.offsetTop;parentNode=el.parentNode;offsetParent=el.offsetParent;borderWidth=null;while(offsetParent!=null){pos.x+=offsetParent.offsetLeft;pos.y+=offsetParent.offsetTop;parentTagName=offsetParent.tagName.toLowerCase();if((WP.DOM.Browser.isOldIE&&parentTagName!="table")||((WP.DOM.Browser.isNewFirefox||WP.DOM.Browser.isChrome)&&parentTagName=="td")){borderWidth=WP.DOM.Browser.getBorderWidth(offsetParent);pos.x+=borderWidth.left;pos.y+=borderWidth.top}if(offsetParent!=document.body&&offsetParent!=document.documentElement){pos.x-=offsetParent.scrollLeft;pos.y-=offsetParent.scrollTop}if(!WP.DOM.Browser.isIE||WP.DOM.Browser.isNewIE){while(offsetParent!=parentNode&&parentNode!==null){pos.x-=parentNode.scrollLeft;pos.y-=parentNode.scrollTop;if(WP.DOM.Browser.isOldFirefox||WP.DOM.Browser.isWebKit){borderWidth=WP.DOM.Browser.getBorderWidth(parentNode);pos.x+=borderWidth.left;pos.y+=borderWidth.top}parentNode=parentNode.parentNode}}parentNode=offsetParent.parentNode;offsetParent=offsetParent.offsetParent}}}pos.x=parseInt(pos.x,10);pos.y=parseInt(pos.y,10);return pos};if(typeof WP.DOM.Search==="undefined"){WP.DOM.Search={}}WP.DOM.Search.getPrevious=function(node){var ret;if(!node){return null}if(node.previousSibling){ret=node.previousSibling;while(ret.lastChild){ret=ret.lastChild}return ret}return node.parentNode};WP.DOM.Search.getNext=function(node){if(node&&node.firstChild){return node.firstChild}var n=node;while(n!==null){if(n.nextSibling){return n.nextSibling}n=n.parentNode}return n};WP.DOM.Search.getPreviousFiltered=function(allowedNodeTypes,node){if(typeof allowedNodeTypes==="undefined"){allowedNodeTypes={};allowedNodeTypes[document.ELEMENT_NODE]=1;allowedNodeTypes[document.ATTRIBUTE_NODE]=1}return WP.Utils.iterateFindNext(WP.DOM.Search.getPrevious,function(node){return node&&allowedNodeTypes[node.nodeType]},node)};WP.DOM.Search.getNextFiltered=function(allowedNodeTypes,node){if(typeof allowedNodeTypes==="undefined"){allowedNodeTypes={};allowedNodeTypes[document.ELEMENT_NODE]=1;allowedNodeTypes[document.ATTRIBUTE_NODE]=1}return WP.Utils.iterateFindNext(WP.DOM.Search.getNext,function(node){return node&&allowedNodeTypes[node.nodeType]},node)};WP.DOM.Search.getFocused=function(defaultElement,isIframe){var x,doc=(isIframe===true)?parent.document:document;try{x=(doc.querySelector&&doc.querySelector(":focus"))||doc.activeElement||defaultElement;return x}catch(ex){return defaultElement}};if(typeof WP.DOM.Test==="undefined"){WP.DOM.Test={}}WP.DOM.Test.beingRendered=function(elem){if(elem.nodeType===document.DOCUMENT_NODE){return true}else{return(WP.DOM.Read.getStyle(elem,"display")!="none"&&(/colgroup|col|thead|tbody|tfoot|tr|td|th/.test(elem.tagName)?WP.DOM.Read.getStyle(elem,"visibility")=="collapse":true)&&WP.DOM.Test.beingRendered(elem.parentNode))}};WP.DOM.Test.canFocus=function(elem){if(!WP.DOM.Test.beingRendered(elem)||elem.nodeName==="#text"||elem.nodeName==="#comment"){return false}var attrNode=elem.attributes.getNamedItem("tabindex");if(attrNode!==null&&/\s+[+-]\d+/.test(attrNode.nodeValue)){return true}else{if(/^button|input|object|select|textarea$/i.test(elem.nodeName)||/^a|area$/i.test(elem.nodeName)&&elem.href){return!elem.disabled&&!elem.readOnly}return false}};WP.DOM.Test.canFocusViaNavigation=function(elem){return WP.DOM.Test.canFocus(elem)&&(elem.tabIndex||0)>=0};WP.DOM.Search.getPreviousFocusable=function(elem){return WP.Utils.iterateFindNext(WP.DOM.Search.getPrevious,function(node){if(node===null){return true}else{if(node.nodeType!==document.ELEMENT_NODE){return false}else{return WP.DOM.Test.canFocusViaNavigation(node)}}},elem)};WP.DOM.Search.getNextFocusable=function(elem){return WP.Utils.iterateFindNext(WP.DOM.Search.getNext,function(node){if(node===null){return true}else{if(node.nodeType!==document.ELEMENT_NODE){return false}else{return WP.DOM.Test.canFocusViaNavigation(node)}}},elem)};WP.DOM.Add.addCSSRules=function(sheet,rules){if("insertRule"in sheet){var re=/([\s\S]*?)\{([\s\S]*?)\}/g;while(match=re.exec(rules)){sheet.insertRule(match[0],sheet.cssRules.length)}}else{if("cssText"in sheet){sheet.cssText+=rules}else{}}};WP.DOM.Search.findStyleSheet=function(suffix){var sheets=document.styleSheets;for(var i=0;i<sheets.length;i++){if(sheets[i].href.lastIndexOf(suffix)==sheets[i].href.length-suffix.length){return sheets[i]}}return null};WP.DOM.Add.addStyleSheet=function(){var head=document.getElementsByTagName("head")[0],style=document.createElement("style"),chk,i;head.appendChild(style);for(var i=0;i<document.styleSheets.length;i++){chk=document.styleSheets[i].ownerNode||document.styleSheets[i].owningElement;if(chk==style){return document.styleSheets[i]}}};WP.DOM.Add.addCSSRule=function(sheet,rule){if("insertRule"in sheet){sheet.insertRule(rule,sheet.cssRules.length)}else{if("cssText"in sheet){sheet.cssText+=rule}else{}}};if(typeof(WP)==="undefined"){var WP={}}if(typeof(WP.Controls)==="undefined"){WP.Controls={}}if(typeof(WP.Controls.ProgressSpinner)==="undefined"){WP.Controls.ProgressSpinner=function(Container,Label,display,size){Label=Label||"Please wait...";display=display||"block";size=(size||64);var progHolder=createElement("div","progbar","progbar"),progImg=createImage("","","spinner64.gif",Label),progText=createElement("div","progbar","progbartext"),oldDisplay;this.isHidden=false;progImg.style.display=display;progImg.height=size;progImg.width=size;progText.style.display=display;$T(progText,Label);progHolder.appendChild(progImg);progHolder.appendChild(progText);Container.appendChild(progHolder);if(Container.className==="hidden"){Container.className=""}this.remove=function(){Container.removeChild(progHolder)};this.updateLabel=function(newLabel){$T(progText,newLabel)};this.hide=function(){if(this.isHidden===true){return true}oldDisplay=progHolder.style.display;progHolder.style.display="none";this.isHidden=true};this.show=function(){this.isHidden=false;progHolder.style.display=oldDisplay};SetActivity();oldDisplay=progHolder.style.display;return this}}if(typeof WP.Controls.InfoButton==="undefined"){WP.Controls.InfoButton=function(container,instructions,divID,header,title,onmouseover,onmouseout,onclick,spanText){var theDiv,a,img,popupDiv,span,children,notitle,spanSel,child;divID=(divID||"popupparentdiv");if(!(header||header==="")){header="Instructions:"}if(WP.DOM.Browser.isFirefox){notitle=" "}else{notitle=""}if(!title){title=notitle}theDiv=createElement("div","popupiconcontainer",divID);a=createElement("a","popupinstructionsicon");a.href="#";if(spanText){spanSel=createElement("span",divID+"icon",divID+"icon");spanSel.innerHTML=spanText;spanSel.title=notitle;a.appendChild(spanSel)}else{img=createImage("popupinstructionsicon",divID+"icon","info.png","See Instructions - Screen readers: use \"read next line\" to hear instructions");img.title=notitle;a.appendChild(img)}theDiv.appendChild(a);popupDiv=createElement("div","popupInstructions",divID+"_popupInstructions");popupDiv.title=title;if(header!==""){span=createElement("span");$T(span,header);span.className="header";popupDiv.appendChild(span)}instructions=unescape(instructions);popupDiv.innerHTML+=instructions;theDiv.appendChild(popupDiv);if(container){container.appendChild(theDiv)}onmouseover=onmouseover||(function(divID){return function(){var main=document.getElementById("main")||document.body,icon=document.getElementById(divID+"icon"),popupInst=document.getElementById(divID+"_popupInstructions"),mainPos=WP.DOM.Read.getAbsolutePosition(main),iconPos=WP.DOM.Read.getAbsolutePosition(icon),diffTop,diffLeft;if(main.clientHeight<400){main.style.minHeight="400px"}diffTop=(mainPos.y+main.offsetHeight)-(iconPos.y+icon.offsetHeight)-popupInst.offsetHeight;diffLeft=(mainPos.x+main.offsetWidth)-(iconPos.x+icon.offsetWidth)-popupInst.offsetWidth;if(diffTop<0){popupInst.style.top=diffTop+"px"}else{popupInst.style.top=icon.offsetHeight-5+"px"}if(diffLeft<0){popupInst.style.left=diffLeft+"px"}else{popupInst.style.left=icon.offsetWidth-5+"px"}popupInst.style.zIndex="2001"}}(divID));WP.Events.addListener(theDiv,"mouseover",onmouseover);WP.Events.addListener(a,"focus",onmouseover);onmouseout=onmouseout||(function(divID){return function(){var div=document.getElementById(divID+"_popupInstructions");div.style.zIndex="-1";div.style.top="-9000px";div.style.left="-9000px"}}(divID));WP.Events.addListener(theDiv,"mouseout",onmouseout);WP.Events.addListener(a,"blur",onmouseout);children=document.getElementById(divID+"_popupInstructions").getElementsByTagName("*");for(var i=0;i<children.length;i++){child=children[i];if(child.nodeName.toUpperCase()==="A"){WP.Events.addListener(child,"focus",onmouseover);WP.Events.addListener(child,"blur",onmouseout)}}onclick=onclick||function(e){WP.Events.cancelEvent(e);WP.Events.preventDefault(e)};WP.Events.addListener(a,"click",onclick);WP.Events.addListener(popupDiv,"mouseover",function(){return false});WP.Events.addListener(popupDiv,"focus",function(){return false});return theDiv}}if(typeof(WP.Controls.Recaptcha)==="undefined"){WP.Controls.Recaptcha={};WP.Controls.Recaptcha.showReCAPTCHA=function(elementId,language,publicKey){var settings={};settings.lang=language;settings.callback=settings.x;settings.tabindex=settings.x;Recaptcha.create(publicKey,elementId,settings)};WP.Controls.Recaptcha.doCheck=function(){var captcha=document.getElementById("recaptcha_response_field"),pwdQ=document.getElementById("newquestion"),pwdA=document.getElementById("questionanswer"),retVal=true,error;if(captcha){error=" ";if(!captcha.value){error="You must respond to the CAPTCHA above to finish logging in.";retVal=false}$T(document.getElementById("captchaalert"),error)}if(pwdA){error=" ";if(!pwdA.value){error="The answer to your security question is required.";retVal=false}$T(document.getElementById("questionansweralert"),error)}if(pwdQ){error=" ";if(pwdQ.tagName==="SELECT"){if(pwdQ.value==="0"){error="The security question is required.";retVal=false}}else{if(!pwdQ.value){error="The security question is required.";retVal=false}}$T(document.getElementById("questionalert"),error);if(retVal&&pwdA.value&&pwdQ.value.indexOf(pwdA.value)!==-1){$T(document.getElementById("questionansweralert"),"The answer to your security question cannot be contained within the question itself.");retVal=false}}return retVal}};if(typeof(WP)==="undefined"){var WP={}}if(typeof(WP.Controls)==="undefined"){WP.Controls={}}if(typeof(WP.Controls.ImageViewer)==="undefined"){WP.Controls.ImageViewer=function(ID,Container,SerializedData,AllowEdit,maxDescLength,formName,afterValidate,maxImages,iframe,mode){var that=this,iframeButton,imgAlert,canFocus,getPrevious,focusController;AllowEdit=AllowEdit&&(window.location.href.indexOf("printmode=true")===-1);this.imgsContainer=createElement("div","imagescontainer");this.ID=ID;if(AllowEdit!==true&&AllowEdit!==false){AllowEdit=true}this.visibleLabel=$("iframelabel");this.AllowEdit=AllowEdit;this.ImageList=[];this.iframe=$("iframe"+ID);this.maxDescLength=maxDescLength||200;this.formName=formName||"";this.afterValidate=afterValidate||null;this.maxImages=maxImages||5;Container.appendChild(this.imgsContainer);this.isPrintMode=(window.location.href.indexOf("printmode")>-1);if(this.isPrintMode){this.imgsContainer.style.width="99%"}this.alertDiv=$("imgalert");this.setActivity=SetActivity;this.setActivity();this.mode=parseInt(mode||3,10);if(iframe){iframe.mode=3;iframeButton=iframe.previousSibling;imgAlert=iframe.parentNode.parentNode.lastChild;this.browse=iframe;iframe.writeError=function(err){if(iframe.timedOut===true){iframe.timedOut=false}else{if(iframe.dontOverwriteError!==true){imgAlert.innerHTML=err}}iframe.uploading=false;spin.hide();iframeButton.style.display="";that.setActivity()};iframe.timeOutChecks=0;iframe.showSpinner=function(){iframe.writeError("");spin.show();iframeButton.style.display="none";that.setActivity();iframe.uploading=true;window.setTimeout(iframe.GetTimeOutFun(++iframe.timeOutChecks),60*1000)};iframe.GetTimeOutFun=function(checkNum){return function(){if(checkNum!==iframe.timeOutChecks){return}if(iframe.uploading!==true){return}iframe.src=iframe.src;iframe.writeError("<span class=\"clearlabel\">Error: </span>The system timed out waiting for your attachment to upload.  Please try again.");iframe.timedOut=true}};iframe.showFocus=function(hasFocus){var fun=hasFocus?applyClass:removeClassNames;fun(iframeButton,"prettyfileinputhasfocus")};iframe.setHover=function(isHovering){var fun=isHovering?applyClass:removeClassNames;fun(iframeButton,"hover")};iframe.setDisabled=function(isDisabled){var f,fun=isDisabled?applyClass:removeClassNames;fun(iframeButton,"disabled");iframe.disabled=isDisabled;if(iframe.setDisabledInner){iframe.setDisabledInner(isDisabled)}else{if(isDisabled===true){iframe.dontOverwriteError=true;f=function(){if(!iframe.setDisabledInner){window.setTimeout(f,1);return}iframe.setDisabledInner(isDisabled);iframe.dontOverwriteError=false};f()}}};iframe.style.width=(iframeButton.offsetWidth+10)+"px";iframe.style.height=(iframeButton.offsetHeight+10)+"px";canFocus=WP.DOM.Test.canFocus;getPrevious=WP.DOM.Search.getPrevious;iframe.previousElement=getPrevious($(this.ID));while(!canFocus(iframe.previousElement)){iframe.previousElement=getPrevious(iframe.previousElement)}iframe.nextElement=getChild(getChild($("iframeinfodiv"),0),0);focusController=function(focusWhenDisabled,shiftValue){var disabledFun=function(){focusWhenDisabled.focus()};return function(event){var fun,keyCode,evt=event||window.event;keyCode=evt.keyCode||evt.which;if(keyCode===9&&evt.shiftKey===shiftValue){fun=(iframe.disabled===false)?iframe.focusInner:disabledFun;WP.DOM.Search.getFocused(focusWhenDisabled,false).blur();window.setTimeout(fun,1);evt.returnValue=false;return false}}};WP.Events.addListener(iframe.nextElement,"keydown",focusController(iframe.previousElement,true));WP.Events.addListener(iframe.previousElement,"keydown",focusController(iframe.nextElement,false))}this.setSerialized(SerializedData);return this};WP.Controls.ImageViewer.prototype.updateLabel=function(imgNum,newLabel){var imgCont,imgLabel,sURL,ajax,lstItem;imgCont=this.imgsContainer.children[imgNum];imgLabel=imgCont.children[2];if(imgLabel.value!==newLabel){imgLabel.value=newLabel}this.ImageList[imgNum].label=newLabel;imgCont=imgCont.children[1].children[0];imgCont.alt=newLabel;imgCont.title=newLabel;lstItem=this.ImageList[imgNum];sURL="upload.asp?mode=update&thumb="+(lstItem.srcThumb+"&full="+lstItem.srcFull+"&label="+encodeURI(newLabel));try{ajax=new AJAXHandler();ajax.init(sURL,function(){},"POST","1",ajax.RESPONSETYPE_COMPLETE)}catch(ex){}this.reserialize();this.setActivity()};WP.Controls.ImageViewer.prototype.addImage=function(imageType,label,srcThumb,srcFull){if(typeof imageType==="string"){try{imageType=parseInt(imageType,10)}catch(ex){return}}if(this.imageCount()>=this.maxImages){return false}else{if(imageType!==1&&imageType!==2&&imageType!==3){return false}}var imgNum,fileContainer,imgContainer,delSpan,magSpan,delImg,magImg,buttonDiv,labelLabel,labelEditor,labelError,labelReadOnly,patFile,imgObj,that,h2;imgNum=this.ImageList.length;fileContainer=createElement("div","filecontainer","filecontainer"+imgNum);buttonDiv=createElement("div","buttondiv");magSpan=createElement("a","zoom");$T(magSpan," ");magSpan.href="#";magImg=createImage("zoom","","magnify.png","View Full Size");magSpan.appendChild(magImg);buttonDiv.appendChild(magSpan);if(this.AllowEdit===true){delSpan=createElement("a","deletex");$T(delSpan," ");delSpan.href="#";delImg=createImage("deletex","","close.png","Delete");delSpan.appendChild(delImg);buttonDiv.appendChild(delSpan)}fileContainer.appendChild(buttonDiv);if(imageType===2){patFile=createImage("uploadedimage","img"+imgNum,"msgattachment_pdf.png",label)}else{if(imageType===3){patFile=createImage("uploadedimage","img"+imgNum,"msgattachment_video.png",label)}else{patFile=createImage("uploadedimage","img"+imgNum,"",label);patFile.src="showfile.asp?key="+(srcThumb||srcFull)}}imgContainer=createElement("div","uploadedimage","imagediv"+imgNum);imgContainer.appendChild(patFile);fileContainer.appendChild(imgContainer);if(this.AllowEdit===true){labelLabel=createElement("label","filedescription");labelLabel.setAttribute("for","filedescription"+imgNum);$T(labelLabel,"Enter Label:");labelLabel.title="Please provide a label or very short description for your image.";fileContainer.appendChild(labelLabel);labelEditor=createElement("textarea","filedescription","filedescription"+imgNum);labelEditor.setAttribute("for","imagediv"+imgNum);labelEditor.value=label;fileContainer.appendChild(labelEditor);labelError=createElement("p","helptext imagelabelerror");fileContainer.appendChild(labelError);WP.Validators.Text.MaxLengthAndRequired(labelEditor,"<span class=\"clearlabel\">Error: </span>Label is required.",this.maxDescLength,labelError,this.formName,this.afterValidate);window.setTimeout(function(){labelEditor.focus()},1)}else{labelReadOnly=createElement("h3","filedescription","filedescription"+imgNum);$T(labelReadOnly,label);labelReadOnly.title=label;labelReadOnly.setAttribute("for","img"+imgNum);fileContainer.appendChild(labelReadOnly)}this.imgsContainer.appendChild(fileContainer);that=this;imgObj={srcThumb:srcThumb,srcFull:srcFull,imageType:imageType,label:label,del:function(){that.deleteImage(imgNum)},mag:function(){window.open("showfile.asp?key="+srcFull)},upd:function(){that.updateLabel(imgNum,labelEditor.value)},labelObj:labelEditor,foc:function(){labelEditor.select()}};if(!this.isPrintMode){WP.Events.addListener(magSpan,"click",imgObj.mag);WP.Events.addListener(patFile,"click",imgObj.mag)}if(this.AllowEdit===true){WP.Events.addListener(delSpan,"click",imgObj.del);WP.Events.addListener(labelEditor,"change",imgObj.upd);WP.Events.addListener(labelEditor,"focus",imgObj.foc)}this.ImageList[imgNum]=imgObj;h2=this.imgsContainer.parentNode;h2.style.display="";h2=h2.previousSibling;if(h2&&h2.tagName==="H2"){h2.style.display=""}this.reserialize();this.transferCorrectLabel();if(this.iframe){if(this.imageCount()===this.maxImages){this.iframe.setDisabled(true);if(this.maxImages===1){$T(this.alertDiv,"You may only upload 1 attachment.")}else{$T(this.alertDiv,decodeMnemonics("You may only upload @MYCHART@MAXIMAGES@ attachments.",{"@MYCHART@MAXIMAGES@":this.maxImages}))}this.alertDiv.className="helptext"}else{this.iframe.setDisabled(false)}}this.singleWidth=fileContainer.scrollWidth+15;if(!this.isPrintMode){this.singleWidth=fileContainer.scrollWidth+15;this.imgsContainer.style.width=(this.singleWidth*this.imageCount())+"px"}setAppropriateHeight();return imgNum};WP.Controls.ImageViewer.prototype.setSerialized=function(serializedData){var CH9,CH10,images,imgArr,i;this.serializedData=serializedData;this.clear();CH9=String.fromCharCode(9);CH10=String.fromCharCode(10);serializedData=serializedData.replace(/`~`z_/g,CH9);serializedData=serializedData.replace(/`~~`z_/g,CH10);images=serializedData.split(CH9);for(i=0;i<images.length;i++){imgArr=images[i].split(CH10);if(imgArr.length===4){this.addImage(imgArr[0],imgArr[1],imgArr[2],imgArr[3])}}this.transferToForm();this.setActivity();this.transferCorrectLabel()};WP.Controls.ImageViewer.prototype.reserialize=function(){var img,ret,CH9,CH10,i,imgList;CH9=String.fromCharCode(9);CH10=String.fromCharCode(10);imgList=this.ImageList;ret="";for(i=0;i<imgList.length;i++){img=imgList[i];if(typeof img.label!=="undefined"){img.label=img.label.replace(/(\t|\n|\r)/g," ");ret+=CH9+img.imageType+CH10+img.label+CH10+img.srcThumb+CH10+img.srcFull}}ret=ret.substr(1);this.serializedData=ret;this.transferToForm();this.setActivity()};WP.Controls.ImageViewer.prototype.deleteImage=function(imgNum){var container,lstItem,ajax,sURL;container=this.imgsContainer.children[imgNum];lstItem=this.ImageList[imgNum];WP.Events.removeListener(container.children[0].children[0],"click",lstItem.mag);WP.Events.removeListener(container.children[1].firstChild,"click",lstItem.mag);if(this.AllowEdit===true){WP.Events.removeListener(container.children[0].children[1],"click",lstItem.del)}WP.Events.removeListener(container.children[3],"change",lstItem.upd);container.children[3].removeMaxLength();clearElement(container);container.style.display="none";sURL="upload.asp?mode=delete&thumb="+(lstItem.srcThumb+"&full="+lstItem.srcFull);try{ajax=new AJAXHandler();ajax.init(sURL,function(){},"POST","1",ajax.RESPONSETYPE_COMPLETE)}catch(ex){}this.ImageList[imgNum]={};if(this.imageCount()===0){this.clear()}else{this.reserialize()}this.transferCorrectLabel();if(this.imageCount()<this.maxImages&&this.iframe){if(this.imageCount()===(this.maxImages-1)){this.iframe.setDisabled(false);$T(this.alertDiv,"");this.alertDiv.className="alert"}}this.imgsContainer.style.width=(this.singleWidth*this.imageCount())+"px";setAppropriateHeight()};WP.Controls.ImageViewer.prototype.clear=function(){var i,imgCont,imgList;imgList=this.ImageList;for(i=0;i<imgList.length;i++){if(imgList[i].srcFull){this.deleteImage(i)}}delete this.ImageList;this.ImageList=[];imgCont=this.imgsContainer;imgCont.innerHTML="";imgCont=imgCont.parentNode;imgCont.style.display="none";imgCont=imgCont.previousSibling;if(imgCont&&imgCont.tagName==="H2"){imgCont.style.display="none"}this.serializedData="";this.transferToForm();if(this.iframe){this.iframe.setDisabled(false)}this.setActivity()};WP.Controls.ImageViewer.prototype.transferToForm=function(){var frmElement=$(this.ID);if(frmElement){frmElement.value=this.serializedData}this.setActivity()};WP.Controls.ImageViewer.prototype.imageCount=function(){var imgLst=this.ImageList,count=0,i;for(i=0;i<imgLst.length;i++){if(imgLst[i]&&(imgLst[i].srcThumb||imgLst[i].srcFull)){count++}}return count};WP.Controls.ImageViewer.uploadLabels=[["Attach an image:","Attach another image:"],["Attach a video:","Attach another video:"],["Attach an image or video:","Attach another image or video:"]];WP.Controls.ImageViewer.prototype.transferCorrectLabel=function(){var index=this.imageCount()===0?0:1;$T(this.visibleLabel,WP.Controls.ImageViewer.uploadLabels[this.mode-1][index])}};var formatCalendarTitle=buildFormat("MMMM yyyy");var formatCalendarDate=buildFormat("<\\span cla\\s\\s=\"clearlabel\">dddd, MMMM </\\span>d<\\span cla\\s\\s=\"clearlabel\">, yyyy</\\span>");var _dateChooser;function callback(y,m,d){document.forms[0].year.value=y;document.forms[0].month.value=getMonthName(m+1);document.forms[0].day.value=d}function createClickFunction(callback){function f(e){var node=WP.Events.getThis(e),id;while(node.nodeName.toUpperCase()!=="TD"){node=node.parentNode}id=node.id||node.getAttribute("name");if(id==="calnext"){_dateChooser.drawNextMonth();return WP.Events.cancelEvent(e)}if(id==="calprev"){_dateChooser.drawPreviousMonth();return WP.Events.cancelEvent(e)}if(id==="calcancel"){_dateChooser.clearCalendar();return}callback.call(_dateChooser,_dateChooser.year,_dateChooser.month,id.replace("cal",""));_dateChooser.clearCalendar()}return f}function DateChooser(trigger,callback,filter,defaultDate){this.trigger=trigger;this.callback=callback;this.filter=filter||function(){return true};if(defaultDate&&typeof defaultDate.getYear==="function"){this.today=defaultDate}else{if(typeof defaultDate==="string"){this.today=new Date(defaultDate);if(isNaN(this.today)){this.today=new Date()}}else{this.today=new Date()}}this.month=this.today.getMonth();this.year=this.today.getFullYear();this.date=this.today.getDate();this.calendar=null;this.clickFunction=createClickFunction(callback);this.hoverText="Click to select";this.hoverTextDisabled="Not Available"}function createDateChooser(trigger){var oDC=new DateChooser(trigger,callback,WP.Validators.Calendar.aftertwodays);oDC.drawCalendar()}function createEscapeClickFunction(dateChooser){return function(){dateChooser.clearCalendar()}}function isInCalendar(obj){var i,x;for(x=obj,i=0;x&&(i<6);x=x.parentNode,i++){if(x&&x.id&&x.id.toLowerCase()==="calendar"){return true}}return false}function lo(e){var obj=WP.Events.getThis(e);while(obj.nodeName.toUpperCase()!=="TD"){obj=obj.parentNode}removeClassNames(obj,"hi")}function hi(wasTab){return function(e){var obj=WP.Events.getThis(e);while(obj.nodeName.toUpperCase()!=="TD"){obj=obj.parentNode}applyClass(obj,"hi");if((!containsClassName(obj,"ctrl")||wasTab)&&_dateChooser.focusOn&&_dateChooser.focusOn!==obj.id){lo({target:document.getElementById(_dateChooser.focusOn),srcElement:document.getElementById(_dateChooser.focusOn)});_dateChooser.focusOn=obj.id}}}function restoreHi(e){var obj=WP.Events.getThis(e),targ;if(obj&&obj.className!=="calendar"&&!isInCalendar(obj)){targ="cal"+_dateChooser.date;if(_dateChooser.focusOn&&targ!==_dateChooser.focusOn){if(_dateChooser.month===_dateChooser.today.getMonth()){document.getElementById(targ).firstChild.focus()}else{targ=document.getElementById(_dateChooser.focusOn);if(targ.firstChild){targ.firstChild.blur()}lo({target:targ,srcElement:targ})}}}}function _removeCalendar(){var c=document.getElementById("calendar");if(c){WP.Events.removeListener(document.body,"click",removeCalendar);WP.Events.removeListener(document.body,"mouseover",restoreHi);c.parentNode.removeChild(c);_dateChooser=null}}function removeCalendar(e){var obj=WP.Events.getThis(e);if(obj&&obj.className!=="calendar"&&!isInCalendar(obj)){_removeCalendar()}}function keyOnPrevMonth(e){var obj;if(e.keyCode===9){if(e.shiftKey){obj=document.getElementById("calcancel").firstChild;if(obj&&obj.nodeName.toUpperCase()==="A"){obj.focus()}else{document.getElementById("cal"+_dateChooser.lastDate).firstChild.focus()}return WP.Events.preventDefault(e)}return}if(e.keyCode===13){_dateChooser.wasEnter=true}}function keyOnNextMonth(e){var obj;if(e.keyCode===9){if(e.shiftKey){obj=document.getElementById("calprev").firstChild;if(!obj||obj.nodeName.toUpperCase()!=="A"){obj=document.getElementById("calcancel").firstChild;if(obj&&obj.nodeName.toUpperCase()==="A"){obj.focus()}else{document.getElementById("cal"+_dateChooser.lastDate).firstChild.focus()}return WP.Events.preventDefault(e)}}return}if(e.keyCode===13){_dateChooser.wasEnter=true}}function tabOnCancel(e){var obj;if(e.keyCode===9){if(e.shiftKey){return}obj=document.getElementById("calprev").firstChild;if(obj&&obj.nodeName.toUpperCase()==="A"){obj.focus()}else{obj=document.getElementById("calnext").firstChild;if(obj&&obj.nodeName.toUpperCase()==="A"){obj.focus()}else{document.getElementById("cal"+_dateChooser.firstDate).firstChild.focus()}}return WP.Events.preventDefault(e)}}DateChooser.prototype.drawCalendar=function(){_removeCalendar();_dateChooser=this;var theDiv=document.createElement("div"),pos,topElement,container,overflow;theDiv.id="calendar";theDiv.appendChild(this.getCalendarObject());this.setClickFunction(theDiv);if(this.trigger.offsetParent){theDiv.style.position="absolute";pos=getElementPosition(this.trigger);topElement=pos.topElement;topElement.appendChild(theDiv);theDiv.style.zIndex=1001;theDiv.style.left=pos.x;theDiv.style.top=pos.y;container=(document.getElementById("main")||document.getElementById("datatile"));pos=getElementPosition(this.trigger,container);if(theDiv.offsetWidth){overflow=parseInt(pos.x,10)+theDiv.offsetWidth-container.offsetWidth;if(overflow>0){theDiv.style.left=(parseInt(theDiv.style.left,10)-overflow)+"px"}}}else{this.trigger.parentNode.insertBefore(theDiv,this.trigger);this.trigger.className+=" hidden"}this.calendar=theDiv;WP.Events.addListener(document.body,"click",removeCalendar);WP.Events.addListener(document.body,"mouseover",restoreHi);if(this.month===this.today.getMonth()){document.getElementById("cal"+this.date).firstChild.focus();this.focusOn="cal"+this.date}else{if(this.wasEnter){document.getElementById("cal"+this.firstDate).firstChild.focus();this.focusOn="cal"+this.firstDate}}WP.Events.addListener(document.getElementById("calprev"),"keydown",keyOnPrevMonth);WP.Events.addListener(document.getElementById("calnext"),"keydown",keyOnNextMonth);WP.Events.addListener(document.getElementById("calcancel"),"keydown",tabOnCancel);this.firstDate="";this.lastDate=""};DateChooser.prototype.clearCalendar=function(){_removeCalendar();this.callback();this.trigger.className=this.trigger.className.replace(" hidden","");this.trigger.parentNode.focus()};DateChooser.prototype.setClickFunction=function(div){var hoverText=this.hoverText,hoverDisabled=this.hoverTextDisabled,f=this.clickFunction,list=div.getElementsByTagName("td"),t,s,tCls,dt=new Date(),hand=(document.all)?"hand":"pointer",enable=function(t,skipTitle){WP.Events.addListener(t,"click",f);if(t.className==="ctrl"){WP.Events.addListener(t,"mouseover",hi());WP.Events.addListener(t,"mouseout",lo);WP.Events.addListener(t.firstChild,"focus",hi(true));WP.Events.addListener(t.firstChild,"blur",lo)}else{WP.Events.addListener(t,"mouseover",function(){t.firstChild.focus()});WP.Events.addListener(t.firstChild,"focus",hi())}t.style.cursor=hand;if(skipTitle!==true){t.title=hoverText}},disable=function(t){t.style.cursor="default";t.title=hoverDisabled};for(s=0;s<list.length;++s){t=list[s];tCls=t.className;if(tCls==="null"||tCls==="hdr"||!t.firstChild){continue}if(tCls==="ctrl"){enable(t,true)}else{if(tCls.indexOf("othermonth")>0){disable(t)}else{if(tCls.indexOf("n")===0){disable(t)}else{if(tCls.indexOf("wkndn")===0){disable(t)}else{if(tCls==="ctrln"){disable(t)}else{if(tCls!=="today"){enable(t)}else{if(this.filter(dt.getFullYear(),dt.getMonth(),dt.getDate())){enable(t)}else{disable(t)}}}}}}}}};DateChooser.prototype.drawNextMonth=function(){this.clearCalendar();this.month=(this.month+1)%12;if(this.month===0){this.year++}this.drawCalendar();if(!this.wasEnter&&this.month!==this.today.getMonth()){var fObj=document.getElementById("calnext").firstChild;if(fObj&&fObj.nodeName.toUpperCase()==="A"){fObj.focus()}}};DateChooser.prototype.drawPreviousMonth=function(){this.clearCalendar();this.month=(this.month-1);if(this.month<0){this.month+=12}if(this.month===11){this.year--}this.drawCalendar();if(!this.wasEnter&&this.month!==this.today.getMonth()){var fObj=document.getElementById("calprev").firstChild;if(fObj&&fObj.nodeName.toUpperCase()==="A"){fObj.focus()}}};DateChooser.prototype.getCalendarObject=function(){var tbl=document.createElement("table"),thead=document.createElement("thead"),tbody=document.createElement("tbody"),tr,td,tdData,m=this.month,y=this.year,filt=this.filter,iter,isBadMonth,drawingDate,today=new Date(),currDay=today.getDate(),currMonth=today.getMonth(),currYear=today.getFullYear(),createElement=WP.DOM.Create.tag,hasSelectableDay=function(month,year){var date=1,dt=makeDate(year,month+1,date);month=dt.getMonth();while(dt.getMonth()===month){if(filt(dt.getFullYear(),dt.getMonth(),date)){return true}dt.setDate(++date)}return false};isBadMonth=!hasSelectableDay(m,y);tr=document.createElement("tr");if(hasSelectableDay(m-1,y)||isBadMonth){td=createElement("td",("ctrl"+((hasSelectableDay(m-1,y)||isBadMonth)?"":"n")),"calprev",formatCalendarTitle(makeDate(y,m)));td.appendChild(WP.DOM.Create.anchoredNode("&laquo;",false,formatCalendarTitle(makeDate(y,m))))}else{td=createElement("td",("ctrl"+((hasSelectableDay(m-1,y)||isBadMonth)?"":"n")),"calprev",formatCalendarTitle(makeDate(y,m)),"&laquo;")}tr.appendChild(td);tr.appendChild(createElement("td","hdr","","",formatCalendarTitle(makeDate(y,m+1))));tr.lastChild.colSpan=5;if(hasSelectableDay(m+1,y)||isBadMonth){td=createElement("td","ctrl"+((hasSelectableDay(m+1,y)||isBadMonth)?"":"n"),"calnext",formatCalendarTitle(makeDate(y,m+2)));td.appendChild(WP.DOM.Create.anchoredNode("&raquo;",false,formatCalendarTitle(makeDate(y,m+2))))}else{td=createElement("td","ctrl"+((hasSelectableDay(m+1,y)||isBadMonth)?"":"n"),"calnext",formatCalendarTitle(makeDate(y,m+2)),"&raquo;")}tr.appendChild(td);thead.appendChild(tr);tr=document.createElement("tr");for(iter=0;iter<7;iter++){tr.appendChild(createElement("td","hdr","","",getDayLetter((iter+getFirstDayOfWeek())%7)))}thead.appendChild(tr);tbl.appendChild(thead);var otherMonth;var getClassName=function(dt,otherMonth){var mon=dt.getMonth(),date=dt.getDate(),yr=dt.getFullYear(),className,day=dt.getDay(),isWeekEnd;if(mon===m&&mon===currMonth&&date===currDay&&yr===currYear){return"today"}className=otherMonth?" othermonth":"";isWeekEnd=(day===0||day===6);if(filt(yr,mon,date)&&!otherMonth){return isWeekEnd?"wknd":"d"}return(isWeekEnd?"wkndn":"n")+className},diff,weekDay;drawingDate=makeDate(y,m+1,1);diff=drawingDate.getDay()-getFirstDayOfWeek();if(diff<0){diff+=7}drawingDate.setDate(drawingDate.getDate()-diff);while(drawingDate.getMonth()!==(m+1)&&drawingDate.getFullYear()<=y){tr=document.createElement("tr");for(weekDay=0;weekDay<7;weekDay++){otherMonth=(drawingDate.getMonth()!==m);if(!otherMonth&&this.filter(y,m,drawingDate.getDate())){tdData=WP.DOM.Create.anchoredNode(formatCalendarDate(drawingDate),true);if(!this.firstDate||this.firstDate===""){this.firstDate=drawingDate.getDate()}if(!this.lastDate||this.lastDate<drawingDate.getDate()){this.lastDate=drawingDate.getDate()}}else{tdData=document.createTextNode((otherMonth?"":drawingDate.getDate()))}td=createElement("td",getClassName(drawingDate,otherMonth),(otherMonth?"":"cal"+drawingDate.getDate()));td.appendChild(tdData);tr.appendChild(td);drawingDate.setDate(drawingDate.getDate()+1)}tbody.appendChild(tr)}tr=document.createElement("tr");td=createElement("td","ctrl","calcancel","Cancel date selection - tab forward to change months");td.appendChild(WP.DOM.Create.anchoredNode("Cancel"));tr.appendChild(td);tr.firstChild.colSpan=7;tbody.appendChild(tr);tbl.appendChild(tbody);return tbl};function dfltClndrCallbackFactory(datename){return function(y,m,d){var fielddate=document.getElementById(datename);if(fielddate){fielddate.holdErrors=false;fielddate.openingCalendar=false;if(y&&!isNaN(m)&&(m>-1)&&(m<12)&&d){fielddate.value=formatDate(new Date(y,m,d))}}}}function textBoxDataChooser(trigger,datename,filter,callbackFactoryNm){var callback,oDC;if(typeof callbackFactoryNm==="string"&&callbackFactoryNm.length>0){callback=window[callbackFactoryNm](datename)}if(typeof callback!=="function"){callback=dfltClndrCallbackFactory(datename)}oDC=new DateChooser(trigger,callback,WP.Validators.Calendar[filter],parseDate((document.getElementById(datename)).value,true));oDC.drawCalendar()}function calendarIMG(imageSource){var img=document.createElement("img");img.src=imageSource;img.className="calendar";img.alt="Calendar - Use to Select a Date";return img}function writeCalendar(datename,filter,imageSource,fDTE,tDTE,callbackFactoryNm){var txtbox=document.getElementById(datename),img,anchor;if(navigator.userAgent.indexOf("MSIE 5")>0){return}if(typeof txtbox==="object"){if(filter==="range"){if(fDTE){window.cachedStartDate=WP.Utils.dte2date(fDTE)}if(tDTE){window.cachedEndDate=WP.Utils.dte2date(tDTE)}}img=calendarIMG(imageSource);anchor=document.createElement("a");anchor.href="#";anchor.className="calendar";anchor.appendChild(img);txtbox.parentNode.appendChild(anchor);WP.Events.addListener(anchor,"click",function(){txtbox.openingCalendar=true;txtbox.holdErrors=false;textBoxDataChooser(img,datename,filter,callbackFactoryNm);return false});WP.Events.addListener(img,"mousedown",function(){txtbox.holdErrors=true});WP.Events.addListener(img,"mouseout",function(){txtbox.holdErrors=false})}};if(typeof(WP)==="undefined"){var WP={}}if(typeof(WP.Validators)==="undefined"){WP.Validators={}}WP.Validators.currentAlerts={};WP.Validators.alertsHolder=null;WP.Validators.DisplayErrors=function(errMsg,errName,errDiv){var strErr,alertHolder,currentAlerts,p;if(WP.suppressErrors===true||errMsg===" "){errMsg="&nbsp;"}if(typeof errMsg==="function"){try{strErr=errMsg(errName)}catch(ex){strErr=""}if(strErr===""){return}}else{if(typeof errMsg==="string"){strErr=errMsg}else{strErr=errMsg.innerText||errMsg.textContent}}alertHolder=errDiv||WP.Validators.alertsHolder;if(!alertHolder){if(strErr){alert(strErr)}return}if(!errName){WP.Validators.currentAlerts={};if(typeof errMsg==="object"){alertHolder.innerHTML="";alertHolder.appendChild(errMsg)}else{if(alertHolder.innerHTML===strErr){return}alertHolder.innerHTML=strErr;if(strErr==="&nbsp;"){var txt=alertHolder.innerText||alertHolder.textContent||"";if(txt.length===0){$T(alertHolder,String.fromCharCode(6))}}}return}currentAlerts=WP.Validators.currentAlerts;if(!strErr){if(currentAlerts[errName]){alertHolder.removeChild(currentAlerts[errName]);delete currentAlerts[errName]}return}if(!currentAlerts[errName]){p=document.createElement("p");p.className="alert";currentAlerts[errName]=p;alertHolder.appendChild(p)}if(currentAlerts[errName].innerHTML===strErr||currentAlerts[errName]===strErr){return}if(typeof errMsg==="object"){currentAlerts[errName].innerHTML="";currentAlerts[errName].appendChild(errMsg)}else{currentAlerts[errName].innerHTML=strErr}};if(typeof(WP.Validators.Text)==="undefined"){WP.Validators.Text={}}WP.Validators.Text.MaxLengthAndRequired=function(txtbox,requiredMessage,maxCharacters,errDiv,form,afterValidate){var validationNumber,frm,isRequired,funs={};if(!txtbox){return}if(typeof txtbox==="string"){txtbox=document.getElementById(txtbox)}form=form||null;requiredMessage=requiredMessage||"";isRequired=requiredMessage.length>0;maxCharacters=maxCharacters||200;funs.hideHintTextFun=function(){txtbox.value="";removeClassNames(txtbox,"fadedtext");WP.Events.removeListener(txtbox,"focus",funs.hideHintTextFun)};funs.showHintTextFun=function(){txtbox.value="Enter Text Here";applyClass(txtbox,"fadedtext");WP.Events.addListener(txtbox,"focus",funs.hideHintTextFun)};if(form){frm=WP.Validators.Forms[form];if(typeof frm==="undefined"){WP.Validators.Forms[form]=[];frm=WP.Validators.Forms[form]}validationNumber=frm.length}funs.isEmpty=WP.Strings.isEmpty;funs.scrollPreventer=function(){var scrollTop=txtbox.scrollTop,scrollHeight=txtbox.scrollHeight,atBottom=(scrollTop+txtbox.height)===txtbox.scrollHeight;funs.valueChecker();if(txtbox.scrollTop!==scrollTop){txtbox.scrollTop=(atBottom===true)?scrollHeight:scrollTop}if(typeof afterValidate==="function"){afterValidate()}};funs.valueChecker=function(){SetActivity();var len,mnemonics,errMsg,alert;len=txtbox.value.length;mnemonics={};mnemonics["@MYCHART@MAXLEN@"]=maxCharacters;if(len>maxCharacters){mnemonics["@MYCHART@OVERLIMIT@"]=len-maxCharacters;alert=decodeMnemonics("@MYCHART@OVERLIMIT@ too many characters.",mnemonics);errMsg=createAlert(alert,false)}else{mnemonics["@MYCHART@REMAININGCHARACTERS@"]=Math.max(0,(maxCharacters-len))+"";errMsg=decodeMnemonics("@MYCHART@REMAININGCHARACTERS@ of @MYCHART@MAXLEN@ characters left.",mnemonics);alert=(funs.isEmpty(txtbox.value)&&isRequired)?requiredMessage:" ";removeClassNames(txtbox,"alertborder")}if(errMsg.length===0){errMsg="&nbsp;"}WP.Validators.DisplayErrors(errMsg,"",errDiv);if(form){frm[validationNumber]=alert}};funs.focusFun=function(){removeClassNames(txtbox,"alertborder");WP.Events.removeListener(txtbox,"focus",funs.focusFun)};funs.blurFun=function(){var displayAlert;if(funs.isEmpty(txtbox.value)){if(txtbox.value.length===0){funs.showHintTextFun()}if(isRequired){displayAlert=true;var mnemonics={},alert,errMsg,focusFun;mnemonics["@MYCHART@MAXLEN@"]=maxCharacters;alert=decodeMnemonics(requiredMessage,mnemonics);errMsg=createAlert(alert,true);if(WP.suppressErrors===true){applyClass(errMsg,"clearlabel")}WP.Validators.DisplayErrors(errMsg,"",errDiv);if(form){frm[validationNumber]=alert}}}else{if(txtbox.value.length<=maxCharacters){removeClassNames(txtbox,"alertborder");WP.Validators.DisplayErrors("&nbsp;","",errDiv);if(form){frm[validationNumber]=" "}if(typeof afterValidate==="function"){afterValidate()}}else{displayAlert=true}}if(displayAlert&&WP.suppressErrors!==true){applyClass(txtbox,"alertborder");WP.Events.addListener(txtbox,"focus",funs.focusFun)}};funs.afterCutPaste=function(){window.setTimeout(funs.scrollPreventer,1)};WP.Events.addListener(txtbox,"blur",funs.blurFun);WP.Events.addListener(txtbox,"keyup",funs.scrollPreventer);WP.Events.addListener(txtbox,"paste",funs.afterCutPaste);WP.Events.addListener(txtbox,"cut",funs.afterCutPaste);WP.Validators.undoRedo(txtbox);WP.suppressErrors=true;funs.scrollPreventer();funs.blurFun();WP.suppressErrors=false;txtbox.removeMaxLength=function(){WP.Events.removeListener(txtbox,"blur",funs.blurFun);WP.Events.removeListener(txtbox,"keyup",funs.scrollPreventer);WP.Events.removeListener(txtbox,"cut",funs.afterCutPaste);WP.Events.removeListener(txtbox,"paste",funs.afterCutPaste);funs.hideHintTextFun();funs.focusFun();delete funs.blurFun;delete funs.scrollPreventer;delete funs.valueChecker;delete funs.isEmpty;delete funs.firstAction;delete funs.showHintTextFun;delete funs.hideHintTextFun;delete funs.focusFun;frm[validationNumber]="";if(typeof afterValidate==="function"){afterValidate()}if(typeof txtbox.removeUndoRedo==="function"){txtbox.removeUndoRedo()}}};if(typeof WP.Validators.undoRedo==="undefined"){WP.Validators.undoRedo=function(txtbox){if(!checkIt(navigator.userAgent.toLowerCase(),"msie")){return}var obj={undoStack:[txtbox.value],redoStack:[],isDeleting:false,isInserting:false};obj.pop=function(arr){if(arr.length===0){return}var ret=arr[arr.length-1];arr.length-=1;return ret};obj.addUndoFun=function(dontKillRedo){if(txtbox.value==="Enter Text Here"){return}if(obj.undoStack.length===0||txtbox.value!==obj.undoStack[obj.undoStack.length-1]){obj.undoStack[obj.undoStack.length]=txtbox.value;if(obj.undoStack.length>75){obj.undoStack.shift()}if(dontKillRedo!==true){obj.redoStack=[]}}};obj.onKeyUp=function(event){var sTmp,evt=event||window.event;if(evt.ctrlKey===false){obj.clearNativeUndo();return}if(evt.keyCode===90){if(obj.undoStack.length===0){return}obj.redoStack[obj.redoStack.length]=txtbox.value;sTmp=obj.pop(obj.undoStack);if(sTmp===txtbox.value){sTmp=obj.pop(obj.undoStack)||""}txtbox.value=sTmp}else{if(evt.keyCode===89){if(obj.redoStack.length===0){return}sTmp=obj.pop(obj.redoStack);obj.addUndoFun(true);txtbox.value=sTmp}}};obj.onKeyDown=function(event){var evt=event||window.event;if(evt.keyCode===8||evt.keyCode===46){obj.isDeleting=true;if(obj.isInserting===true){obj.isInserting=false;obj.addUndoFun()}}else{obj.isInserting=true;if(obj.isDeleting===true){obj.isDeleting=false;obj.addUndoFun()}else{if(evt.keyCode===32){if(obj.isSpacing!==true){obj.addUndoFun()}obj.isSpacing=true}else{if(obj.isSpacing===true){obj.addUndoFun()}obj.isSpacing=false}}}};obj.clearNativeUndo=function(){var tmpDiv=document.createElement("div");document.body.appendChild(tmpDiv);document.body.removeChild(tmpDiv)};WP.Events.addListener(txtbox,"keyup",obj.onKeyUp);WP.Events.addListener(txtbox,"paste",obj.addUndoFun);WP.Events.addListener(txtbox,"cut",obj.addUndoFun);WP.Events.addListener(txtbox,"keydown",obj.onKeyDown);txtbox.removeUndoRedo=function(){WP.Events.removeListener(txtbox,"keyup",obj.onKeyUp);WP.Events.removeListener(txtbox,"paste",obj.addUndoFun);WP.Events.removeListener(txtbox,"cut",obj.addUndoFun);WP.Events.removeListener(txtbox,"keydown",obj.onKeyDown);try{delete obj.addUndoFun;delete obj.onKeyDown;delete obj.undoStack;delete obj.redoStack;delete obj.isDeleting;delete obj.isInserting;delete obj.pop;delete obj.clearNativeUndo}catch(ex){}};obj.addUndoFun()}}if(typeof WP.Validators.Calendar==="undefined"){WP.Validators.Calendar={aftertwodays:function(y,m,d){return((new Date(y,m,d))-(new Date())>86399000)},past:function(y,m,d){return((new Date(y,m,d))<=(new Date()))},future:function(y,m,d){return((new Date(y,m,d+1))>=(new Date()))},range:function(y,m,d){var target,fdteElem,tdteElem,fDate,tDate;fDate=window.cachedStartDate;tDate=window.cachedEndDate;target=new Date(y,m,d);if(fDate&&target<fDate){return false}if(tDate&&target>tDate){return false}return true},any:function(y,m,d){return true}}}if(typeof(WP.Validators.Forms)==="undefined"){WP.Validators.Forms={}};if(typeof WP==="undefined"){WP={}}if(typeof WP.Strings==="undefined"){WP.Strings={}}WP.Strings.isEmpty=function(str){return WP.Strings.lTrim(str).length===0};WP.Strings.lTrim=function(str){return str.replace(/^\W+/g,"")};function doLogin(errorImagePath){var userNameField,passwordField,loginErrorMessage,sID,sPassword,loginForm;loginForm=document.getElementById("loginForm");if(loginForm){loginForm.jsenabled.value="1";userNameField=document.getElementById("Login");passwordField=document.getElementById("Password");sID=loginForm.Login.value;sPassword=loginForm.Password.value;if((sID=="")&&(sPassword=="")){if(userNameField!=null){turnOnHighlight(userNameField)}if(passwordField!=null){turnOnHighlight(passwordField)}changeGeneralError("loginErrorMessage","<span class=\"clearlabel\">Error: </span>Please enter a username and a password.",errorImagePath);loginForm.Login.focus();return false}else{if(sID==""){if(userNameField!=null){turnOnHighlight(userNameField)}if(passwordField!=null){turnOffHighlight(passwordField)}changeGeneralError("loginErrorMessage","<span class=\"clearlabel\">Error: </span>Please enter a username.",errorImagePath);loginForm.Login.focus();return false}else{if(sPassword==""){if(passwordField!=null){turnOnHighlight(passwordField)}if(userNameField!=null){turnOffHighlight(userNameField)}changeGeneralError("loginErrorMessage","<span class=\"clearlabel\">Error: </span>Please enter a Password.",errorImagePath);loginForm.Password.focus();return false}}}}if(userNameField!=null){turnOffHighlight(userNameField)}if(passwordField!=null){turnOffHighlight(passwordField)}if(document.getElementById("loginErrorMessage")){changeGeneralError("loginErrorMessage","","",1)}return true}function inlineLoginValidation(elem,isNoTurnOnError){var userNameField;var elemName;if(elem!=null){if(elem.value.length<1){if(!(isNoTurnOnError)){elemName=elem.name;if(elemName=="Password"){turnOnHighlight(elem);userNameField=document.getElementById("Login");if(userNameField){highlightIfEmpty(userNameField)}}else{if(elemName=="Login"){turnOnHighlight(elem)}else{turnOnHighlight(elem)}}}}else{turnOffHighlight(elem)}}}function selectIfFull(field){if((field!=null)&&(field.value.length==field.maxLength)){field.select()}}function isEmailSingleFieldError(field,errorDivTagID,sEmptyErrorText,sInvalidErrorText,isTurnOnErrorNotAllowed,isCheckEmptyField,isCheckPanctuation,sPanctErrorText){var isError=false;var value;if(sEmptyErrorText==""||sEmptyErrorText==null){sEmptyErrorText="<span class=\"clearlabel\">Error: </span>This field is required."}if(sInvalidErrorText==""||sInvalidErrorText==null){sInvalidErrorText=sEmptyErrorText}if(field!=null){isError=isBasicInlineValidationError(field,errorDivTagID,sEmptyErrorText,"",isTurnOnErrorNotAllowed,1,1,"",(!(isCheckEmptyField)));if(!(isError)){value=field.value;if(value.length>0){if(!(isValidEmail(value))){if(!(isTurnOnErrorNotAllowed)){turnOnHighlight(field);changeErrorField(errorDivTagID,sInvalidErrorText)}isError=true}else{if(isCheckPanctuation&&containsPunctuation(value)){if(!(isTurnOnErrorNotAllowed)){changeErrorField(errorDivTagID,sPanctErrorText);turnOnHighlight(field)}isError=true}else{turnOffHighlight(field);changeErrorField(errorDivTagID,"")}}}}}return isError}function isOtherFieldsError(formObj){var inputObj,ndx,fieldToFocus,signUpErrorField;fieldToFocus=-1;for(ndx=0;ndx<formObj.elements.length;ndx++){inputObj=formObj.elements[ndx];if((inputObj.type=="text")&&(inputObj.name.search("code")<0)&&(inputObj.name.search("ssn")<0)&&(inputObj.name.search("dob")<0)&&(inputObj.name.search("zip")<0)&&(inputObj.name.search("hphn")<0)&&(inputObj.name.search("email")<0)&&(inputObj.name.search("mrn")<0)&&(inputObj.name.search("firstname")<0)&&(inputObj.name.search("lastname")<0)){if(WP.Strings.isEmpty(inputObj.value)){if(fieldToFocus==-1){fieldToFocus=ndx}turnOnHighlight(inputObj);changeErrorField(inputObj.name+"error","<span class=\"clearlabel\">Error: </span>This field is required.")}else{turnOffHighlight(inputObj);changeErrorField(inputObj.name+"error","")}}if((fieldToFocus==-1)&&(isHighlighted(inputObj))){fieldToFocus=ndx}}if(fieldToFocus!=-1){formObj.elements[fieldToFocus].focus();return true}else{return false}}function doAccessCheck(SSNRequired,DOBRequired,errorImagePath,MRNRequired,ZIPRequired,errorDivID,formID,minSSNLength){var accessForm,isError;formID=formID||"accessForm";accessForm=document.getElementById(formID);if(accessForm){if(accessForm.jsenabled!=null){accessForm.jsenabled.value="1"}var objAccessCode,objSSN,objDOB;isError=false;objAccessCode=accessForm.code;objSSN=accessForm.ssn;objDOB=accessForm.dob;easyDOBEntry(objDOB);if(objAccessCode!=null&&isDiscreteFieldsError("code",objAccessCode.length,1,"codeerror","<span class=\"clearlabel\">Error: </span>Please enter your Activation Code.","<span class=\"clearlabel\">Error: </span>Invalid activation code.")){isError=true}if(SSNRequired&&objSSN!=null){if(objSSN.length!==undefined){if(isDiscreteFieldsError("ssn",objSSN.length,1,"ssnerror","<span class=\"clearlabel\">Error: </span>Please enter your Social Security number in the form of xxx-xx-xxxx.","<span class=\"clearlabel\">Error: </span>Invalid Social Security number.")){isError=true}}else{if(isBasicInlineValidationError(objSSN,"ssnerror","<span class=\"clearlabel\">Error: </span>Please enter your Social Security number in the form of xxx-xx-xxxx.",1,"","","","<span class=\"clearlabel\">Error: </span>Invalid Social Security number.","","",minSSNLength)){isError=true}}}if(accessForm.ssn4!=null&&isBasicInlineValidationError(accessForm.ssn4,"ssn4error","<span class=\"clearlabel\">Error: </span>Please enter last 4 digits of your Social Security number.",1,"","","","<span class=\"clearlabel\">Error: </span>Invalid last 4 digits of Social Security number.")){isError=true}if(MRNRequired&&accessForm.mrn!=null&&isBasicInlineValidationError(accessForm.mrn,"mrnerror","<span class=\"clearlabel\">Error: </span>Please enter your medical record number.")){isError=true}if(DOBRequired&&objDOB!=null&&isDiscreteFieldsError("dob",objDOB.length,1,"doberror","<span class=\"clearlabel\">Error: </span>Please enter your date of birth.","<span class=\"clearlabel\">Error: </span>Invalid date of birth.")){isError=true}if(ZIPRequired&&accessForm.zip!=null&&isBasicInlineValidationError(accessForm.zip,"ziperror","<span class=\"clearlabel\">Error: </span>Please enter your ZIP code.")){isError=true}if(accessForm.email!=null&&isEmailSingleFieldError(accessForm.email,"emailerror","<span class=\"clearlabel\">Error: </span>Please enter your e-mail address.","<span class=\"clearlabel\">Error: </span>Invalid e-mail address.","",1)){isError=true}if(accessForm.hphn!=null&&isBasicInlineValidationError(accessForm.hphn,"hphnerror","<span class=\"clearlabel\">Error: </span>Please enter your home phone number.")){isError=true}if(accessForm.firstname!=null&&isBasicInlineValidationError(accessForm.firstname,"firstnameerror","<span class=\"clearlabel\">Error: </span>Please enter your first name.")){isError=true}if(accessForm.lastname!=null&&isBasicInlineValidationError(accessForm.lastname,"lastnameerror","<span class=\"clearlabel\">Error: </span>Please enter your last name.")){isError=true}if(isOtherFieldsError(accessForm)){isError=true}}if(isError){changeGeneralError(errorDivID,"<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath);return false}else{return true}}function accessCheckBodyLoad(){var accessForm,signupForm,notifyForm;accessForm=document.getElementById("accessForm");signupForm=document.getElementById("signupForm");notifyForm=document.getElementById("notifyForm");if(accessForm){var sAccessCode,sSSN,sDOB;sAccessCode=getObjectValue(accessForm.code);sSSN=getObjectValue(accessForm.ssn);sDOB=getObjectValue(accessForm.dob);if(((sAccessCode=="")&&(sSSN==""))&&(sDOB=="")){if(accessForm.code[0]){accessForm.code[0].focus()}else{accessForm.code.focus()}}}else{if(signupForm){var isTextEntered;isTextEntered=false;if(signupForm.pwdQuestion){if((signupForm.pwdQuestion.value!="")||(signupForm.pwdAnswer.value!="")){isTextEntered=true}}if(signupForm.hint){if(signupForm.hint.value!=""){isTextEntered=true}}if(signupForm.Login){if((!isTextEntered)&&(signupForm.Login.value=="")&&(signupForm.Password.value=="")&&(signupForm.Retype.value=="")){signupForm.Login.focus()}}else{if(signupForm.Password){if((!isTextEntered)&&(signupForm.Password.value=="")&&(signupForm.Retype.value=="")){signupForm.Password.focus()}}}}else{if(notifyForm){var sEmail,sRetype;sEmail=getObjectValue(notifyForm.email);sRetype=getObjectValue(notifyForm.Retype);if((sEmail=="")&&(sRetype=="")){notifyForm.email.focus()}}}}return true}function loginBodyLoad(){var loginForm=document.getElementById("loginForm");if(loginForm){if((loginForm.Login.value=="")&&(loginForm.Password.value=="")){loginForm.Login.focus()}}return true}function changeGeneralError(inputName,errorText,errorImagePath,isPreserveOrigFormat){var field=document.getElementById(inputName);if(field){if(errorText==""){if(isPreserveOrigFormat){field.innerHTML='<span class="subheader">&nbsp;</span>'}else{field.innerHTML=""}}else{field.innerHTML='<span class="alert"><img src="'+errorImagePath+'" alt="" />&nbsp;'+errorText+"</span>"}}}function isUserNameError(userNameObj,isFocus,isNoTurnOnError,isNotCheckEmptyField){var sID;if(userNameObj!=null){sID=userNameObj.value;if(sID==""){if((!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){changeErrorField("Loginerror","<span class=\"clearlabel\">Error: </span>Please enter a username.");if(isFocus){userNameObj.focus()}turnOnHighlight(userNameObj)}return true}else{if(containsPunctuation(sID)){if(!(isNoTurnOnError)){changeErrorField("Loginerror","<span class=\"clearlabel\">Error: </span>Your username cannot contain any spaces or symbols other than a period (.), hyphen (-), underscore (_), or the at symbol (@).");if(isFocus){userNameObj.focus()}turnOnHighlight(userNameObj)}return true}else{turnOffHighlight(userNameObj);changeErrorField("Loginerror","")}}}return false}function isEmailFieldsError(emailObj,reTypeObj,isFocus,isNoTurnOnError,isEmailFieldLostFocus,isNotCheckEmptyField,isCheckPunctuation){var sEmail,sRetype,isReTypeObjEmpty,isError,isNotEqual,isNotCheckEmptyFieldInitial;isNotCheckEmptyFieldInitial=isNotCheckEmptyField;isError=false;isNotEqual=false;if(emailObj!=null){sEmail=emailObj.value;isReTypeObjEmpty=(reTypeObj==null);if(!(isReTypeObjEmpty)){sRetype=reTypeObj.value}if((sRetype!="")||isHighlighted(reTypeObj)){isNotCheckEmptyField=""}if(sEmail==""){if(isHighlighted(emailObj)){isNotCheckEmptyField=""}if((!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Please enter your e-mail address.");if(isFocus){emailObj.focus()}turnOnHighlight(emailObj);highlightIfEmpty(reTypeObj)}isError=true}else{if(isCheckPunctuation&&containsPunctuation(sEmail)){if(!(isNoTurnOnError)){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Your e-mail address cannot contain any spaces or punctuation.");if(isFocus){emailObj.focus()}turnOnHighlight(emailObj);highlightIfEmpty(reTypeObj)}isError=true}else{if((sEmail!="")&&(!(isValidEmail(sEmail)))){if(!(isNoTurnOnError)){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Please enter a valid e-mail address.");if(isFocus){emailObj.focus()}turnOnHighlight(emailObj);turnOnHighlight(reTypeObj)}isError=true}else{if(!(isReTypeObjEmpty)){if((!(isNoTurnOnError))&&(isHighlighted(reTypeObj))&&sRetype==""){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Please retype your e-mail address.")}if(!(isError)){isNotCheckEmptyField=""}else{isNotCheckEmptyFieldInitial=isNotCheckEmptyField}if(sRetype==""){if(isHighlighted(reTypeObj)){isNotCheckEmptyField=""}if((!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){if(!(isEmailFieldLostFocus)){turnOffHighlight(emailObj);if(!(isError)){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Please retype your e-mail address.")}if(isFocus){reTypeObj.focus()}turnOnHighlight(reTypeObj)}else{turnOffHighlight(emailObj);if(!(isError)){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Please retype your e-mail address.",1)}if(isFocus){reTypeObj.focus()}}}isError=true}else{if((sEmail!="")&&(sEmail!=sRetype)){if(!(isNoTurnOnError)){if(!(isError)){changeErrorField("emailerror","<span class=\"clearlabel\">Error: </span>Your e-mail and the retyped e-mail are not the same.")}if(isFocus){reTypeObj.focus()}turnOnHighlight(emailObj);turnOnHighlight(reTypeObj)}isError=true;isNotEqual=true}else{turnOffHighlight(emailObj);turnOffHighlight(reTypeObj);changeErrorField("emailerror","")}}if((!(isNotEqual))&&(!(isNoTurnOnError))){turnOffHighlight(emailObj)}}else{turnOffHighlight(emailObj);changeErrorField("emailerror","")}}}}}return isError}function isSecQuesFieldsError(pwdQuesObj,pwdAnswerObj,isFocus,isNoTurnOnError,isQuesFieldLostFocus,isNotCheckEmptyField){var pwdQuestionValue,pwdAnswerValue,pwdQuesSelectedIndex,passwordObj,isError,pwdIndexInQues,pwdIndexInAns,pwdObjectValue,isNotCheckEmptyFieldInitial;isNotCheckEmptyFieldInitial=isNotCheckEmptyField;isError=false;pwdAnswerValue=pwdQuestionValue=pwdObjectValue="";if(pwdQuesObj!=null){pwdQuesSelectedIndex=pwdQuesObj.selectedIndex;passwordObj=document.getElementById("Password");if(pwdQuesSelectedIndex==null){pwdQuestionValue=pwdQuesObj.value}else{if(pwdQuesSelectedIndex>0){pwdQuestionValue=pwdQuesObj.options[pwdQuesSelectedIndex].text}else{pwdQuestionValue=""}}if((pwdAnswerObj.value!="")||isHighlighted(pwdAnswerObj)){isNotCheckEmptyField=""}if(pwdQuestionValue==""){if(isHighlighted(pwdQuesObj)){isNotCheckEmptyField=""}if((!(isNoTurnOnError))&&(!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){changeErrorField("pwdQuesAnserror","<span class=\"clearlabel\">Error: </span>Please enter a security question.");if(isFocus){pwdQuesObj.focus()}turnOnHighlight(pwdQuesObj);highlightIfEmpty(pwdAnswerObj)}isError=true}else{if(pwdAnswerObj!=null){pwdAnswerValue=pwdAnswerObj.value;if((!(isNoTurnOnError))&&(isHighlighted(pwdAnswerObj))&&pwdAnswerValue==""){changeErrorField("pwdQuesAnserror","<span class=\"clearlabel\">Error: </span>Please enter an answer to your security question.")}if(pwdAnswerValue==""){turnOffHighlight(pwdQuesObj);if((!(isNoTurnOnError))&&(!(isQuesFieldLostFocus))){changeErrorField("pwdQuesAnserror","<span class=\"clearlabel\">Error: </span>Please enter an answer to your security question.");if(isFocus){pwdAnswerObj.focus()}turnOnHighlight(pwdAnswerObj)}isError=true}}else{turnOffHighlight(passwordObj);changeErrorField("pwdQuesAnserror","")}}if(!(isError)){if(passwordObj!=null){pwdObjectValue=passwordObj.value;if(pwdObjectValue.length>0){pwdIndexInQues=pwdQuestionValue.toUpperCase().search(pwdObjectValue.toUpperCase());pwdIndexInAns=pwdAnswerValue.toUpperCase().search(pwdObjectValue.toUpperCase());if(pwdIndexInQues>-1&&pwdIndexInAns>-1){if(!(isNoTurnOnError)){changeErrorField("pwdQuesAnserror","<span class=\"clearlabel\">Error: </span>Neither your security question nor your secret answer may contain your password.");if(isFocus){pwdQuesObj.focus()}turnOnHighlight(pwdQuesObj);turnOnHighlight(pwdAnswerObj)}return true}else{if(pwdIndexInQues>-1){if(!(isNoTurnOnError)){changeErrorField("pwdQuesAnserror","<span class=\"clearlabel\">Error: </span>Your security question cannot include your password.");if(isFocus){pwdQuesObj.focus()}turnOnHighlight(pwdQuesObj);turnOffHighlight(pwdAnswerObj)}return true}else{if(pwdIndexInAns>-1){if(!(isNoTurnOnError)){changeErrorField("pwdQuesAnserror","<span class=\"clearlabel\">Error: </span>Your secret answer cannot include your password.");if(isFocus){pwdAnswerObj.focus()}turnOnHighlight(pwdAnswerObj);turnOffHighlight(pwdQuesObj)}return true}else{turnOffHighlight(pwdQuesObj);turnOffHighlight(pwdAnswerObj);changeErrorField("pwdQuesAnserror","")}}}}else{changeErrorField("pwdQuesAnserror","");turnOffHighlight(pwdQuesObj);turnOffHighlight(pwdAnswerObj)}}else{changeErrorField("pwdQuesAnserror","");turnOffHighlight(pwdQuesObj);turnOffHighlight(pwdAnswerObj)}}}return isError}function isPasswordFieldsError(passwordObj,reTypeObj,isFocus,isNoTurnOnError,isPasswordFieldLostFocus,isNotCheckEmptyField){var sPassword,sRetype,isReTypeObjEmpty,isError,isNotEqual,isNotCheckEmptyFieldInitial;isNotCheckEmptyFieldInitial=isNotCheckEmptyField;isError=false;isNotEqual=false;if(passwordObj!=null){sPassword=passwordObj.value;isReTypeObjEmpty=(reTypeObj==null);if(!(isReTypeObjEmpty)){sRetype=reTypeObj.value}if((sRetype!="")||isHighlighted(reTypeObj)){isNotCheckEmptyField=""}if(sPassword==""){if(isHighlighted(passwordObj)){isNotCheckEmptyField=""}if((!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){changeErrorField("LoginPasworderror","<span class=\"clearlabel\">Error: </span>Please enter a Password.");if(isFocus){passwordObj.focus()}turnOnHighlight(passwordObj);highlightIfEmpty(reTypeObj)}isError=true}else{if(containsSpace(sPassword)){if(!(isNoTurnOnError)){changeErrorField("LoginPasworderror","<span class=\"clearlabel\">Error: </span>Your password cannot contain any spaces.");if(isFocus){passwordObj.focus()}turnOnHighlight(passwordObj);highlightIfEmpty(reTypeObj)}isError=true}else{if((!(isReTypeObjEmpty))){if((!(isNoTurnOnError))&&(isHighlighted(reTypeObj))&&sRetype==""){changeErrorField("LoginPasworderror","<span class=\"clearlabel\">Error: </span>Please retype your password.")}if((!(isError))){isNotCheckEmptyField=""}else{isNotCheckEmptyField=isNotCheckEmptyFieldInitial}if(sRetype==""){if(isHighlighted(reTypeObj)){isNotCheckEmptyField=""}if((!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){if(!(isPasswordFieldLostFocus)){if(!(isError)){changeErrorField("LoginPasworderror","<span class=\"clearlabel\">Error: </span>Please retype your password.")}if(isFocus){reTypeObj.focus()}turnOnHighlight(reTypeObj)}else{if(!(isError)){changeErrorField("LoginPasworderror","<span class=\"clearlabel\">Error: </span>Please retype your password.",1)}if(isFocus){reTypeObj.focus()}}}isError=true}else{if(sPassword!=sRetype&&sRetype!=""){isNotEqual=true;if(!(isNoTurnOnError)){if(!(isError)){changeErrorField("LoginPasworderror","<span class=\"clearlabel\">Error: </span>Your password and the retyped password are not the same.")}if(isFocus){reTypeObj.focus()}turnOnHighlight(reTypeObj);turnOnHighlight(passwordObj)}isError=true}else{turnOffHighlight(reTypeObj);turnOffHighlight(passwordObj);changeErrorField("LoginPasworderror","");if(!(isNoTurnOnError)){isSecQuesFieldsError(document.getElementById("pwdQuestion"),document.getElementById("pwdAnswer"),"","1","",1)}}}if((!(isNotEqual))&&(!(isNoTurnOnError))){turnOffHighlight(passwordObj)}}else{turnOffHighlight(passwordObj);changeErrorField("LoginPasworderror","");if(!(isNoTurnOnError)){isSecQuesFieldsError(document.getElementById("pwdQuestion"),document.getElementById("pwdAnswer"),"","1","",1)}}}}}return isError}function isHintError(pwdHintObj,isFocus,isNoTurnOnError,isNotCheckEmptyField){var passwordObj,pwdIndexInHint,pwdHintObjValue,passwordObjValue,pwdValueRegExp,isValError,errMsg;isValError=false;errMsg="";if(pwdHintObj!==null&&typeof pwdHintObj!=="undefined"){pwdHintObjValue=pwdHintObj.value;if(isHighlighted(pwdHintObj)){isNotCheckEmptyField=""}if(typeof pwdHintObjValue!=="string"||pwdHintObjValue.length<1){if((!(isNoTurnOnError))&&(!(isNotCheckEmptyField))){errMsg="<span class=\"clearlabel\">Error: </span>Please enter your password hint."}isValError=true}else{passwordObj=document.getElementById("Password");if(passwordObj!==null){passwordObjValue=passwordObj.value;if(typeof passwordObjValue==="string"&&passwordObjValue.length>0){pwdValueRegExp=new RegExp(passwordObjValue.toUpperCase());pwdIndexInHint=pwdHintObjValue.toUpperCase().search(pwdValueRegExp);if(pwdIndexInHint>-1){if(!(isNoTurnOnError)){errMsg="<span class=\"clearlabel\">Error: </span>Your password hint cannot include your password."}isValError=true}}}}if(isValError){if(errMsg.length>0){turnOnHighlight(pwdHintObj);changeErrorField("hinterror",errMsg);if(isFocus){pwdHintObj.focus()}}return true}else{turnOffHighlight(pwdHintObj);changeErrorField("hinterror","");return false}}return false}function checkUserId(errorImagePath){var signupForm,inputObj,ndx,inputName,fieldToFocus,inputType,isError,isEmpty,sErrorText;isError=false;sErrorText="";fieldToFocus=-1;var userNameObj,passwordObj,reTypeObj,pwdQuesObj,pwdAnswerObj,pwdHintObj;signupForm=document.getElementById("signupForm");if(signupForm){userNameObj=signupForm.Login;passwordObj=signupForm.Password;reTypeObj=signupForm.Retype;pwdQuesObj=signupForm.pwdQuestion;pwdAnswerObj=signupForm.pwdAnswer;pwdHintObj=signupForm.hint;if(isUserNameError(userNameObj,1)){isPasswordFieldsError(passwordObj,reTypeObj);isSecQuesFieldsError(pwdQuesObj,pwdAnswerObj);isHintError(pwdHintObj);changeGeneralError("signuperror","<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath);return false}else{if(isPasswordFieldsError(passwordObj,reTypeObj,1)){isSecQuesFieldsError(pwdQuesObj,pwdAnswerObj);isHintError(pwdHintObj);changeGeneralError("signuperror","<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath);return false}else{if(isSecQuesFieldsError(pwdQuesObj,pwdAnswerObj,1)){isHintError(pwdHintObj);changeGeneralError("signuperror","<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath);return false}else{if(isHintError(pwdHintObj,1)){changeGeneralError("signuperror","<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath);return false}}}}}return true}function checkNotify(errorImagePath,isNoGeneralError){var notifyForm=document.getElementById("notifyForm");if(notifyForm){var sEmail,sRetype,emailObj,reTypeObj;emailObj=notifyForm.email;reTypeObj=notifyForm.Retype;if(!notifyForm.send.value||notifyForm.send.value==="0"){if(notifyForm.send[1].checked){emailObj.disabled=true;emailObj.className=emailObj.className.replace(new RegExp(/ *disabledbg/),"");emailObj.className=emailObj.className+" disabledbg";reTypeObj.disabled=true;reTypeObj.className=reTypeObj.className.replace(new RegExp(/ *disabledbg/),"");reTypeObj.className=reTypeObj.className+" disabledbg";turnOffHighlight(emailObj);turnOffHighlight(reTypeObj);changeErrorField("notifyenableerror","");changeErrorField(emailObj.name+"error","");return true}else{if(!notifyForm.send[0].checked){if(!(isNoGeneralError)){changeGeneralError("signuperror","<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath)}changeErrorField("notifyenableerror","<span class=\"clearlabel\">Error: </span>Please select Yes or No.");isEmailFieldsError(emailObj,reTypeObj);return false}}}emailObj.disabled=false;emailObj.className=emailObj.className.replace(new RegExp(/ *disabledbg/),"");reTypeObj.disabled=false;reTypeObj.className=reTypeObj.className.replace(new RegExp(/ *disabledbg/),"");if(isEmailFieldsError(emailObj,reTypeObj,1)){if(!(isNoGeneralError)){changeGeneralError("signuperror","<span class=\"clearlabel\">Error: </span>There were problems in the form submission. Please check the form, correct any mistakes and resubmit it.",errorImagePath)}return false}}return true}function checkPassword(formObj){var sNewPasswd,sVerPasswd;sNewPasswd=formObj.newpasswd.value;if(containsSpace(sNewPasswd)){alert("Your new password cannot contain any spaces.");formObj.newpasswd.focus();return false}sVerPasswd=formObj.verifypasswd.value;if(sNewPasswd!=sVerPasswd){alert("Your password and the retyped password are not the same.");formObj.verifypasswd.focus();return false}return true}function enableInputs(){var tmpElmnt,elmntArr,indx;tmpElmnt=document.getElementById("nojavascript");if(tmpElmnt!==null){tmpElmnt.className=tmpElmnt.className+" hidden";hideElement(tmpElmnt)}tmpElmnt=document.getElementById("loginErrorMessage");if(tmpElmnt!==null){showElement(tmpElmnt)}elmntArr=document.getElementsByTagName("INPUT");if(elmntArr===null){return}for(indx=0;indx<elmntArr.length;indx=indx+1){tmpElmnt=elmntArr[indx];if(tmpElmnt!==null&&containsClassName(tmpElmnt,"jsreq")){tmpElmnt.removeAttribute("disabled");removeClassNames(tmpElmnt,"disabledfield");removeClassNames(tmpElmnt,"disabled")}}}if(typeof WP==="undefined"){WP={}}if(typeof WP.FormValidators==="undefined"){WP.FormValidators={}}if(typeof WP.FormValidators.LoginMethods==="undefined"){WP.FormValidators.LoginMethods=function(authList,hasUnsavedChanges){var that=this,getText,oldSubmit,oldCancel;this.authOptions=authList;this.divs={err:$("LoginPasworderror"),pass:$("PASSWORD"),retype:$("RETYPE"),login:$("USERNAME"),pwques:$("PWDQUESTION"),pwans:$("PWDANSWER"),pwhint:$("HINT"),resetErr:$("pwdQuesAnserror")||$("hinterror"),submit:$("submit"),cancel:$("cancel"),username:$("mychartusername"),form:$("signupform"),loginError:$("Loginerror"),digid:$("digid")};if(hasUnsavedChanges===true){this.moveCursorLast=function(thisObj){if(!thisObj){return}var len;if(thisObj.setSelectionRange){len=thisObj.value.length*2;thisObj.setSelectionRange(len,len)}else{thisObj.value=thisObj.value}};this.moveCursorLast(this.divs.pass)}that.clearSaved=function(){$T($("genmessage")," ");$("submit").style.display=oldSubmit;$("cancel").style.display=oldCancel;WP.Events.removeListener(that.divs.digid,"click",that.clearSaved);WP.Events.removeListener(that.divs.username,"click",that.clearSaved)};if(hasUnsavedChanges!==true){oldCancel=this.divs.cancel.style.display;this.divs.cancel.style.display="none";oldSubmit=this.divs.submit.style.display;this.divs.submit.style.display="none";WP.Events.addListener(that.divs.digid,"click",that.clearSaved);WP.Events.addListener(that.divs.username,"click",that.clearSaved)}if(this.divs.username.checked===false){this.toggleForm=function(){that.divs.form.className=that.divs.username.checked?"":"hidden"};WP.Events.addListener(this.divs.username,"click",this.toggleForm)}getText=function(obj){return obj.innerText||obj.textContent||obj.value||obj.innerHTML};if(this.divs.pass){this.passCheck=function(evt){if((evt||window.event).keyCode===13){return}var reVal,retype,pass,element,errTxt,errDiv;reVal=that.divs.retype.value;pass=that.divs.pass;retype=that.divs.retype;element=WP.Events.getThis(evt);errDiv=that.divs.err;isPasswordFieldsError(pass,retype,"","","",1);errTxt=errDiv.innerHTML;switch(errTxt){case"* <span class=\"clearlabel\">Error: </span>Your password and the retyped password are not the same.":if(reVal===pass.value.substr(0,reVal.length)){$T(errDiv," ");turnOffHighlight(pass);turnOffHighlight(retype);return true}break;case"* <span class=\"clearlabel\">Error: </span>Please enter a Password.":case"* <span class=\"clearlabel\">Error: </span>Please retype your password.":$T(errDiv," ");turnOffHighlight(pass);turnOffHighlight(retype);break}};this.passCheckBlur=function(){isPasswordFieldsError(that.divs.pass,that.divs.retype)};WP.Events.addListener(this.divs.retype,"keyup",this.passCheck);WP.Events.addListener(this.divs.pass,"keyup",this.passCheck);WP.Events.addListener(this.divs.retype,"blur",function(){isPasswordFieldsError(that.divs.pass,that.divs.retype)})}if(this.divs.pwques){this.pwQuesCheckChange=function(evt){if((evt||window.event).keyCode===13){return}isSecQuesFieldsError(that.divs.pwques,that.divs.pwans,"",true,"","")};this.pwQuesCheckLF=function(evt){isSecQuesFieldsError(that.divs.pwques,that.divs.pwans,"","",true,true)};WP.Events.addListener(this.divs.pwques,"keyup",this.pwQuesCheckChange);WP.Events.addListener(this.divs.pwans,"keyup",this.pwQuesCheckChange);WP.Events.addListener(this.divs.pwques,"blur",this.pwQuesCheckLF);WP.Events.addListener(this.divs.pwans,"blur",this.pwQuesCheckLF)}if(this.divs.pwhint){this.pwHintChange=function(evt){if((evt||window.event).keyCode===13){return}isHintError(that.divs.pwhint,"","",true)};this.pwHintLF=function(evt){isHintError(that.divs.pwhint)};WP.Events.addListener(this.divs.pwhint,"keyup",this.pwHintChange);WP.Events.addListener(this.divs.pwhint,"blur",this.pwHintChange)}this.needOne=function(){var i;for(i=0;i<this.authOptions.length;i++){if(this.authOptions[i].checked){return true}}alert("At least one authentication method must be selected.");return false};this.checkForm=function(){var errMsg,divs=that.divs;if(divs.form.className!=="hidden"){isPasswordFieldsError(divs.pass,divs.retype,"","","","");errMsg=getText(divs.err);if(divs.login){isUserNameError(divs.login);errMsg=errMsg+getText(divs.loginError)}$T(divs.resetErr," ");if(divs.pwques){isSecQuesFieldsError(divs.pwques,divs.pwans,1)}else{isHintError(divs.pwhint,1)}errMsg=errMsg+getText(divs.resetErr)}if(WP.Strings.isEmpty(errMsg||"")===false){return false}return true};return this}};